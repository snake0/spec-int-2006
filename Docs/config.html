<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>Config files -  SPEC CPU2006</title>
<!-- $Id: config.html 4773 2006-08-07 23:53:32Z john $ -->
<!-- You'll want a nice wide screen when editing this .......................................................................... -->

<link rel="STYLESHEET" href="css/cpu2006docs.css" type="text/css" />
<style type="text/css">

a.switchstrike {white-space:nowrap; margin-left:1.3em; text-decoration:line-through;}

</style>

</head>
<body>

<h1>SPEC CPU2006 Config Files</h1>

<p style="font-size:80%">Last updated: 31-Jul-2006 jlh</p>

<p> (To check for possible updates to this document, please see 
<a href="http://www.spec.org/cpu2006/Docs/">http://www.spec.org/cpu2006/Docs/</a> ) </p>


<p class="contents">Overview</p>
<p class="contentsl2">Click one of the following to go to the detailed contents about that item:</p>

<p class="contentsl3"> <a href="#Dtoc_I">I.</a> Introduction</p>
<p class="contentsl3"> <a href="#Dtoc_II">II.</a> Config file options for runspec</p>
<p class="contentsl3"> <a href="#Dtoc_III">III.</a> Config file options for specmake</p>
<p class="contentsl3"> <a href="#Dtoc_IV">IV.</a> Config file options for the shell</p>
<p class="contentsl3"> <a href="#Dtoc_V">V.</a> Config file options for readers</p>
<p class="contentsl3"> <a href="#Dtoc_V">VI.</a> Using Feedback Directed Optimization (FDO)</p>
<p class="contentsl3"> <a href="#Dtoc_VII">VII.</a> The config file preprocessor</p>
<p class="contentsl3"> <a href="#Dtoc_VIII">VIII.</a> Output files - and how they relate to your config file</p>
<p class="contentsl3last"> <a href="#Dtoc_IX">IX.</a> Troubleshooting</p>

<p class="contents">Contents</p>

<p class="contentsl1" id="Dtoc_I"> <a href="#sectionI">    I.</a> Introduction</p>
<p class="contentsl2"> <a href="#sectionI.A">     A.</a> What is a config file?  (Background: benchmark philosophy.)</p>
<p class="contentsl2"> <a href="#sectionI.B">     B.</a> What does a config file affect?</p>
<p class="contentsl3"> <a href="#sectionI.B.1">      1.</a> runspec</p>
<p class="contentsl3"> <a href="#sectionI.B.2">      2.</a> specmake</p>
<p class="contentsl3"> <a href="#sectionI.B.3">      3.</a> The shell</p>
<p class="contentsl3"> <a href="#sectionI.B.4">      4.</a> Readers of the results</p>
<p class="contentsl3"> <a href="#sectionI.B.5">      5.</a> The config file preprocessor</p>
<p class="contentsl3"> <a href="#sectionI.B.6">      6.</a> <span class="alarm">Warning: unknown options can trigger rebuilds</span></p>
<p class="contentsl2"> <a href="#sectionI.C">     C.</a> Config file structure</p>
<p class="contentsl3"> <a href="#sectionI.C.1">      1.</a> Comments and whitespace</p>
<p class="contentsl3"> <a href="#sectionI.C.2">      2.</a> Header section</p>
<p class="contentsl3"> <a href="#sectionI.C.3">      3.</a> Named sections</p>
<p class="contentsl4"> <a href="#sectionI.C.3.a">       a.</a> Precedence for the benchmark specifier</p>
<p class="contentsl5"> <a href="#defaultbenchmark">Default benchmark</a></p>
<p class="contentsl5"> <a href="#namedsuite">Named suite</a></p>
<p class="contentsl5"> <a href="#namedbenchmark">Named benchmark</a></p>
<p class="contentsl5"> <a href="#orderdifferentsections">Order of differing sections does not matter</a></p>
<p class="contentsl5"> <a href="#ordersamesection">Order of the same section does matter</a></p>
<p class="contentsl4"> <a href="#sectionI.C.3.b">       b.</a> Precedence for the tuning specifier</p>
<p class="contentsl4"> <a href="#sectionI.C.3.c">       c.</a> Precedence for the extension specifier</p>
<p class="contentsl5"> <a href="#extfound">Extension found in config file</a></p>
<p class="contentsl5"> <a href="#extnotfound">Extension not found in config file</a></p>
<p class="contentsl5"> <a href="#extoverride">Extension override</a></p>
<p class="contentsl4"> <a href="#sectionI.C.3.d">       d.</a> Combining specifier types</p>
<p class="contentsl4"> <a href="#sectionI.C.3.e">       e.</a> Precedence among section types</p>
<p class="contentsl3"> <a href="#sectionI.C.4">      4.</a> MD5 section</p>
<p class="contentsl3"> <a href="#sectionI.C.5">      5.</a> Shell-like "here documents" and continued lines</p>
<p class="contentsl3"> <a href="#sectionI.C.6">      6.</a> Included files</p>

<p class="contentsl2"> <a href="#sectionI.D">     D.</a> Variable substitution</p>
<p class="contentsl3"> <a href="#sectionI.D.1">      1.</a> By runspec</p>
<p class="contentsl4"> <a href="#sectionI.D.1.a">       a.</a> At startup: $[variable] </p>
<p class="contentsl4"> <a href="#sectionI.D.1.b">       b.</a> During a run: $variable and ${variable}</p>
<p class="contentsl4"> <a href="#sectionI.D.1.c">       c.</a> Example: cleaning files before a training run</p>
<p class="contentsl4"> <a href="#sectionI.D.1.d">       d.</a> Example: submit to multiple nodes, Tru64 Unix</p>
<p class="contentsl4"> <a href="#sectionI.D.1.e">       e.</a> Example: bind to processors, SPEC TurboBlaster9000</p>
<p class="contentsl3"> <a href="#sectionI.D.2">      2.</a> By the shell \$VARIABLE</p>
<p class="contentsl4"> <a href="#sectionI.D.2.a">       a.</a> Protecting shell variables</p>
<p class="contentsl4"> <a href="#sectionI.D.2.b">       b.</a> Example: submitting to multiple nodes, SGI Origin 2000</p>
<p class="contentsl3"> <a href="#sectionI.D.3">      3.</a> By specmake $(VARIABLE)</p>
<p class="contentsl3"> <a href="#sectionI.D.4">      4.</a> Limitations on variable substitution</p>
<p class="contentsl3"> <a href="#sectionI.D.5">      5.</a> Unsetting a variable with "%undef%"</p>

<p class="contentsl1" id="Dtoc_II"> <a href="#sectionII"     >   II.</a> Config file options for runspec</p>
<p class="contentsl2"> <a href="#sectionII.A">        A.</a> Options that can also be used on the runspec command line</p>

<!-- OK, here's an oddity.  With the web browser Safari 1.3.2 (v312.6) it has sometimes appeared that if there is a space
(and then a newline) after each of the items in the list below, they wrap as expected.  But if they only have newline
characters, the display sometimes has wraps that appear odd to the eye.  So, we add a space. -->

<p class="contentsl3"><a class="switch" href="#action">            action</a> 
<a class="switch" href="#check_version">         check_version</a> 
<a class="switch" href="#copies">            copies</a> 
<a class="switch" href="#delay"     >        delay</a> 
<a class="switch" href="#deletework">        deletework</a> 
<a class="switch" href="#ext">               ext</a> 
<a class="switch" href="#feedback">          feedback</a> 
<a class="switch" href="#flagsurl">          flagsurl</a> 
<a class="switch" href="#http_proxy">        http_proxy</a> 
<a class="switch" href="#http_timeout">      http_timeout</a> 
<a class="switch" href="#ignore_errors">     ignore_errors</a> 
<a class="switch" href="#info_wrap_columns"> info_wrap_columns</a> 
<a class="switch" href="#iterations">        iterations</a> 
<a class="switch" href="#mach">              mach</a> 
<a class="switch" href="#make_no_clobber">   make_no_clobber</a> 
<a class="switch" href="#max_active_compares">max_active_compares</a> 
<a class="switch" href="#nobuild">           nobuild</a> 
<a class="switch" href="#notes_wrap_columns">notes_wrap_columns</a> 
<a class="switch" href="#output_format">     output_format</a> 
<a class="switch" href="#reportable">        reportable</a> 
<a class="switch" href="#rate">              rate</a> 
<a class="switch" href="#rebuild">           rebuild</a> 
<a class="switch" href="#runlist">           runlist</a> 
<a class="switch" href="#setprocgroup">      setprocgroup</a> 
<a class="switch" href="#size">              size</a> 
<a class="switch" href="#table">             table</a> 
<a class="switch" href="#tune">              tune</a> 
<a class="switch" href="#verbose">           verbose</a> </p>

<p class="contentsl2"> <a href="#sectionII.B">        B.</a> Options for runspec that can only be used in a config file </p>

<p class="contentsl3"> 
<a class="switch" href="#allow_extension_override">         allow_extension_override</a> 
<a class="switch" href="#backup_config">         backup_config</a> 
<a class="switch" href="#basepeak">              basepeak</a> 
<a class="switch" href="#bind">                  bind</a> 
<a class="switch" href="#check_md5">             check_md5</a> 
<a class="switch" href="#command_add_redirect">  command_add_redirect</a> 
<a class="switch" href="#difflines">             difflines</a> 
<a class="switch" href="#env_vars">              env_vars</a> 
<a class="switch" href="#expand_notes">          expand_notes</a> 
<a class="switch" href="#expid">                 expid</a> 
<a class="switch" href="#fail">                  fail</a> 
<a class="switch" href="#fail_build">            fail_build</a> 
<a class="switch" href="#fail_run">              fail_run</a> 
<a class="switch" href="#ignore_sigint">         ignore_sigint</a> 
<a class="switch" href="#inherit_from">          inherit_from</a> 
<a class="switch" href="#line_width">            line_width</a> 
<a class="switch" href="#locking">               locking</a> 
<a class="switch" href="#log_line_width">        log_line_width</a> 
<a class="switch" href="#mailcompress">          mailcompress</a> 
<a class="switch" href="#mailmethod">            mailmethod</a> 
<a class="switch" href="#mailport">              mailport</a> 
<a class="switch" href="#mailserver">            mailserver</a> 
<a class="switch" href="#mailto">                mailto</a> 
<a class="switch" href="#mail_reports">          mail_reports</a> 
<a class="switch" href="#make">                  make</a> 
<a class="switch" href="#makeflags">             makeflags</a> 
<a class="switch" href="#mean_anyway">           mean_anyway</a> 
<a class="switch" href="#minimize_rundirs">      minimize_rundirs</a> 
<a class="switch" href="#minimize_builddirs">    minimize_builddirs</a> 
<a class="switch" href="#no_monitor">            no_monitor</a> 
<a class="switch" href="#no_input_handler">      no_input_handler</a> 
<a class="switch" href="#notes_wrap_indent">     notes_wrap_indent</a> 
<a class="switch" href="#output_root">           output_root</a> 
<a class="switch" href="#plain_train">           plain_train</a> 
<a class="switch" href="#section_specifier_fatal">section_specifier_fatal</a> 
<a class="switch" href="#sendmail">              sendmail</a> 
<a class="switch" href="#srcalt">                srcalt</a> 
<a class="switch" href="#strict_rundir_verify">  strict_rundir_verify</a> 
<a class="switch" href="#sysinfo_program">       sysinfo_program</a> 
<a class="switch" href="#teeout"     >           teeout</a> 
<a class="switch" href="#use_submit_for_speed">  use_submit_for_speed</a> 
<a class="switch" href="#version_url">           version_url</a> </p>

<p class="contentsl1" id="Dtoc_III"> <a href="#sectionIII">  III.</a> Config file options for specmake    </p>

<p class="contentsl2"><a class="switch" href="#compiler">    CC, CXX, FC</a> 
<br /><a class="switch" href="#ld">          CLD, CXXLD, FLD</a> 
<br /><a class="switch" href="#onestep">     ONESTEP</a> 
<br /><a class="switch" href="#optimize">    OPTIMIZE, COPTIMIZE, CXXOPTIMIZE, FOPTIMIZE</a> 
<br /><a class="switch" href="#portability"> PORTABILITY, CPORTABILITY, CXXPORTABILITY, FPORTABILITY...</a> 
<br /><a class="switch" href="#rm_sources">  RM_SOURCES</a> 
<br /><a class="switch" href="#pass">        PASSn_CFLAGS, PASSn_CXXFLAGS, PASSn_FFLAGS</a></p>

<p class="contentsl1" id="Dtoc_IV"> <a href="#sectionIV"     >   IV.</a> Config file options for the shell </p> 

<p class="contentsl2">
<a class="switch" href="#fdo_pre0">         fdo_pre0</a> 
<a class="switch" href="#fdo_preN">         fdo_preN</a> 
<a class="switch" href="#fdo_make_cleanN">  fdo_make_cleanN</a> 
<a class="switch" href="#fdo_pre_makeN">    fdo_pre_makeN</a> 
<a class="switch" href="#fdo_make_passN">   fdo_make_passN</a> 
<a class="switch" href="#fdo_post_makeN">   fdo_post_makeN</a> 
<a class="switch" href="#fdo_runN">         fdo_runN</a> 
<a class="switch" href="#fdo_postN">        fdo_postN</a> 
<a class="switch" href="#submit">           submit</a></p>

<p class="contentsl1" id="Dtoc_V"> <a href="#sectionV">  V.</a> Config file options for readers</p>
<p class="contentsl2"> <a href="#sectionV.A">       A.</a> Descriptive fields</p>

<p class="contentsl3">
<a class="switchstrike" href="#company_name">company_name</a>
<a class="switch" href="#hw_avail">         hw_avail</a> 
<a class="switch" href="#hw_cpu_name">      hw_cpu_name</a> 
<a class="switch" href="#hw_cpu_char">      hw_cpu_char</a> 
<a class="switch" href="#hw_cpu_mhz">       hw_cpu_mhz</a> 
<a class="switch" href="#hw_disk">          hw_disk</a> 
<a class="switch" href="#hw_fpu">           hw_fpu</a> 
<a class="switch" href="#hw_memory">        hw_memory</a> 
<a class="switch" href="#hw_model">         hw_model</a> 
<a class="switch" href="#hw_nchips">        hw_nchips</a> 
<a class="switch" href="#hw_ncores">        hw_ncores</a> 
<a class="switch" href="#hw_ncoresperchip"> hw_ncoresperchip</a> 
<a class="switch" href="#hw_ncpuorder">     hw_ncpuorder</a> 
<a class="switch" href="#hw_nthreadspercore">hw_nthreadspercore</a> 
<a class="switch" href="#hw_ocache">        hw_ocache</a> 
<a class="switch" href="#hw_other">         hw_other</a> 
<a class="switch" href="#hw_pcache">        hw_pcache</a> 
<a class="switch" href="#hw_scache">        hw_scache</a> 
<a class="switch" href="#hw_tcache">        hw_tcache</a> 
<a class="switch" href="#hw_vendor">        hw_vendor</a> 
<a class="switch" href="#license_num">      license_num</a> 
<a class="switchstrike" href="#machine_name">machine_name</a>
<a class="switch" href="#prepared_by">      prepared_by</a> 
<a class="switch" href="#sw_auto_parallel"> sw_auto_parallel</a> 
<a class="switch" href="#sw_avail">         sw_avail</a> 
<a class="switch" href="#sw_base_ptrsize" > sw_base_ptrsize</a>
<a class="switch" href="#sw_compiler">      sw_compiler</a> 
<a class="switch" href="#sw_file">          sw_file</a> 
<a class="switch" href="#sw_os">            sw_os</a> 
<a class="switch" href="#sw_state">         sw_state</a> 
<a class="switch" href="#sw_other">         sw_other</a> 
<a class="switch" href="#sw_peak_ptrsize" > sw_peak_ptrsize</a>
<a class="switch" href="#tester">           tester</a>
<a class="switchstrike" href="#tester_name">tester_name</a>
<a class="switch" href="#test_date">        test_date</a> 
<a class="switch" href="#test_sponsor">     test_sponsor</a>
<a class="switchstrike" href="#VENDOR">  VENDOR</a>
</p>

<p class="contentsl2"> <a href="#sectionV.B"     >       B.</a> Field scoping and continuation  </p>
<p class="contentsl2"> <a href="#sectionV.C"     >       C.</a> Additional notes for the reader</p>

<p class="contentsl3"> 
<a class="switch" href="#notes_comp">       notes_compNNN</a> 
<a class="switch" href="#notes_port">       notes_portNNN</a> 
<a class="switch" href="#notes_base">       notes_baseNNN</a> 
<a class="switch" href="#notes_peak">       notes_peakNNN</a> 
<a class="switch" href="#notes_os">         notes_osNNN</a> 
<a class="switch" href="#notes_plat">       notes_platNNN</a> 
<a class="switch" href="#notes_port">       notes_portNNN</a> 
<a class="switch" href="#notes">            notesNNN</a></p>

<p class="contentsl1" id="Dtoc_VI"><a href="#sectionVI" >VI. </a> Using Feedback Directed Optimization (FDO)</p>
<p class="contentsl2"><a href="#sectionVI.A">       A. </a>The minimum requirement: <tt>PASSn*</tt> or <tt>fdo*n</tt></p>
<p class="contentsl2"><a href="#sectionVI.B">       B. </a>Combining <tt>PASS*n</tt> and <tt>fdo*n</tt>; fake is your
friend</p>
<p class="contentsl2"><a href="#sectionVI.C">       C. </a>Interaction with the config file <tt>feedback</tt> option</p>
<p class="contentsl2"><a href="#sectionVI.D">       D. </a>If the config file <tt>feedback</tt> option is used at multiple
levels</p>
<p class="contentsl2"><a href="#sectionVI.E">       E. </a>Interaction with <tt>runspec --feedback</tt></p>
<p class="contentsl2"><a href="#sectionVI.F">       F. </a>More examples</p>

<p class="contentsl1" id="Dtoc_VII"> <a href="#sectionVII" >VII.</a> The config file preprocessor</p>
<p class="contentsl2">  <a href="#sectionVII.A">     A.</a> Defining macros</p>
<p class="contentsl2">  <a href="#sectionVII.B">     B.</a> Un-doing macro definition</p>
<p class="contentsl2">  <a href="#sectionVII.C">     C.</a> Using macros</p>
<p class="contentsl2">  <a href="#sectionVII.D">     D.</a> Conditionals</p>
<p class="contentsl3">  <a href="#sectionVII.D.1">      1.</a> %ifdef .. %endif</p>
<p class="contentsl3">  <a href="#sectionVII.D.2">      2.</a> %ifndef .. %endif</p>
<p class="contentsl3">  <a href="#sectionVII.D.3">      3.</a> %if .. %endif</p>
<p class="contentsl3">  <a href="#sectionVII.D.4">      4.</a> %else</p>
<p class="contentsl3">  <a href="#sectionVII.D.5">      5.</a> %elif</p>
<p class="contentsl2">  <a href="#sectionVII.E">     E.</a> Informational directives</p>
<p class="contentsl3">  <a href="#sectionVII.E.1">      1.</a> %warning</p>
<p class="contentsl3">  <a href="#sectionVII.E.2">      2.</a> %error</p>

<p class="contentsl1" id="Dtoc_VIII"> <a href="#sectionVIII" >   VIII.</a> Output files - and how they relate to your config file</p>
<p class="contentsl2"> <a href="#sectionVIII.A"     >       A.</a> Automatic backup of config files </p>
<p class="contentsl2"> <a href="#sectionVIII.B"     >       B.</a> The log file and verbosity levels</p>
<p class="contentsl2"> <a href="#sectionVIII.C"     >       C.</a> Log file example: Feedback-directed optimization.</p>
<p class="contentsl2"> <a href="#sectionVIII.D"     >       D.</a> Help, I've got too many logs</p>
<p class="contentsl2"> <a href="#sectionVIII.E"     >       E.</a> Finding the build directory</p>
<p class="contentsl2"> <a href="#sectionVIII.F"     >       F.</a> Files in the build directory</p>
<p class="contentsl2"> <a href="#sectionVIII.G"     >       G.</a> For more information</p>

<p class="contentsl1last" id="Dtoc_IX"> <a href="#sectionIX" >  IX.</a> Troubleshooting</p>     





<h2 id="sectionI">I. Introduction</h2>

<table style="border:none;">
<tr style="border:none;">
<td style="border:none; padding-right:1em;">

<p>SPEC CPU2006 config files provide very detailed control of testing.  Before learning about these details, most users will
find it helpful to begin with: </p>
<ul>
<li><a href="readme1st.html">readme1st.html</a> and</li>
<li><a href="runspec.html">runspec.html</a>, such as the section 
<a href="runspec.html#section1.2">About config files</a>.</li>
</ul>

      <p class="commentarystart" style="margin-top:.5em"> <i>Note:</i> links to SPEC CPU2006 documents on this web page
      assume that you are reading the page from a directory that also contains the other SPEC CPU2006 documents.  If by
      some chance you are reading this web page from a location where the links do not work, try accessing the referenced
      documents at one of the following locations:</p>
      <ul class="commentaryul">
      <li class="commentaryli"><a href="http://www.spec.org/cpu2006/Docs/">www.spec.org/cpu2006/Docs/</a></li>
      <li class="commentaryli">The <span class="ttnobr">$SPEC/Docs/</span> (Unix) or <span class="ttnobr">%SPEC%\Docs\</span>
      (Windows) directory on a system where SPEC CPU2006 has been installed.</li>
      <li class="commentaryli">The <span class="tt">Docs/</span> directory on your SPEC CPU2006 distribution DVD.</li>
      </ul>
      <p class="commentaryend"></p>

<p>The <tt>runspec</tt> document discusses the primary user interface for running SPEC CPU2006; with this document, attention
turns more toward how things work inside.</p>
</td>

<td style="background:#fff28a; width: 33%; padding:.5em; border:thin solid gray;">
<p style="font-family:cursive;" id="nodummy"> 
q. This document looks big and intimidating.  Where do I start?</p>

<p>a. Don't start here.  Start with runspec.html.  But, once you do read this document, please be sure to notice:</p>
<ul style="margin-left:0em; padding-left:1em;">
<li style="margin-bottom:.5em;"><a href="#sectionI.B">Section I.B</a>, which explains that a config file contains options that are 
used by five (5) different consumers.</li>
<li>The table of contents, which lists the options accepted by each of those consumers.  For example, the shell options
are listed <a href="#Dtoc_IV">here.</a></li>
</ul>
<p>If you keep track of which options are addressed to which consumer, you will considerably ease your
learning curve.</p>
</td>
</tr>
</table>


<h3 id="sectionI.A">I.A. What is a config file?  (Background:    benchmark philosophy.)   </h3>

<p>A config file contains:</p>
<ul>
      <li>The instructions for building the benchmarks.</li>
      <li>The instructions for running the benchmarks.</li>
      <li>The description of the system under test.</li>
      <li>The key to result reproducibility.</li>
      <li>The guts, the real controls, the Good Stuff.</li>
      <li>The place where the benchmark philosophy hits the road.</li>
</ul>

<p>A key decision that must be made by designers of a benchmark suite is whether to allow the benchmark source code to be
changed when the suite is used.  </p>
   
<p class="snugbot">If source code changes are allowed:</p>
<table style="margin-left:5%; margin-right:15%" >
<tr><td><b>&nbsp;+&nbsp;</b> </td>
    <td>The benchmark can be adapted to the system under test.</td>
</tr>
<tr><td><b>&nbsp;+&nbsp;</b> </td>
    <td>Portability may be easier.</td>
</tr>
<tr><td><b>&nbsp;&#8211;&nbsp;</b> </td>
    <td>But it may be hard to compare results between systems, unless some formal audit is done to ensure that comparable
    work is done. </td>
</tr>
</table>

<p class="snugbot">If source code changes are not allowed:</p>
<table style="margin-left:5%; margin-right:15%" >
<tr><td><b>&nbsp;+&nbsp;</b> </td>
    <td>Results may be easier to compare.</td>
</tr>
<tr><td><b>&nbsp;&#8211;&nbsp;</b> </td>
    <td>It may take more time and effort to develop the benchmark, because portability will have to be built in ahead of
    time. </td>
</tr>
<tr><td><b>&nbsp;&#8211;&nbsp;</b> </td>
    <td>Portability may be hard to achieve, at least for real applications.  Simple loops of 15 lines can port with little
    effort, and such benchmarks have their uses.  But real applications are more complex.</td>
</tr>
</table>

<p>SPEC has chosen not to allow source code changes for the CPU2006 suite, except under very limited circumstances.  </p>

<p>By restricting source code changes, SPEC separates the activity of porting benchmarks, which has a goal of being
performance neutral, from the activity of using the benchmarks, where the goal is getting the best score possible.  Prior to
the first production use of CPU2006, SPEC invested substantial effort to port the suite to as many platforms as practical,
including 32 and 64-bit systems; little-endian and big-endian hardware; Unix, Linux, Mac OS X, and Microsoft Windows
systems.</p>

<p>Are source code changes ever allowed?  Normally, no.  But if you discover a reason why you believe such a change is
essential, <a href="techsupport.html#source">SPEC wants to hear about it</a>, and will consider such requests for 
a future revision of the suite.  SPEC will
normally not publish CPU2006 results using modified source code, unless such modifications are unavoidable for
the target environment, are submitted to SPEC, are made available to all users of the suite, and are formally approved by a
vote.</p>

<p>So, if source code changes are not allowed, but the benchmarks must be compiled in a wide variety of environments, can the
users at least write their own makefiles, and select <span class="ttnobr">-D</span> options to select different environments?
The answer to these two questions are "no", and "yes", respectively:</p>

<ul><li>No, you can't write your own makefiles.</li>
<li>But yes, you can select portability options (such as <span class="ttnobr">-D</span>).  </li>
</ul>

<p>You do this in the config file, which contains a centralized collection of all the portability options and optimization
options for all the benchmarks in the CPU2006 suite.  The SPEC tools then automatically generate the makefiles for you.</p>

<p>The config file contains places where you can specify the characteristics of both your compile time and run time
environments.  It allows the advanced user to perform detailed manipulation of makefile options, but retains all the changes
in one place so that they can be examined and reproduced.</p>

<p>The config file is one of the key ingredients in making results reproducible.  For example, if a customer would like to
run the CPU2006 suite on her own SuperHero Model 4 and discover how close results are in her environment to the environment
used when the vendor published a CPU2006 result, she should be able to do that using only 3 ingredients:</p>

<ol>
   <li>The SPEC CPU2006 media, ordered from SPEC.</li>

   <li>The software and hardware as specified in the full disclosure when the vendor published the original results.</li>

   <li>The config file from the vendor's submission.</li>
</ol>


<h3 id="sectionI.B">I.B. What does a config file affect?</h3>

<p>A config file contains options targetting five distinct consumers: </p>
<ol>
<li>The <tt>runspec</tt> tool, which provides overall control of the test,</li> 
<li>The tool that compiles benchmarks: <tt>specmake</tt>,</li> 
<li>Your shell, which is used for certain operations such as <a href="#submit">submit</a>ing to specific processors,</li> 
<li>Readers of the results, and</li> 
<li>The config file preprocessor. </li> 
</ol>
<p>To understand how to write a config file effectively, you need to understand which consumer you are addressing at any
given point.  </p>

<p class="snugbot">The above point seems worth emphasizing: </p>
<p style="background:#fff28a; margin: .4em 2em; font-size:110%; font-family:sans; width: 33%; text-align:center;">To
understand how to write a config file effectively, you need to understand which consumer you are addressing at any given
point.  </p> 

<p>This section gives you an overview of the consumers; more detail
is included in later sections.</p>
   
<h4 id="sectionI.B.1">I.B.1. runspec </h4>

<p>Various aspects of the operation of <tt>runspec</tt> can be affected by setting options within a config file.  You'll find
a list of these options in the <a href="#Dtoc_II">table of contents for section II</a> - including some that are available
both on the runspec command line and some that can only be set within a config file.</p>

<p>For example, if <tt>michael.cfg</tt> includes
the lines:</p>

<pre>   output_format = asc,ps
   tune          = base
   reportable    = 1
   runlist       = fp
</pre>

<p>then the defaults for the <tt>runspec</tt> command would change as specified.  A user who types either of the following
two commands would get precisely the same effect:</p>

<pre>   runspec --config=michael
   runspec --config=michael --output=asc,ps --tune=base --reportable fp 
</pre>         
         
<h4 id="sectionI.B.2">I.B.2. specmake</h4>

<p>The tool <tt>specmake</tt> is simply GNU  make renamed to avoid any possible conflicts with other versions of make that may
be on your system.  The options commonly used for <tt>specmake</tt> are listed 
in the <a href="#Dtoc_III">table of contents for section III</a>.</p>

<p>For example, these config file lines:</p>

<pre>   CC           = cc
   CPORTABILITY = -DSPEC_CPU_LP64
   OPTIMIZE     = -O4
</pre>

<p>are written to the makefile set that is ultimately used to build the benchmark, and are interpreted by
<tt>specmake</tt>.</p>


<h4 id="sectionI.B.3">I.B.3. The shell </h4>

<p>Some config file lines define commands that are handed off to the shell or, on Windows, the command interpreter.  The
list of these is in the <a href="#Dtoc_IV">table of contents for section IV</a>.</p>

<p>For example, consider a config file that contains:</p> 

<pre>   fdo_pre0     = mkdir /tmp/joydeep/feedback; rm -f /tmp/joydeep/feedback/* 
</pre>

<p>When using this config file, <tt>runspec</tt> will pass the above command to the shell prior to running a training run for
feedback directed optimization.  It is the shell that actually carries out the requested commands, not <tt>runspec</tt>, so
the syntax of the command depends on whether you are using the Unix shell (<tt>/bin/sh</tt>) or the Windows command
interpreter (<tt>cmd.exe</tt>).  </p>

<p><span style="background:#fff28a; font-size:115%"> Because <tt>runspec</tt> can cause arbitrary commands to be executed,
<span class="alarm"> it is therefore important to read a config file you are given before using it.</span></span></p>


<h4 id="sectionI.B.4">I.B.4. Readers of the results</h4>

<p>If a SPEC CPU2006 result is published (for example, at <a href="http://www.spec.org/">http://www.spec.org/</a>), it is
expected to contain all the information needed for a reader to understand exactly what was tested.  Fields that are
informative for readers are listed in the <a href="#Dtoc_V">table of contents for section V</a>.</p>

<p>For example, config file lines such as these are addressed to the human reader:</p>

<pre>   test_date = Nov-2008
   hw_avail  = Apr-2008
   sw_avail  = May-2008
   notes_base_015  = Note: Feedback directed optimization was not used
</pre>

<p>In addition, for results published by SPEC, the config file itself is available to readers at <a
href="http://www.spec.org/">http://www.spec.org/cpu2006/</a>. The config file is presented as you wrote it, with three
exceptions (<a href="#sectionI.C.1">protected comments</a>, the <a href="#sectionI.C.4">MD5 section</a>, and <a
href="utility.html#mkt">rawfile corrections for reader fields</a>).  The config file is made available 
because it is so important to reproducing results, as described in the <a href="#sectionI.A">Introduction</a>.  The config
file is saved on every run, as a compressed portion of the rawfile, and can be accessed with <span class="ttnobr">runspec
--rawformat --output_format=config &lt;rawfile&gt;</span>.</p>


<h4 id="sectionI.B.5">I.B.5. The config file preprocessor</h4>

<p>There is also a config file <a href="#sectionVII">preprocessor</a>, which is addressed via lines that begin with
<tt>%</tt> in the first column.  <span class="new">(The config file preprocessor is new with CPU2006.)</span></p>

<h4 id="sectionI.B.6"><a name="unexpected_rebuilds"> </a>I.B.6 <span class="alarm">Warning: unknown options can trigger
rebuilds</span></h4>

<table style="border:none;">
<tr style="border:none;">
<td style="border:none; margin-right:1em;">

<p>What if you accidentally enter an option that isn't absorbed by any of the above five consumers?  For example, 
perhaps you might use incorrect spelling and set <span class="ttnobr">CXXOPTIMZIE = -O4</span> or perhaps you might use 
older CPU2000 spelling such as <span class="ttnobr">tester_name = Willi Computers</span>; but <tt>tester_name</tt> 
is not a field for CPU2006.</p>

<p>Unknown options cause two things to happen: first, the tools will typically pass your setting along to <tt>specmake</tt>,
which will proceed to silently ignore items such as <span class="ttnobr">CXXOPTIMZIE = -O4</span>.</p>

<p>More importantly, the tools will add your new option, and its value, into the "MD5 hash" that describes your binaries.  
From the tools' point of view, an unknown setting is something that you must have done for a reason;
the tools do not attempt to guess that you just made a spelling mistake.  Therefore, <span class="alarm">when you 
add the item with the spelling error, you will probably trigger a rebuild.</span>  Furthermore, when you later correct
the spelling error, you will probably trigger another rebuild.  You should still correct the error; but
if you wonder why the correction caused a rebuild, it's because the tools cannot tell a minor spelling fix 
from an important setting.  They assume that most everything is important.</p>

<p>The MD5 hash is discussed <a href="#sectionI.C.4">below</a>, as is an option that controls <a href="#check_md5">checking 
of it</a>.</p>

</td>
<td style="background:#fff28a; width: 25%; padding:.5em; border:thin solid gray;">
<p style="font-family:cursive;">q. Why are my binaries being rebuilt?</p>
<p>a. If you have changed your compile options, then the binaries <b>should</b> be rebuilt, so that the binaries will match
the config file.</p> 
<p>If not, maybe you have changed some other options.  </p>
<p>Maybe you have mis-spelled some options.  </p>
<p>See details at left.</p>
</td></tr></table>


<h3 id="sectionI.C">I.C. Config file structure </h3>

<p>A config file contains:</p>
<ul>
        <li> A <a href="#sectionI.C.2">header section</a>.</li>
        <li> An arbitrary number of user-defined <a href="#sectionI.C.3">named sections</a>, delimited by section markers.</li>
        <li> An automatically-generated <a href="#sectionI.C.4">MD5 section</a>.</li>
</ul>

<p id="scope"><b>About "scope":</b> Every line of the config file is considered to be within the scope of one of the above
three.  Lines prior to the first section marker are in the scope of the header section.  All other lines are either in the
scope of the most recently preceding user-defined section marker, or else in the MD5 section.</p>

<p>A line within the scope of a named section may be overridden by a line within the scope of a different named section,
according to rules that are described <a href="#sectionI.C.3">below</a>.</p>

<h4 id="sectionI.C.1">I.C.1. Comments and whitespace</h4>

<p>Comment lines begin with a <tt><b>#</b></tt>, and can be placed anywhere in a config file.  When the config file is saved
as an encoded portion of the rawfile, the comments are included.  But if a comment line begins with <tt><b>#&gt;</b></tt>,
it is a "protected comment" that will not be saved in the rawfile.  Thus you could use <tt><b>#</b></tt> for most of your
comments, and use <tt><b>#&gt;</b></tt> for proprietary information, such as:</p>

<pre>   #&gt; I didn't use the C++ beta version because of Bob's big back-end bug.
</pre>

<p>Blank lines can be placed anywhere in a config file.</p>

<p>Spaces within a line are usually ignored.  Of course, you wouldn't want to spell OPTIMIZE as OPT I MIZE, but you are
perfectly welcome to do either of the following:</p>

<pre>   OPTIMIZE=-O2
   OPTIMIZE   =  -02
</pre>

<p>One place where spaces are considered significant is in <a href="#sectionV.C">notes</a>, where the tools assume you
are trying to line up your comments in the full disclosure reports.  (Notes are printed in a fixed-width font.)</p>

<p>Spaces at the beginning of lines are ignored, except when attempting to address the preprocessor.  Preprocessor directives
always begin with a percent sign (%) in the first column.  You can put spaces after the percent sign, if you wish, as shown by the
examples <a href="#percentspace">below</a>.</p>

<p><span class="alarm">Debug alert:</span> Trailing spaces - that is, spaces at the end of lines - may sometimes cause
unexpected results.  For example, you should say 
<br />"<tt>teeout = yes</tt>" 
<br />not 
<br />"<tt>teeout = yes &nbsp;</tt>"
<br />If you find yourself scratching your head and wondering why an option is not working as described in this document, try
checking for trailing spaces.</p>

<h4 id="sectionI.C.2"><a name="header">I.C.2. Header section </a></h4>
   

<p>The header section is simply the first section, prior to the first occurence of a named section.</p>

<p>Most attempts to address <tt>runspec</tt> itself must be done in the header section.  For example, if you want to set
<tt>reportable=1</tt>, you must do so before any occurrences of section markers.</p> 


<h4 id="sectionI.C.3"> I.C.3. Named Sections</h4>

<p>A named section is a portion of the config file that begins with a section marker and continues until the next section
marker or the MD5 section is reached. The contents of the named section are applied based upon the precedence rules 
described in the following sections.</p>

<p>A "section marker" is a four-part string of the form:</p>

<pre>   benchmark[,benchmark,...]=tuning=extension=machine:
</pre>

<p>These are referred to below as the 4 "section specifiers".  The allowed values for the section specifiers are:</p>

<table> 
<tr><td><tt><b>benchmark:</b></tt>  </td>
               <td><tt>default</tt>
               <br /> <tt>cpu2006</tt>
               <br /> <tt>int</tt>
               <br /> <tt>fp</tt>
               <br /> Any individual benchmark, such as <tt>465.tonto</tt>
               <br /> Any list of benchmarks, such as <tt>450.soplex,403.gcc</tt> <span class="new">(The ability to specify
               more than one benchmark is new with CPU2006.)</span>
               </td>
</tr>
<tr><td><tt><b>tuning: </b> </tt>  </td>
               <td> <tt>default</tt>
               <br /> <tt>base</tt>
               <br /> <tt>peak</tt></td>
</tr>
<tr><td><tt><b>extension:</b></tt> </td>
               <td> <tt>default</tt>
               <br />An arbitrary string, such as "<span class="ttnobr">cloyce-naturalblonde</span>"
               </td>
</tr>
<tr><td><tt><b>machine:</b>  </tt> </td>
               <td> <tt>default</tt> 
               <br />An arbitrary string <span class="alarm">[*]</span></td>
</tr>
</table>

<p class="commentarystart"><span class="alarm">[*]</span> The "machine" specifier works similarly to the extension
specifier, but it does not affect the name of the executable produced, which, in many environments, makes it less useful than
the extension specifier.  This document does not describe the usage of the "machine" specifier, other than to note that it
exists; if you feel particularly courageous, you can experiment with it.  </p>
<p class="commentarycont">But please be aware that if you use a single config file to build with two different machine
settings, you will likely overwrite the original binaries on the second build, since the machine specifier does not affect
the name of the generated executable.  </p>
<p class="commentaryend">An example of the usage of the machine specifier may be found in your config directory, in <span
class="ttnobr">solaris-sparc-sunstudio.cfg</span>.  That config file applies <span class="ttnobr">-DSPEC_CPU_LP64</span> when
the machine <span class="ttnobr">native64</span> is selected; it also takes steps to work around the limitation mentioned in
the previous paragraph.
</p>

<p id="omitspecs">Trailing <tt>default</tt> section specifiers may be omitted from a section marker.  Thus all three of these
section markers are equivalent:</p>

<pre>   465.tonto=base=default=default:
   465.tonto=base=default:
   465.tonto=base:
</pre>

<p>Section markers can be entered in any order.  Section markers can be repeated; material from identical section markers
will automatically be consolidated.  That is, you are welcome to start one section, start a different one, then go back and
add more material to the first section.  But please note that since there is no marker for the header section, you cannot go
back to it.</p> 

<p>By constructing section markers, you specify how you would like your options applied, with powerful defaulting and
overriding capabilities.  The next several sections walk through examples to demonstrate precedence, including how sections
interact with each other.</p>

<h5 id="sectionI.C.3.a"> I.C.3.a. Precedence for the benchmark specifier</h5>

<p>For the benchmark specifier, the precedence is:</p>
<pre>
  highest   named benchmark
            suite name
  lowest    default
</pre>

<p id="defaultbenchmark"><b>Using default as the benchmark specifier</b> </p>

<p class="l1">For example, consider this config file that only mentions <tt>default</tt> for the benchmark specifier:</p>

<pre>   $ <b>cat tmp.cfg</b>
   runlist       = sjeng
   size          = test
   iterations    = 1
   tune          = base
   output_format = text
   teeout        = 1

   default=default=default=default:
   OPTIMIZE = -xO1 -w

   $ <b>runspec --config=tmp | grep sjeng.c</b>
   cc -c -o sjeng.o -DSPEC_CPU -DNDEBUG   -xO1 -w    sjeng.c
   $ 
</pre>

<p class="l1">The config file above is designed for quick, simple testing: it runs only one benchmark, namely
<tt>458.sjeng</tt>, using the smallest (<tt>test</tt>) workload, runs it only once, uses only <tt>base</tt> tuning, outputs
only the text-format (ASCII) report, and displays the build commands to the screen (<tt>teeout</tt>).  To use it, we issue a
<tt>runspec</tt> command, and pipe the output to <tt>grep</tt> to search for the actual generated compile command.
(Alternatively, on Windows, we could use <tt>findstr</tt> on the generated log file).</p>

<p id="EyeOnTheBall" class="commentary">The careful reader may ask, "Why does the <a href="#runlist">runlist</a> reference
<tt>sjeng</tt> rather than <tt>458.sjeng</tt>?"  The answer is that the runlist can use benchmark numbers or any abbreviation
that is sufficient for uniqueness; any of the following would have the same effect: <tt>"458.sjeng", "458", "sjeng", "sj",
"458.sj"</tt>.  This is the same rule as for the corresponding option on the <a href="runspec.html#runlist">command
line</a>.</p>

<p class="l1">The results show that the tuning applied was the expected <tt>-xO1 -w</tt> (which mean optimization level 1 and
suppress warnings, for the Sun Studio Compilers).  The tools have automatically added <span class="ttnobr">-c -o
sjeng.o</span> to specify where the object file is to be written.  The switches <span class="ttnobr">-DSPEC_CPU
-DNDEBUG</span> were also added automatically.  The former may enable benchmark code changes from SPEC's porting process (if
any), and the latter turns off C language "assert" statements (if any).
</p>

<p><b id="namedsuite">Using a named suite as the benchmark specifier</b> </p>

<p class="l1">The next example differs from the previous one by adding a section marker with <tt>int</tt>,
for the integer suite, as the first section specifier:</p>

<pre>   $ <b> cat tmp.cfg</b>
   runlist       = sjeng
   size          = test
   iterations    = 1
   tune          = base
   output_format = text
   teeout        = 1

   default=default=default=default:
   OPTIMIZE = -xO2 -w

   int=default=default=default:
   OPTIMIZE = -xO3 -w

   $ <b>runspec --config=tmp | grep sjeng.c</b>
   cc -c -o sjeng.o -DSPEC_CPU -DNDEBUG   -xO3 -w     sjeng.c
   $
</pre>

<p class="l1">The second <tt>OPTIMIZE</tt> line is used above because the reference to the integer suite is considered to be
more specific than the overall default.</p>  

<p id="namedbenchmark"><b>Using a named benchmark as the benchmark specifier</b> </p>

<p class="l1">Furthermore, we can add a specifier that mentions <tt>sjeng</tt> by name:</p>

<pre>   $ <b> cat tmp.cfg</b>
   runlist       = sjeng
   size          = test
   iterations    = 1
   tune          = base
   output_format = text
   teeout        = 1

   default=default=default=default:
   OPTIMIZE = -xO2 -w

   int=default=default=default:
   OPTIMIZE = -xO3 -w

   458.sjeng=default=default=default:
   OPTIMIZE = -xO4 -w

   $ <b>runspec --config=tmp | grep sjeng.c</b>
   cc -c -o sjeng.o -DSPEC_CPU -DNDEBUG   -xO4 -w      sjeng.c
   $
</pre>

<p class="l1">The third <tt>OPTIMIZE</tt> line wins above, because it is included in the section that is considered to be the
most specific.  </p>

<p id="orderdifferentsections"><b>Order of differing sections does not matter:</b> </p>

<p class="l1">But what if we had said these in a different order?</p>

<pre>   $ <b>cat tmp.cfg</b>
   runlist       = sjeng
   size          = test
   iterations    = 1
   tune          = base
   output_format = text
   teeout        = 1

   458.sjeng=default=default=default:
   OPTIMIZE = -xO4 -w

   default=default=default=default:
   OPTIMIZE = -xO2 -w

   int=default=default=default:
   OPTIMIZE = -xO3 -w

   $ <b>runspec --config=tmp | grep sjeng.c</b>
   cc -c -o sjeng.o -DSPEC_CPU -DNDEBUG   -xO4 -w      sjeng.c
</pre>

<p class="l1">Notice above that the order of entry is not significant; it's the order of precedence from least specific to
most specific.</p>

<p id="ordersamesection"><b>Order of the same section does matter:</b>  </p>

<p class="l1">When a specifier is listed more than once at the same descriptive level, the last instance of the specifier is
used.  Consider this case:</p>

<pre>   458.sjeng=default=default=default:
   OPTIMIZE = -xO4

   400.perlbench=default:
   OPTIMIZE = -fast

   458.sjeng=default=default=default:
   OPTIMIZE = -xO3
</pre>

<p class="l1">The ending value of <tt>OPTIMIZE</tt> for <tt>458.sjeng</tt> is <tt>-xO3</tt>, not <tt>-xO4</tt>.</p>


<h5 id="sectionI.C.3.b"> I.C.3.b. Precedence for the tuning specifier</h5>

<p>For the tuning specifier, either <tt>base</tt> or <tt>peak</tt> has higher precedence than
<tt>default</tt>.  </p>

<p>Here is an example of its use:</p>

<pre>   $ <b>cat tmp.cfg</b>
   runlist       = sjeng
   size          = test
   iterations    = 1
   tune          = base,peak
   output_format = text
   teeout        = 1

   default=default=default=default:
   CC       = /opt/SUNWspro/bin/cc -w

   default=base=default=default:
   CC       = /update1/bin/cc -w

   default=peak=default=default:
   CC       = /update2/bin/cc -w

   $ <b>runspec --config=tmp | grep sjeng.c</b>
   /update1/bin/cc -w -c -o sjeng.o -DSPEC_CPU -DNDEBUG    sjeng.c
   /update2/bin/cc -w -c -o sjeng.o -DSPEC_CPU -DNDEBUG    sjeng.c
   $ 
</pre>

<p>In the above example, we compile sjeng twice: once for base tuning, and once for peak.  Notice that in both cases the
compilers defined by the more specific section markers have been used, namely <span class="ttnobr">/update1/bin/cc</span> and
<span class="ttnobr">/update2/bin/cc</span>, rather than <span class="ttnobr">/opt/SUNWspro/bin/cc</span> from <span
class="ttnobr">default=default=default=default</span>.</p>   

<h5 id="sectionI.C.3.c"> I.C.3.c. Precedence for the extension specifier</h5>

<p>For the extension specifier, any named extension is at a higher precedence level than the <tt>default</tt>.</p>

<p id="extfound"><b>Using an extension found in the config file</b></p>

<p class="l1">The next example, builds with either the library for the "<tt>bsdmalloc</tt>" memory allocation routines, or
the multi-threaded "<tt>mtmalloc</tt>" routines.  (Note: the SPEC CPU2006 benchmarks do not require multi-threading, and do
not contain threading directives; but a compiler is allowed to choose to try to automatically decompose threads, and there's
nothing in the run rules to prohibit you from linking with your preferred version of a supported malloc library.)</p>

<pre>   $ <b>cat tmp.cfg</b>
   runlist       = sjeng
   size          = test
   iterations    = 1
   tune          = base
   output_format = text
   teeout        = 1

   default=default=default:
   LIBS = -lslowmalloc

   default=default=myke:
   LIBS = -lbsdmalloc

   default=default=yusuf:
   LIBS = -lthread -lmtmalloc
   $
   $ <b>runspec --config=tmp --extension=myke | grep sjeng.o</b>
   cc -c -o sjeng.o -DSPEC_CPU -DNDEBUG                    sjeng.c
   cc  attacks.o book.o crazy.o draw.o ecache.o epd.o eval.o leval.o moves.o 
   neval.o partner.o proof.o rcfile.o search.o see.o seval.o sjeng.o ttable.o 
   utils.o     -lbsdmalloc          -o sjeng
   $
   $ <b>runspec --config=tmp --extension=yusuf | grep sjeng.o</b>
   cc -c -o sjeng.o -DSPEC_CPU -DNDEBUG                    sjeng.c
   cc  attacks.o book.o crazy.o draw.o ecache.o epd.o eval.o leval.o moves.o 
   neval.o partner.o proof.o rcfile.o search.o see.o seval.o sjeng.o ttable.o 
   utils.o     -lthread -lmtmalloc          -o sjeng
   $ 
   $ <b>cd $SPEC/benchspec/CPU2006/458.sjeng/exe</b>
   $ <b>ls -lt | head -3</b>
   total 5888
   -rwxrwxr-x   1 alan  staff      244688 May 11 16:32 sjeng_base.yusuf
   -rwxrwxr-x   1 alan  staff      244628 May 11 16:31 sjeng_base.myke
   $ 

</pre>

<p class="l1">Notice above that two different versions of sjeng were built from the same config file, and neither one used
<tt>slowmalloc</tt>, since the named extension is higher priority than the default.  Both executables are present in the
<tt>exe</tt> directory for <tt>458.sjeng</tt>.</p> 

<p id="extnotfound"><b>Using an extension that is not found in the config file</b></p>

<p class="l1">The previous section demonstrated use of the <tt>runspec</tt> switch <span class="ttnobr">--extension</span> to
select among extensions defined in the config file.  But what if the extension on the command line is not mentioned in the
config file?  The example below continues immediately from the example just above:</p>

<pre>   $ <b>runspec --config=tmp --extension=yusoff</b>
   runspec v4200 - Copyright 1999-2006 Standard Performance Evaluation Corporation
   ...
   ERROR: The extension 'yusoff' defines no settings in the config file!
          If this is okay and you'd like to use the extension to just change
          the extension applied to executables, please put
       allow_extension_override = yes
          into the header section of your config file.
</pre>

<p class="l1">By default, if you mention an extension on the <tt>runspec</tt> command line that does not exist in the config
file, the tools refuse to build.</p>

<p id="extoverride"><b>Extension override</b></p>

<p class="l1">But if you add <a href="#allow_extension_override">allow_extension_override=yes</a> to the top of the config
file, then the tools will build or run with the extension you specified, using the same settings as they would have used if
no extension had been entered on the <tt>runspec</tt> command line.  </p>

<p class="l1">The next example continues with a config file that adds <tt>allow_extension_override</tt> to the previous
example config file:</p>

<pre>   $ <b>diff tmp.cfg tmp2.cfg</b>
   0a1
   &gt; allow_extension_override=yes
   $
   $ <b>runspec --config=tmp2 --extension=yusoff | grep sjeng.o</b>
   cc -c -o sjeng.o -DSPEC_CPU -DNDEBUG                    sjeng.c
   cc attacks.o book.o crazy.o draw.o ecache.o epd.o eval.o leval.o moves.o 
   neval.o partner.o proof.o rcfile.o search.o see.o seval.o sjeng.o ttable.o 
   utils.o           -lslowmalloc          -o sjeng
   $
   $ <b>cd $SPEC/benchspec/CPU2006/458.sjeng/exe</b>
   $ <b>ls -lt | head -2</b>
   total 6384
   -rwxrwxr-x   1   alan   staff        244628 May 11 16:39 sjeng_base.yusoff
</pre>

<p class="l1">Notice above that although the tools now consent to build with the requested extension, the library
settings now falls back to the <tt>default</tt>, since "<tt>yusoff</tt>" does not match any section markers.</p>

<p class="new">(For CPU2000, the tools silently accepted any extension, including typos, which sometimes led to surprising
results.  CPU2006 tries to reduce surprises by rejecting your typos, unless you set <span
class="nobr">allow_extension_override</span>.)</p>

<h5 id="sectionI.C.3.d"> I.C.3.d. Combining specifier types</h5>

<p>If more than one section applies to a particular benchmark without disagreement among them, then all are applied.</p>

<p>Consider this example:</p>

<pre>   $ <b>cat tmp.cfg</b>
   runlist       = sjeng
   size          = test
   iterations    = 1
   tune          = base
   output_format = text
   teeout        = 1

   default=default=default=default:
   OPTIMIZE = -xO2 -w
   CC       = /opt/SUNWspro/bin/cc 
   LIBS     = -lbsdmalloc

   458.sjeng=default=default=default:
   OPTIMIZE = -xO4 -w

   default=peak=default=default:
   CC       = /update1/bin/cc 

   default=default=mt=default:
   LIBS     = -lthread -lmtmalloc

   $ <b>runspec --config=tmp --tune=peak --ext=mt | grep sjeng.o</b>
   /update1/bin/cc  -c -o sjeng.o -DSPEC_CPU -DNDEBUG   -xO4 -w  sjeng.c
   /update1/bin/cc   -xO4 -w attacks.o book.o crazy.o draw.o ecache.o epd.o 
   eval.o leval.o moves.o neval.o partner.o proof.o rcfile.o search.o see.o 
   seval.o sjeng.o ttable.o utils.o    -lthread -lmtmalloc         -o sjeng
   $ 
</pre>

<p>Notice above that all three sections applied: the section specifier for <tt>458.sjeng</tt>, the specifier for
<tt>peak</tt> tuning, and the specifier for extension <tt>mt</tt>.</p>  


<h5 id="sectionI.C.3.e"> I.C.3.e. Precedence among section types</h5>

<p>If sections conflict with each other, the order of precedence is:</p>

<pre>
     highest     benchmark
                 suite
                 tuning
     lowest      extension
</pre>

<p>And this order can be demonstrated as follows:</p>

<pre>    $  <b>cat tmp.cfg</b>
     runlist       = sjeng
     size          = test
     iterations    = 1
     tune          = base
     output_format = text
     teeout        = 1
     makeflags     = -j30
  
     default=default=default=default:
     OPTIMIZE = -xO1 -w
  
     int=default=default=default:
     OPTIMIZE = -xO2 -w
  
     458.sjeng=default=default=default:
     OPTIMIZE = -xO3 -w
  
     default=peak=default=default:
     OPTIMIZE = -xO4 -w
  
     default=default=mt=default:
     OPTIMIZE = -xO5 -w
     $
     $ <b>runspec --config=tmp sjeng | grep sjeng.c  </b>
[1]  cc -c -o sjeng.o -DSPEC_CPU -DNDEBUG   -xO3 -w        sjeng.c
     $ <b>runspec --config=tmp --tune=peak sjeng | grep sjeng.c</b>
[2]  cc -c -o sjeng.o -DSPEC_CPU -DNDEBUG   -xO3 -w        sjeng.c
     $ <b>runspec --config=tmp --extension=mt sjeng | grep sjeng.c</b>
[3]  cc -c -o sjeng.o -DSPEC_CPU -DNDEBUG   -xO3 -w        sjeng.c
     $ 
     $ <b>runspec --config=tmp --tune=base bzip | grep bzip2.c</b>
[4]  cc -c -o bzip2.o -DSPEC_CPU -DNDEBUG   -xO2 -w        bzip2.c
     $ <b>runspec --config=tmp --tune=peak bzip | grep bzip2.c</b>
[5]  cc -c -o bzip2.o -DSPEC_CPU -DNDEBUG   -xO2 -w        bzip2.c
     $ <b>runspec --config=tmp --extension=mt bzip | grep bzip2.c</b>
[6]  cc -c -o bzip2.o -DSPEC_CPU -DNDEBUG   -xO2 -w        bzip2.c
     $ 
     $ <b>runspec --config=tmp --tune=base sphinx3 | grep utt.c</b>
[7]  cc -c -o utt.o -DSPEC_CPU -DNDEBUG -I. -DSPEC_CPU -DHAVE_CONFIG_H 
     -I. -Ilibutil   -xO1 -w   utt.c
     $ <b>runspec --config=tmp --tune=peak sphinx3 | grep utt.c</b>
[8]  cc -c -o utt.o -DSPEC_CPU -DNDEBUG -I. -DSPEC_CPU -DHAVE_CONFIG_H 
     -I. -Ilibutil   -xO4 -w   utt.c
     $ <b>runspec --config=tmp --extension=mt sphinx3 | grep utt.c</b>
[9]  cc -c -o utt.o -DSPEC_CPU -DNDEBUG -I. -DSPEC_CPU -DHAVE_CONFIG_H 
     -I. -Ilibutil   -xO5 -w   utt.c
     $ <b>runspec --config=tmp --tune=peak --extension=mt sphinx3 | grep utt.c</b>
[10] cc -c -o utt.o -DSPEC_CPU -DNDEBUG -I. -DSPEC_CPU -DHAVE_CONFIG_H 
     -I. -Ilibutil   -xO4 -w   utt.c
     $ 
</pre>

<p>Notice above that the named benchmark always wins: lines [1], [2], and [3].  If there is no section specifier that names a
benchmark, but there is a section specifier that names a suite, then the suite wins: lines [4], [5], and [6].  If there are
no applicable benchmark or suite specifiers, then tuning or extension can be applied: lines [8] and [9].  But if both tuning
and extension are applied, tuning wins [10].</p>


<h4 id="sectionI.C.4"> I.C.4. MD5 Section</h4>

<p>The final section of your config file is generated automatically by the tools when the benchmarks are compiled, and looks
something like this:</p>

<pre>   __MD5__
   458.sjeng=base=none=default:
   # Last updated Thu May 11 08:53:12 2006
   optmd5=a0104c0975ee3b341e73437843df57a9
   baggage=
   compile_options=\
   @eNpz9vcNsFJITlbQBaJ8hfyCksz8vGK9fAVdl+AAV+d454BQINPPxdUp1F1BQUG3wt9YQbdcAR3Y\
   FOeXFiWn2nE5Wyk4O9sqJScrgZn+Tl7+ASG2SiimK3EBrQQa7Obj6B4MlMO0SYnL30oBqNHT1zPK\
   FagCYqsSl4+nnzfYtVgcYpOflJWaXFJshySGsBPkGh8XiMOwmw1W4B8KciySSwGYpEmr
   exemd5=9b42a21f12b1fbb4e87cd9bacd781c43

</pre>

<p>The "MD5" is a checksum that ensures that the binaries referenced in the config file are in fact built using the options
described therein.  For example, if you edit the config file to change the optimization level for 458.sjeng, the next time
the file is used for sjeng, the tools will notice the change and will recompile it.</p>

<p>You can optionally disable this behavior, but doing so is strongly discouraged.  See the acerbic remarks in the
description of <a href="#check_md5"><tt>check_md5</tt></a>, below.</p>

<p>If you would like to see what portions of your config file are used in computing the MD5 hash, <tt>runspec</tt> with
<span class="ttnobr">--debug=30</span> or higher, and examine the log file.</p>

<p>For published results, the published config file (from <span class="ttnobr">rawformat --output_format=config</span>) does
not include the MD5 section.</p>

<h4 id="sectionI.C.5"> I.C.5. Shell-like "here documents" and continued lines</h4>

<p>Shell-style "here documents" are supported for setting variables to multi-line values.  Continued lines (with \) are also
supported:</p>

<pre>   $ <b>cat tmp2.cfg</b>
   expand_notes  = 1
   size          = test
   runlist       = sjeng
   iterations    = 1
   output_format = text

   foo =&lt;&lt;EOT

   This +
   is a +
   test +
   EOT

   bar = \
         and +\
         so  +\
         is  +\
         this+

   notes01 = $foo
   notes02 = $bar

   $ <b>runspec --config=tmp2 | grep txt</b>
           format: ASCII -&gt; /ailuropoda/raj/spec/result/CINT2006.159.test.txt
   $ <b>grep + ../result/*159*txt</b>
       This +
       is a +
       test +
             and +
             so  +
             is  +
             this+
   $
</pre> 

<p>Note: although continued lines are supported, they are rarely used.  The more common method of continuation is by
appending a number to a field, as described in the section <a href="#sectionV.B">"Field scoping and continuation"</a>.</p>

<h4 id="sectionI.C.6"> I.C.6. Included files</h4>

<p>It is possible to include another file in your config file.  A typical use for this feature might be to keep all the
software information in the main config file, but to include the hardware information about the current System Under Test
(SUT) in another file.  For example:</p>

<pre>   $ <b>cat tmp.cfg</b>
   output_format = text
   iterations    = 1
   size          = test
   sw_compiler   = myC V1.0
   sw_avail      = Mar-2007
   runlist       = sjeng
   include: SUT.inc

   default=base:
   OPTIMIZE = -O
   $ <b>cat SUT.inc</b>
   hw_model = SuperHero IV
   hw_avail = Feb-2008

   $ <b>runspec --config tmp | grep txt</b>
           format: ASCII -&gt; /manas/spec/result/CINT2006.160.test.txt
   $ <b>grep avail ../result/*160.test.txt</b>
    [...]       Hardware availability: Feb-2008
    [...]       Software availability: Mar-2007
   $ 
</pre>

<p>Notice above that the report mentions both the hardware and software dates.</p>

<h3 id="sectionI.D"> I.D. Variable Substitution</h3>

<table style="border:none;">
<tr style="border:none;">
<td style="border:none; padding-right:1em;">

<p>You can do variable substitution using your config file.  But, as described in the <a href="#sectionI.B">Introduction</a>,
the contents of a config are directed to various consumers.  Therefore, effective use of variable substitution requires you
to be aware of which software is doing the substitution.  Differing syntax is used for each.</p>

<table>
<tr>
   <th>%{macro_name}</th>
   <td><p class="snug">The config file preprocessor does <i>macro</i> substitution.  Macros to be substituted always use a
   percent sign and curly brackets: <tt>%{macro_name}</tt> See the <a href="#sectionVII">preprocessor</a> section for more
   information.  </p> </td>
</tr>

<tr>
  <th>$[variable]</th>
  <td><p class="snug">A dollar sign and square brackets cause <tt>runspec</tt> to do substitution immediately after reading
  the config file.  This is useful for variables that don't change during a run, for example <tt>$[top]</tt> to refer to the
  directory where SPEC CPU2006 has been installed.</p> </td>
</tr>

<tr>
  <th>$variable<br />${variable}</th>
  <td><p class="snug">A dollar sign and the name of a variable cause Perl variable interpolation to be used, for example
  <tt>$hw_avail</tt>.  Curly brackets can be used to help the parser avoid confusion with contiguous other content:
  <tt>${hw_avail}ish</tt>.</p> </td>
</tr>

<tr>
   <th>\$VARIABLE</th>
   <td><p class="snug">If <tt>runspec</tt> generates an external command which is handed off to your shell (or command
   interpreter), the variable will be interpreted according to the rules of your shell.  Such a variable might look like
   this: <tt>\$SPEC</tt>.</p></td>
</tr>

<tr>
   <th>$(VARIABLE)</th>
   <td><p class="snug">If the variable is handed off to <tt>specmake</tt>, it is interpreted by the usual rules of GNU 
   make.  Such variables might look like this: <tt>$(FOPTIMIZE)</tt>.</p></td>
</tr>

</table>

</td>
<td style="background:#fff28a; width: 25%; padding:.5em; border:thin solid gray;">
<p style="font-family:cursive;">
q. Wait a minute... all these choices for substitution?  Which one do I want?</p>

<p>a. You probably want <a href="#sectionVII">the preprocessor</a>.</p>

<p>Have a look at the example at the top of <a href="#sectionVII">Section VII</a>.   If that looks like what you want, you're
all set; otherwise, you'll have to think through which consumer you are addressing (runspec, specmake, or the shell) and pick
your syntax accordingly.</p>
</td></tr></table>



<h4 id="sectionI.D.1"> I.D.1. By runspec</h4>

<p>Substitution by <tt>runspec</tt> itself uses two different methods: the <a href="#sectionI.D.1.a">first</a> is immediately
after the config file is read, and the <a href="#sectionI.D.1.b">second</a> is via Perl variable interpolation.</p>

<h5 id="sectionI.D.1.a">I.D.1.a At startup: $[variable]</h5>

<p>Substitution for variables of the form <tt>$[variable]</tt> happens immediately after the config file is read.  Any value
that's set in the config file and is visible in the scope where the variable is used can be substituted.  Because of the
named section scoping restriction, if you want to use variable substitution to note your optimization flags, the notes for
the individual benchmarks must be in those benchmarks' sections:</p>

<pre>
400.perlbench=peak=default=default:
PEAKFLAG=-gofast
# The following will turn into what you expect
notes_peak_400_1=I use $[PEAKFLAG]

400.perlbench=base=default=default:
BASEFLAG=-besafe
# The following will turn into what you expect:
notes_base_400_1=I use $[BASEFLAG]
<span class="alarm"># The following will NOT WORK:
notes_base_400_2=My brother likes $[PEAKFLAG]</span>
</pre>

<p>You can't substitute variables that don't exist or whose values aren't known when the config file is read.</p>

<p class="snugbot"><span class="alarm">Wrong:</span></p><pre class="alarm" style="margin-top:0em;
padding-left:.2em;;border-left: thin solid red;">ext = foo

default:
OPTIMIZE = -xO2
notes01 = my ext is $[ext]

default=default=bar:
OPTIMIZE = -xO1
notes02 = my ext is $[ext]
</pre>

<p>This doesn't work because the sorting of which extensions to use doesn't happen until after the config file is
processed.  In this particular example, it's obvious (to <b>you</b>) what the value should be, but the tools aren't as clever
as you are.</p>


<p>Perhaps the most useful variable is the one for the top of the SPEC CPU2006 tree, <tt>$[top]</tt>, often found in 
contexts such as:</p>

<pre>
    flagsurl = $[top]/myflagsdir/myflagsfile.xml
</pre>

<p>Variables of possible interest might include:</p>

<table>
<tr>
  <th>configpath</th>
  <td>The location of your config file</td>
</tr>
<tr>
  <th>dirprot</th>
  <td>protection that is applied to directories created by runspec</td>
</tr>
<tr>
  <th>endian</th>
  <td>4321 for big endian, 1234 for little</td>
</tr>
<tr>
  <th>flag_url_base</th>
  <td>directory where flags files are looked up</td>
</tr>
<tr>
  <th>OS</th>
  <td>unix or windows</td>                 
</tr>
<tr>
  <th>os_exe_ext</th>
  <td>exe for windows, nil elsewhere </td>
</tr>
<tr>
  <th>realuser</th>
  <td>the user name according to the OS</td>
</tr>
<tr>
  <th>top</th>
  <td>the top directory of your installed SPEC CPU2006 tree</td>
</tr>
<tr>
  <th>username</th>
  <td>the <a href="runspec.html#username">username</a> for purposes of tagging run directories</td>
</tr>
<tr>
  <th>uid</th>
  <td>the numeric user id</td>
</tr>
</table>

<p>You can substitute for most options that you enter into the config file, including: <tt>
action, allow_extension_override, backup_config, basepeak, check_md5, check_version, command_add_redirect, config, copies, delay,
deletework, difflines, env_vars, expand_notes, expid, ext, fake, feedback, flagsurl, http_proxy, http_timeout, ignore_errors,
ignore_sigint, info_wrap_columns, iterations, line_width, locking, log_line_width, mach, mail_reports, mailcompress,
mailmethod, mailport, mailserver, mailto, make, make_no_clobber, makeflags, max_active_compares, mean_anyway,
minimize_builddirs, minimize_rundirs, no_input_handler, no_monitor, notes_wrap_columns, notes_wrap_indent, output_format,
output_root, plain_train, rate, rawformat, rebuild, reportable, runlist, section_specifier_fatal, sendmail, setprocgroup, size, strict_rundir_verify,
sysinfo_program, table, teeout, tune, use_submit_for_speed, username, verbose, version_url.</tt></p>

<p>You can also print out the value of additional variables that you may have created.</p>

<p>Here is a sample config file that illustrates square bracket variable substitution:</p>

<pre>
$ cat x.cfg
expand_notes = 1
runlist      = fp
action       = validate
myfriend     = jamiemeow
output_root  = /tmp
flagsurl     = $[top]/Docs/flags/flags-advanced.xml

notes01      = Today, I am running $[runlist] in $[top] on a $[OS] system 
notes02      = Today the flags file is $[flagsurl]
notes03      = Today, my favorite friend is $[myfriend]

$ runspec --config=x  --fakereportable | grep txt
        format: ASCII -&gt; /tmp/result/CFP2006.002.txt
$ grep Today /tmp/result/CFP2006.002.txt
     Today, I am running fp in /spec/cpu2006 on a unix system 
     Today the flags file is /spec/cpu2006/Docs/flags/flags-advanced.xml
     Today, my favorite friend is jamiemeow
</pre>

<p>You can't use square brackets to substitute variables whose value changes during a run or build.</p>

<p class="snugbot"><span class="alarm">Wrong:</span></p><pre class="alarm" style="margin-top:0em;
padding-left:.2em;;border-left: thin solid red;">default=default=default=default:
#        I executed ''
notes0 = I executed '$[command]'
</pre>

<p>What did you expect?</p>

<p>Don't worry -- you'll receive a warning if you use a variable that the tools don't know about.  It's up to you to heed
them.</p>

<h5 id="sectionI.D.1.b">I.D.1.b During a run: $variable, ${variable}</h5>

<p>The second round uses Perl variable interpolation.  Only Perl scalars (denoted by a leading $) can be interpolated.  For
example, <tt>notes001</tt> below uses the log file number (generated by the tools) and the hardware availability date (which
was set directly):</p>

<pre>
$ <b>cat tmp.cfg</b>
runlist       = mcf
tune          = base
size          = test

iterations    = 1
output_format = asc

expand_notes  = 1
hw_avail      = May-2006
notes001      = This run is from log.$lognum with hw_avail $hw_avail

$ <b>runspec -c tmp | grep txt</b>
        format: ASCII -&gt; /spec/david/result/CINT2006.029.test.txt
$ <b>grep with ../result/*029*txt</b>
     This run is from log.029 with hw_avail May-2006
$ 
</pre>

<p>In this case, <tt>$hw_avail</tt> could also have been substituted in the first round by writing it as
<tt>$[hw_avail]</tt>.  In general, for variable interpolation, the earlier the better.</p>

<p>To put text immediately after a variable, you need to make it possible for the parser to see the variable that you want,
by using braces:</p>

<pre>   % <b>tail -2 tmp.cfg</b>
   notes001 =You have done ${lognum}x runs tonight, go to bed.

   % <b>runspec -c tmp | grep txt</b>
      format: ASCII -&gt; /john/result/CINT2006.103.test.txt
   % <b>grep done /john/result/CINT2006.103.test.txt</b>
      You have done 103x runs tonight, go to bed.
</pre>

<p>Interpolation won't always do what you wish it might do: for example, some variables are only defined at certain times,
and your <tt>submit</tt> or <tt>notes</tt> line might be interpolated at a different time.  When debugging a config files
that uses variable interpolation, you will probably find <a style="white-space:nowrap;" href="runspec.html#size">--size test</a>
useful.</p>

<p>Some things that you might choose to interpolate include:</p>
<table>
<tr>
    <th>baseexe</th>
    <td>The first part of the executable name, which is <span class="ttnobr">&lt;baseexe&gt;_&lt;tune&gt;.&lt;ext&gt;</span>.
    For example, in "<span class="ttnobr">libquantum_base.foo</span>", <span class="ttnobr">baseexe</span> is "<span
    class="ttnobr">libquantum</span>".</td>
</tr>
<tr>
    <th>benchmark</th>
    <td>The number and name of the benchmark currently being run, for example <tt>462.libquantum</tt></td>
</tr>
<tr>
    <th>benchname</th>
    <td>The name of the benchmark currently being run, for example <tt>libquantum</tt></td>
</tr>
<tr>
    <th>benchnum</th>
    <td>The number of the benchmark currently being run, for example <tt>462</tt></td>
</tr>
<tr>
    <th>benchtop</th>
    <td>The top directory for the benchmark currently being run, for example
    <tt>/spec/cpu2006/benchspec/CPU2006/462.libquantum</tt></td>
</tr>
<tr>
    <th>BIND</th>
    <td>A value from your <a href="#bind">bind</a> list.  This variable is actually interpreted by <a
    href="utility.html#specinvoke">specinvoke</a>, and cannot be spelled with braces.  Say <tt>$BIND</tt>, do 
    not say <tt>${BIND}</tt>.</td>
</tr>
<tr>
    <th>command</th>
    <td>The current command, for example <span class="ttnobr"> ../run_peak_test_foo.0001/bzip2_peak.foo dryer.jpg 2 &gt; dryer.jpg.out 2&gt;&gt; dryer.jpg.err</span> 
    </td>
</tr>
<tr>
    <th>commandexe</th>
    <td>The executable for the current command, for example <span class="ttnobr"> ../run_peak_test_foo.0001/bzip2_peak.foo</span></td>
</tr>
<tr>
    <th>ext</th>
    <td>The extension for the benchmark being run</td>
</tr>
<tr>
    <th>iter</th>
    <td>The current iteration number</td>
</tr>
<tr>
    <th>logname</th>
    <td>The complete log file name, for example <span class="ttnobr">/spec/cpu2006/result/CPU2006.168.log</span></td>
</tr>
<tr>
    <th>lognum</th>
    <td>The log file number, for example <tt>168</tt></td>
</tr>
<tr>
    <th>SPECCOPYNUM</th>
    <td>The current copy number, when running a rate run.  This variable is actually interpreted by <a
    href="utility.html#specinvoke">specinvoke</a>, and cannot be spelled with braces.  Say <tt>$SPECCOPYNUM</tt>, do not say
    <tt>${SPECCOPYNUM}</tt>.</td>
</tr>
<tr>
    <th style="text-decoration:line-through;">SPECUSERNUM</th>
    <td><span class="alarm">Do not use.</span>  This is the older, obsolete, CPU2000 spelling for what is now called
    SPECCOPYNUM.  This spelling will be removed in the first update of CPU2006.</td>
</tr>
<tr>
    <th>tune</th>
    <td>The tuning for the benchmark being run (<tt>base</tt> or <tt>peak</tt>)</td>
</tr>
</table>

<p>For example, let's say you want to go for minimal performance.  You might want to do this with the <tt>nice</tt> command.
You can say:</p> 

<pre>   submit=nice 20 '$command'
</pre>

<p>and the <tt>$command</tt> gets expanded to whatever would normally be executed but with <tt>nice 20</tt> stuck in front of it.</p>

<p>If you'd like a complete list of the variables that you can use in your commands (relative to the config file you're
using), set <tt>runspec</tt>'s verbosity to 35 or higher (<span class="ttnobr">-v 35</span>) and do a run that causes a
command substitution to happen, with <span class="ttnobr">expand_notes=1</span>.</p>


<h5 id="sectionI.D.1.c"> I.D.1.c Example: cleaning files before a training run</h5>

<p> Perhaps a more useful example is this one, which directs the shell to clean files related to the current executable in
the temporary directory, before a training run for feedback directed optimization:</p>

<pre>   fdo_pre0     = mkdir /tmp/pb; rm -f /tmp/pb/${baseexe}*
</pre>

<p> NOTICE in this example that although the commands are carried out by the shell, the variable substitution is done by
<tt>runspec</tt>.</p>


<h5 id="sectionI.D.1.d">I.D.1.d Example: submit to multiple nodes, Tru64 Unix</h5>

<p> The following lines submit to multiple nodes on a Compaq AlphaServer SC Series Supercomputer running Tru64 Unix:</p>

<pre>   submit= echo "$command" &gt; dobmk; prun -n 1 sh dobmk
   command_add_redirect=1
</pre>

<p> In this example, the command that actually runs the benchmark is written to a small file, <tt>dobmk</tt>, which is then
submitted to a remote node selected by <tt>prun</tt>.  The parallel run command, <tt>prun</tt>, can execute multiple copies
of a process, but in this case we have requested just one copy by saying <tt>-n 1</tt>.  The SPEC tools will create as many
copies as required.</p>

<p>The <tt>command_add_redirect</tt> is crucial.  What happens without it?</p>

<pre>$ <b>head prun1.cfg</b>
submit= echo "$command" &gt; dobmk; prun -n 1 sh dobmk

ext            = prun
action         = validate
runlist        = libquantum
size           = test
use_submit_for_speed = 1
iterations     = 1        
ignore_errors  = 1
output_format  = text
$ <b>runspec -c prun1.cfg </b>
...
$ <b>cd $SPEC/benchspec/CPU2006/462.libquantum/run/run_base_test_prun.0000/</b>
$ <b>cat dobmk </b>
../run_base_test_prun.0000/libquantum_base.prun 33 5
$ 
</pre>

<p>Now let's use command_add_redirect, and see how dobmk changes:</p>

<pre>$ <b>diff prun1.cfg prun2.cfg </b>
1a2
&gt; command_add_redirect=1
$
$ <b>runspec -c prun1.cfg </b>
...
$ <b>cd $SPEC/benchspec/CPU2006/462.libquantum/run/run_base_test_prun.0000/</b>
$ <b>cat dobmk </b>
../run_base_test_prun.0000/libquantum_base.prun 33 5 &gt; test.out 2&gt;&gt; test.err
$ 
</pre>

<p> Notice that with <span class="ttnobr">command_add_redirect=1</span>, the substitution for <tt>$command</tt> includes both
the name of the executable and the file assignments for standard in, standard out, and standard error.  This is needed
because otherwise the files would not be connected to libquantum on the remote node.  That is, the former generates [*]:</p>

<pre>echo "libquantum_base.prun 33 5" &gt; dobmk; 
prun -n 1 sh dobmk &gt; test.out 2&gt;&gt; test.err
</pre>

<p> And the latter generates [*]:</p>

<pre>echo "libquantum_base.prun 33 5 &gt; test.out 2&gt;&gt; test.err" &gt; dobmk; 
prun -n 1 sh dobmk
</pre>
         <p class="commentary">[*] The picky reader may wish to know that the examples were editted for readability: a line
         wrap was added, and the directory string <tt>.../run_base_test_prun.0000/</tt> was omitted.  The advanced reader may
         wonder how the above lines were discovered: for the former, we found out what <tt>runspec</tt> would generate by
         going to the run directory and typing <tt>specinvoke -n</tt>, where <tt>-n</tt> means dry run; in the latter, we
         typed <tt>specinvoke -nr</tt>, where <tt>-r</tt> means that <tt>$command</tt> already has device redirection.  For
         more information on <tt>specinvoke</tt>, see <a href="utility.html#specinvoke">utility.html</a>.  </p>
         

<h5 id="sectionI.D.1.e">I.D.1.e Example: bind to processors, SPEC TurboBlaster9000</h5>

<p> The following lines bind copies to individual processors on a SPEC TurboBlaster 9000 running *nix:</p>

<pre>
   bind= 0, 4, 8, 12, 16, 20
   submit= procbind -p $BIND $command
</pre>

<p> In this example, the list of processors to bind is set using the <a href="#bind">bind</a> facility, which is then used as
an argument to the <tt>procbind</tt> command.  With these settings, the first copy will be bound to processor 0, the second
to processor 4, the third to processor 8, and so on.  If more than six copies are run, the list is re-used starting from the
beginning; that is, copy seven would also be bound to processor 0 and so on.</p>

<p>An equivalent way to say the same as the above would be</p>

<pre>
   bind0= procbind -p 0
   bind1= procbind -p 4
   bind2= procbind -p 8
   bind3= procbind -p 12
   bind4= procbind -p 16
   bind5= procbind -p 20
   submit= $BIND $command
</pre>

<p> The content of each of the <tt>bind</tt> settings need not be the same, or even similar.</p>

<p>Two important notes about the above submit commands:</p>

<ol>
     <li><tt>$BIND</tt> must be spelled exactly as it is in the examples above.  It is a limitation of the tools that saying
     things like <tt>${BIND}</tt> just won't work.</li>

     <li>For <tt>bind</tt> settings that contain whitespace or commas, the second form (multiple assignments) must be
     used.</li>

</ol>


<h4 id="sectionI.D.2"> I.D.2. By the shell \$VARIABLE </h4>

<p>Substitution by the shell - or by the windows command interpreter - uses backslash dollar sign.  The next two sections explain
why both punctuation marks are required, and then provide an example.</p> 

<h5 id="sectionI.D.2.a">I.D.2.a Protecting shell variables</h5>

<p> Because Perl variables look a lot like shell variables, you need to specially protect shell variables if you want to
prevent Perl from trying to interpret them.  Notice what happens with the protected and unprotected versions:</p>

<pre>$ <b>cat tmp.cfg</b>
runlist              = mcf
size                 = test
tune                 = base,peak
iterations           = 1

output_format        = asc
teeout               = 1
expand_notes         = 1
use_submit_for_speed = 1

default=peak=default=default:
submit = echo "home=$HOME; spec=$SPEC;" &gt; /tmp/chan; $command

default=base=default=default:
submit = echo "home=\$HOME; spec=\$SPEC;" &gt; /tmp/nui; $command
$ <b>runspec --config=tmp > /dev/null</b>
$ <b>cat /tmp/chan</b>
home=; spec=;
$ <b>cat /tmp/nui</b>
home=/home/chris; spec=/spec/cpu2006;
$ 
</pre>

<p>In the first <tt>submit</tt> command, <tt>$HOME</tt> and <tt>$SPEC</tt> were gobbled up by <tt>runspec</tt>.  But since
those are not the names of variables that can be interpolated, empty strings were the result.  In the second command, the
backslashes prevented <tt>runspec</tt> from interpreting the variables, so they were seen by the shell instead.</p>

<p>By default, <tt>submit</tt> is only applied to rate runs.  In this example, we used it for a speed run
as well, by setting</p>

<pre>use_submit_for_speed = 1 
</pre>

<p> in the configuration file.</p>


<h5 id="sectionI.D.2.b">I.D.2.b Example: submitting to multiple nodes, SGI Origin 2000</h5>

<p> Here is a more complex example which uses substitution by both <tt>runspec</tt> and by the shell (line wraps added for
readability):</p>

<pre>   submit= 
      let "NODE=$SPECCOPYNUM/2"; 
      export NODE=/hw/nodenum/\$NODE; 
      let "CPU=2*(($SPECCOPYNUM+1)/2)-$SPECCOPYNUM "; 
      export CPU; 
      /usr/sbin/dplace -place \$SPEC/submit.pf -mustrun $command
</pre>

<p>First, <tt>runspec</tt> substitutes the current copy number for<tt> $SPECCOPYNUM</tt>, and then passes the above command
to the shell which does the substitutions for CPU and NODE.  This example originated on an SGI Origin 2000 system, where
there are two CPUs per node.  Suppose that <tt>runspec</tt> is about to submit the copy for copy number 17.  In that
case:</p>

<pre>   submit= 
      let "NODE=$SPECCOPYNUM/2";             # i.e. 17, so NODE=8
      export NODE=/hw/nodenum/\$NODE;        # Now NODE=/hw/nodenum/8
      let "CPU=2*(($SPECCOPYNUM+1)/2)-$SPECCOPYNUM ";  # and CPU=1
      export CPU; 
      /usr/sbin/dplace                       # So we execute dplace
        -place \$SPEC/submit.pf              # using $SPEC/submit.pf
        -mustrun $command                    # and the expected command
</pre>

<p> The desired <tt>$command</tt> is run under the control of <tt>submit.pf</tt>, with <tt>$NODE=/hw/nodenum/8</tt> and
<tt>$CPU=1</tt>.  Here are the contents of the placement file, <tt>submit.pf</tt>:</p>

<pre>   memories 1 in topology physical near $NODE
   threads 1
   run thread 0 on memory 0 using cpu $CPU
</pre>

<p> An important note about the above submit command:</p>

<ul>
     <li><tt>$SPECCOPYNUM</tt> must be spelled exactly as it is in the examples above.  It is a limitation of the tools that
     saying things like <tt>${SPECCOPYNUM}</tt> just won't work.</li>
</ul>


<h4 id="sectionI.D.3"> I.D.3. By specmake: $(VARIABLE)</h4>

<p>Variables with a dollar sign and parentheses, aka "round brackets", are substituted by <tt>specmake</tt>.  For
example:</p>
<pre>
    COMPILER_DIR=/usr/local/bin/
    CC=$(COMPILER_DIR)cc
</pre>

<p>For a more extensive example of variable substitution handled by <tt>specmake</tt>, see the SPEC CPU2000 example at <a
href="http://www.spec.org/cpu2000/docs/example-advanced.cfg">www.spec.org/cpu2000/docs/example-advanced.cfg</a>.  Search that
file for LIBS, and note the long comment which provides a walk-through of a complex substitution handled by
<tt>specmake</tt>.  <b>Note:</b> a CPU2006 version of that example will be provided at a later date; but the concepts, from
the CPU2000 example, are expected to work in a similar fashion for CPU2006.</p>

<p><span class="alarm">Deprecated feature alert: Although it is also possible to pass information to <tt>specmake</tt> using
curly brackets: <tt>${SPECMAKE}</tt>, this is not recommended.</span>  Instead, you should consistently use curly brackets to
address <tt>runspec</tt> and round brackets to address <tt>specmake</tt>.  It is possible that a future version of
<tt>runspec</tt> may insist on interpolating curly brackets itself, rather than allowing <tt>specmake</tt> to do so.</p>


<h4 id="sectionI.D.4"> I.D.4. Limitations on variable substitution</h4>

<p>Once <tt>runspec</tt> hands control over to <tt>specmake</tt> or to the shell, the results of further substitution are
invisible to <tt>runspec</tt>.  For this reason, you can't say:</p>

<p class="snugbot"><span class="alarm">Wrong:</span></p><pre class="alarm" style="margin-top:0em;
padding-left:.2em;;border-left: thin solid red;">MYDIR         = /usr/gretchen/compilers
FC            = $(MYDIR)/f90
notes_comp001 = compiler: $(FC)
</pre>

<p>However, there are a couple of ways to get around this restriction.  The best way for global settings is to use the <a
href="#sectionVII">preprocessor</a>:</p>

<pre>
%define MYDIR /usr/gretchen/compilers
FC            = %{MYDIR}/f90
notes_comp001 = compiler: %{MYDIR}/f90
</pre>

<p>That leaves a little to be desired, though, doesn't it?  If your Fortran compiler is changed to 'f2001', you still need
to remember to change it in two places.  You could of course define a whole macro for this:</p>

<pre>
%define MYFC /usr/gretchen/compilers/f90
FC            = %{MYFC}
notes_comp001 = compiler: %{MYFC}
</pre>

<p>But what if you have a config file where FC might be set in multiple places, and you really want to know how it was set
<strong>right here</strong>?  In that case, use a combination of the preprocessor and variable substitution:</p>

<pre>
$ cat right_here.cfg 
%define MYDIR /usr/gretchen/compilers

default=base:
FC            = %{MYDIR}/f2001
notes_comp001  = For base, we used this Fortran: $[FC] 

410.bwaves=peak:
FC            = %{MYDIR}/f77
notes_comp002 = For 410.bwaves peak, we used this Fortran: $[FC]

$ runspec -c right_here.cfg --fakereportable fp | grep txt       
        format: ASCII -&gt; /usr/gretchen/spec/result/CFP2006.179.txt
$ tail -15 ../result/*179.txt

                          Compiler Invocation Notes
                          -------------------------
     For base, we used this Fortran: /usr/gretchen/compilers/f2001 
     For 410.bwaves peak, we used this Fortran: /usr/gretchen/compilers/f77

    SPEC and SPECfp are registered trademarks of the Standard Performance
    Evaluation Corporation.  All other brand and product names appearing
    in this result are trademarks or registered trademarks of their
    respective holders.
-----------------------------------------------------------------------------
For questions about this result, please contact the tester.
For other inquiries, please contact webmaster@spec.org.
Copyright 2006 Standard Performance Evaluation Corporation
Generated on Wed Aug  2 09:39:53 2006 by SPEC CPU2006 ASCII formatter v4626
$ 
</pre>


<h4 id="sectionI.D.5"> I.D.5. Unsetting a variable with "%undef%"</h4>

<p>It is sometimes useful to be able to undo the setting of a variable that is defined in a lower-precedence section.
This is easily accomplished using the special value '%undef%':</p>

<pre>  $ <b>cat gnana.cfg</b>
   teeout = yes
   action = build
   runlist = bzip2

   default=default:
   OPTIMIZE = -O
   COPTIMIZE = -fast

   401.bzip2=peak:
   COPTIMIZE = %undef%

   $ <b>runspec --config=gnana --tune=base | grep bzip2.c</b>
   cc -c -o bzip2.o -DSPEC_CPU -DNDEBUG   -O -fast                bzip2.c
   $ <b>runspec --config=gnana --tune=peak | grep bzip2.c</b>
   cc -c -o bzip2.o -DSPEC_CPU -DNDEBUG   -O                 bzip2.c
   $ <b>go bzip</b>
   /spec/gnana/kit91/benchspec/CPU2006/401.bzip2
   $ <b>cd run/build_peak_none.0000/</b>
   $ <b>grep OPT Make*</b>
   Makefile.spec:COPTIMIZE        = 
   Makefile.spec:OPTIMIZE         = -O

</pre>

<p>As you can see in the peak compilation, the '-fast' flag was not present because the setting for COPTIMIZE had been
deleted.</p>


<h2 id="sectionII">II. Config file options for runspec</h2>

<p>This section documents options that control the operation of <tt>runspec</tt> itself.</p>  


<h3 id="sectionII.A">II.A. Options that can also be used on the runspec command line</h3>

<p>The following items can be specified in a config file, and have the same meaning as if they are specified on the
<tt>runspec</tt> command line.  Please see <a href="runspec.html">runspec.html</a> for details. </p> 

<p>In general, if options can be specified on both the <tt>runspec</tt> command line and in a config file, the command line
will win vs. items specified in the <a href="#header">header section</a>, but will not win over items specified in named
sections.  Effectively, the order of precedence is:
</p>
<pre>
   named sections (highest)
   command line
   header section (lowest)
</pre>

<p>For an example of these precedence rules in action, see <a href="#sectionVI.E">section VI.E.</a> on
<tt>--feedback</tt></p>

<p class="snugbot">In the table that follows, the "Use In" column indicates where the option can be used:</p>
<table style="border-style:none; padding:2px 2em 1em">
<tr>
   <td style="border-style:none;"><tt>H</tt></td>
   <td style="border-style:none;">use only in <a href="#sectionI.C.2">header section</a></td>
</tr>
<tr>
   <td style="border-style:none;"><tt>N</tt></td>
   <td style="border-style:none;">use in a <a href="#sectionI.C.3">named section</a>.</td>
</tr>
<tr>
   <td style="border-style:none;"><tt>H,N</tt></td>
   <td style="border-style:none;"> can be used in both the <a href="#sectionI.C.2">header section</a> and in <a
   href="#sectionI.C.3">named sections</a>.  The item can therefore be applied on a global basis, and/or can be applied to
   individual benchmarks.</td>
</tr>
</table>

<table> 
<tr>
   <td><b>Option</b></td>
   <td><b>Use&nbsp;In</b></td>
   <td><b>Default</b></td>
   <td><b>Meaning</b></td>
</tr>


<tr>
   <td id="action"><a href="runspec.html#action"><tt>action</tt></a> </td>
   <td><tt>H</tt></td>
   <td><tt>validate</tt></td>
   <td>What to do.  </td>
</tr>

<tr>
   <td id="check_version" > <a href="runspec.html#check_version"><tt>check_version</tt></a> </td>
   <td><tt>H</tt></td>
   <td><tt>0 (1 for<br />reportable<br />runs)</tt></td>
   <td><p class="snugtop">When set, before doing a <a href="#reportable">reportable</a> run, <tt>runspec</tt> will download a
   small file (~15 bytes) from www.spec.org containing the current version of the suite and the date it was released, and
   check your copy vs.  that file.  In this way, you can be notified if the version of the suite that you're using is
   out-of-date.  </p>
   
   <p>Setting this variable to <tt>0</tt> will disable this check.</p>  
   
   <p>If you'd like to check a local file instead, you can modify <a
   href="#version_url">version_url</a> to point to your internal copy.  </p>

   <p class="snugbot">If you would like to check your version for a NON-reportable run, you will need to add <span
   class="ttnobr">--check_version</span> to your command line.  Setting <span class="ttnobr">check_version=1</span> in the
   config file only causes the check for reportable runs.  <span class="new">The check_version feature is new with
   CPU2006.</span></p></td>
</tr>

<tr>
   <td id="copies" > <a href="runspec.html#copies"><tt>copies</tt></a> </td>
   <td><tt>H,N</tt></td>
   <td><tt>1</tt></td>
   <td> Number of copies.  
   For base, the number of copies must be the same for 
   all benchmarks, but for peak it is allowed to vary: for example, 
   you could decide to run 64 copies of
   all benchmarks except <tt>458.sjeng</tt>, which would run only 63.   
   </td>
</tr>

<tr>
   <td id="delay" ><a href="runspec.html#delay"> <tt>delay</tt></a> </td>
   <td><tt>H,N</tt></td>
   <td><tt>0</tt></td>
   <td>Insert a delay of the specified number of seconds before and after benchmark execution.  This delay does not
   contribute to the measured runtime of the benchmark.  This delay is also not available in a reportable run. <span
   class="new">(The delay feature is new with CPU2006.)</span></td>
</tr>

<tr>
   <td id="deletework" ><a href="runspec.html#deletework"> <tt>deletework</tt></a> </td>
   <td><tt>H,N</tt></td>
   <td><tt>0</tt></td>
   <td>If set to 1, always delete existing benchmark working directories.  An extra-careful person might want to set this to
   ensure no unwanted leftovers from previous benchmark runs, but the tools are already trying to enforce that property.</td>
</tr>

<tr>
   <td id="ext" ><a href="runspec.html#ext"> <tt>ext</tt></a> </td>
   <td><tt>H</tt></td>
   <td><tt>none</tt></td>
   <td>Extension for executables created.  This may not be set to any value that contains characters other than
   alphanumerics, underscores, hyphens, or periods.</td>
</tr>

<tr>
   <td id="feedback" ><a href="runspec.html#feedback"> <tt>feedback</tt></a> </td>
   <td><tt>H,N</tt></td>
   <td><tt>1</tt></td>

   <td><p class="snugtop">
   The <tt>feedback</tt> option applies an on/off switch for the use of feedback directed
   optimization (FDO), without specifying how the feedback will be done.</p>
   <ul>
     <li>If set to 0, then feedback will not be used, even if other options would normally cause it to occur.</li>
     <li>If set to 1, then feedback is allowed to be used, provided that additional options are also set to describe how the
     FDO build should be carried out.</li>
   </ul>

   <p class="snugbot">The interaction between <tt>feedback</tt> and these other options is described in <a
   href="#sectionVI">section VI</a>, below.</p>

   </td> 
</tr>   

<tr>
   <td id="flagsurl" ><a href="runspec.html#flagsurl"> <tt>flagsurl</tt></a> </td>
   <td><tt>H</tt></td>
   <td><tt>none</tt></td>
   <td>If set, retrieve the named URL or filename and use that as the "user" flags file.  If the special value "noflags" is
   used, runspec will not use any file and (if formatting previously run results) will remove any stored file. <span
   class="new">Automated prcoessing of flags is new with CPU2006, and is explained in <a
   href="flag-description.html">flag-description.html</a>.</span></td>
</tr>

<tr>
   <td id="http_proxy" > <tt><a href="runspec.html#http_proxy">http_proxy</a></tt> </td>
   <td><tt>H</tt></td>
   <td></td>
   <td><p class="snugtop">In some cases, such as when doing <a href="#check_version">version checks</a> and loading <a
   href="flag-description.html">flag description files</a>, <tt>runspec</tt> will use HTTP or FTP to fetch a file.  If you
   need to specify the URL of a proxy server, this is the variable to use.  By default, no proxy is used.  Note that this
   setting will override the value of the <tt>http_proxy</tt> environment variable.  For example, one might set:</p>

<pre>   http_proxy     = http://webcache.tom.spokewrenchdad.com:8080 
</pre>

   <p>Note: if an FTP proxy is needed, it must be set in the <tt>ftp_proxy</tt> environment variable; there is no
   corresponding config file setting.  </p>
   <p class="snugbot">Config files as posted at <a href="http://www.spec.org/cpu2006">www.spec.org/cpu2006</a> will not
   include whatever you put on this line.  <span class="new">Support for http proxies is new with CPU2006.</span> </p>
   </td>
</tr>

<tr>
   <td id="http_timeout" > <tt><a href="runspec.html#http_timeout">http_timeout</a></tt> </td>
   <td><tt>H</tt></td>
   <td>30</td>
   <td>This is the amount of time (in seconds) to wait while attempting to fetch a file via HTTP or FTP.  If the connection
   cannot be established in this amount of time, the attempt will be aborted.
   <span class="new">Support for http timeout is new with CPU2006.</span></td>
</tr>

<tr>
   <td id="ignore_errors" ><a href="runspec.html#ignore_errors"> <tt>ignore_errors</tt></a> </td>
   <td><tt>H</tt></td>
   <td><tt>0</tt></td>
   <td>Ignore certain errors which would otherwise cause the run to stop.  Very useful when debugging a new compiler and new
   set of options: with this option set, you'll find out about all the benchmarks that have problems, instead of only finding
   out about the first one.</td>
</tr>

<tr>
   <td id="info_wrap_columns" ><a href="runspec.html#info_wrap_columns"> <tt>info_wrap_columns</tt></a> </td>
   <td><tt>H</tt></td>
   <td><tt>50</tt></td>
   <td>When set to a value greater than <tt>0</tt>, attempts to split non-notes informational lines such that they are no
   longer than <tt>info_wrap_columns</tt> columns wide.  Lines are split on whitespace, and newly created lines are
   guaranteed to have at least the same indentation as the original line.  If a line contains an item that is longer than
   <tt>info_wrap_columns</tt>, a warning is logged and the original line is left unchanged.  <span class="new">Automatic 
   line wrapping is a new feature of CPU2006</span>.</td>
</tr>

<tr>
   <td id="iterations" ><a href="runspec.html#iterations"> <tt>iterations</tt></a> </td>
   <td><tt>H</tt></td>
   <td><tt>3</tt></td>
   <td>Number of iterations to run.</td>
</tr>

<tr>
   <td id="mach" ><a href="runspec.html#machine"> <tt>mach</tt></a> </td>
   <td><tt>H</tt></td>
   <td><tt>default&nbsp;&nbsp;</tt></td>
   <td>Default machine ID.  This may not be set to any value that contains characters other than alphanumerics, underscores,
   hyphens, or periods.</td>
</tr>

<tr>
   <td id="make_no_clobber" ><a href="runspec.html#make_no_clobber"> <tt>make_no_clobber</tt></a> </td>
   <td><tt>H,N</tt></td>
   <td><tt>0</tt></td>
   <td>Don't delete directories when building executables.  This option should only be used for troubleshooting a problematic
   compile.  The tools will not allow you to use this option when building binaries for a reportable result.  Note that you
   could issue multiple successive <tt>runspec</tt> commands with this option set (either in the config file, or with the
   <span class="ttnobr">--make_no_clobber</span> switch), and the build directories will be preserved.  But once you remove
   <span class="ttnobr">make_no_clobber</span> (allowing it to default back to <tt>0</tt>), then the tools will attempt a
   normal build with a fresh build directory.
   </td>
</tr>

<tr>
   <td id="max_active_compares" ><a href="runspec.html#max_active_compares"><tt>max_active_compares</tt></a>&nbsp;&nbsp; </td>
   <td><tt>H,N</tt></td>
   <td><tt># copies</tt></td>
   <td>Max number of parallel compares.  Useful when doing large SPECrate runs on a system with lots of CPUs. </td>
</tr>

<tr>
   <td id="nobuild" ><a href="runspec.html#nobuild"> <tt>nobuild</tt></a> </td>
   <td><tt>H</tt></td>
   <td><tt>0</tt></td>
   <td>Do not attempt to build benchmarks.  Useful to prevent attempts to rebuild benchmarks that cannot be built.  
   <span class="new">The <span class="nobr">--nobuild</span> feature is new with CPU2006</span>.</td>
</tr>

<tr>
   <td id="notes_wrap_columns" ><a href="runspec.html#notes_wrap_columns"> <tt>notes_wrap_columns</tt></a> </td>
   <td><tt>H</tt></td>
   <td><tt>0</tt></td>
   <td>When set to a value greater than <tt>0</tt>, attempts to split notes lines such that they are no longer than
   <tt>notes_wrap_columns</tt> columns wide.  Lines are split on whitespace, and newly created lines are guaranteed to have
   at least the same indentation as the original line.  If a line contains an item that is longer than
   <tt>notes_wrap_columns</tt>, a warning is logged and the original line is left unchanged. <span class="new">Automatic line
   wrapping is a new feature of CPU2006</span>.</td> 
</tr>

<tr>
   <td id="output_format" ><a href="runspec.html#out"> <tt>output_format</tt></a> </td>
   <td><tt>H</tt></td>
   <td><tt>all</tt></td>
   <td>Format for reports.  Valid options are listed at <a href="runspec.html#out">runspec.html</a> under
   <tt>--output_format</tt>; major options include <tt>txt</tt> (ASCII text), <tt>html</tt>, <tt>pdf</tt>, and <tt>ps</tt>.  You
   might prefer to set this to <tt>txt</tt> if you're going to be doing lots of runs, and only create the pretty reports at
   the end of the series.  See also the information in <a href="runspec.html#rawformat">runspec.html</a> about 
   <tt>--rawformat</tt>.</td>
</tr>


<tr>
   <td id="reportable" ><a href="runspec.html#reportable"> <tt>reportable</tt></a> </td>
   <td><tt>H</tt></td>
   <td><tt>0</tt></td>
   <td>Strictly follow reporting rules.  You must set <tt>reportable</tt> to generate a valid run suitable for
   publication and/or submission to SPEC. </td>
</tr>
    
<tr>
   <td id="rate" ><a href="runspec.html#rate"> <tt>rate</tt></a> </td>
   <td><tt>H</tt></td>
   <td><tt>0</tt></td>
   <td>Rate vs Speed.  Specify 1 for rate, 0 for speed.</td>
</tr>
    
<tr>
   <td id="rebuild" ><a href="runspec.html#rebuild"> <tt>rebuild</tt></a> </td>
   <td><tt>H</tt></td>
   <td><tt>0</tt></td>
   <td>Rebuild binaries even if they exist.</td>
</tr>

<tr>
   <td id="runlist" ><a href="runspec.html#runlist"> <tt>runlist</tt></a> </td>
   <td><tt>H</tt></td>
   <td><tt>none</tt></td>
   <td>What benchmarks to run.  Names can be abbreviated, just as on the command line.</td>
</tr>

<tr>
   <td id="setprocgroup" ><a href="runspec.html#setprocgroup"> <tt>setprocgroup</tt></a> </td>
   <td><tt>H</tt></td>
   <td><tt>1</tt></td>
   <td>Set the process group.  On Unix-like systems, improves the chances that ^C gets the whole run, not just one of the
   children.</td>
</tr>

<tr>
   <td id="size" ><a href="runspec.html#size"> <tt>size</tt></a> </td>
   <td><tt>H</tt></td>
   <td><tt>ref</tt></td>
   <td>Size of input set.  If you are in the early stages of testing a new compiler or new set of options, you might set this
   to <tt>test</tt> or <tt>train</tt>.  </td>
</tr>

<tr>
   <td id="table" ><a href="runspec.html#table"> <tt>table</tt></a> </td>
   <td><tt>H</tt></td>
   <td><tt>1</tt></td>
   <td>In ASCII reports, include information about each execution of the benchmark.</td>
</tr>

<tr>
   <td id="tune" ><a href="runspec.html#tune"> <tt>tune</tt></a> </td>
   <td><tt>H</tt></td>
   <td><tt>base</tt></td>
   <td>default tuning level.  In a reportable run, must be either <tt><b>all</b></tt> or <tt><b>base</b></tt>.</td>
</tr>


<tr>
   <td id="verbose" ><a href="runspec.html#verbose"> <tt>verbose</tt></a> </td>
   <td><tt>H</tt></td>
   <td><tt>5</tt></td>
   <td>Verbosity level.  Select level 1 through 99 to control how much debugging info <tt>runspec</tt> prints out.  For more
   information, see the section on the <a href="#sectionVIII.B">log file</a>, below.</td>
</tr>
</table>


<h3 id="sectionII.B">II.B. Options for runspec that can only be used in a config file</h3>

<p>The following options control the operation of <tt>runspec</tt>, but can not be specified on the command line.  Instead,
they must be specified in the config file.</p>

<p class="snugbot">In the table that follows, the "Use In" column indicates where the option can be used:</p>
<table style="border-style:none; padding:2px 2em 1em">
<tr>
   <td style="border-style:none;"><tt>H</tt></td>
   <td style="border-style:none;">use only in <a href="#sectionI.C.2">header section</a></td>
</tr>
<tr>
   <td style="border-style:none;"><tt>N</tt></td>
   <td style="border-style:none;">use in a <a href="#sectionI.C.3">named section</a>.</td>
</tr>
<tr>
   <td style="border-style:none;"><tt>H,N</tt></td>
   <td style="border-style:none;"> can be used in both the <a href="#sectionI.C.2">header section</a> and in <a
   href="#sectionI.C.3">named sections</a>.  The item can therefore be applied on a global basis, and/or can be applied to
   individual benchmarks.</td>
</tr>
</table>

<table> 
<tr>
   <td><b>Option</b></td>
   <td><b>Use&nbsp;In</b></td>
   <td><b>Default</b></td>
   <td><b>Meaning</b></td>
</tr>

<tr>
   <td id="allow_extension_override" > <tt>allow_extension_override</tt> </td>
   <td><tt>H</tt></td>
   <td><tt>0</tt></td>
   <td><p class="snugtop">The <tt>runspec</tt> command can use <span class="ttnobr">--extension</span> to select among
   different options in a config file, as mentioned <a href="#sectionI.C.3.c">above</a>.  But what if the extension mentioned
   on the <tt>runspec</tt> command does not occur in any section marker?  What should be done then?</p>

   <ul>
   <li>If <tt>allow_extension_override</tt> is 0 (or <tt>no</tt> or <tt>false</tt>), the tools will print an error message
   and exit.</li>
   <li>If <tt>allow_extension_override</tt> is 1 (or <tt>yes</tt> or <tt>true</tt>), then the tools will attempt to build (or
   run) the same binary they would have built by default, but will name the binary with specified extension.  See the example
   <a href="#extoverride">above</a>.</li>
   </ul>

   <p class="snugbot"><span class="new">The allow_extension_override feature is new with CPU2006.</span></p>

   </td>
</tr>

<tr>
   <td id="backup_config" > <tt>backup_config</tt> </td>
   <td><tt>H</tt></td>
   <td><tt>1</tt></td>
   <td>When updating the MD5 hashes in the config file, make a backup copy first.  Highly recommended to defend against
   full-file-system errors, system crashes, or other unfortunate events.</td>
</tr>

<tr>
   <td id="basepeak" > <tt>basepeak</tt> </td>
   <td><tt>H,N</tt></td>
   <td><tt>0</tt></td>
   <td>Use base binary and/or base result for peak.  If applied to the whole suite (in the header section), then only base is
   run, and its results are reported for both the base and peak metrics.  If applied to a single benchmark, the same binary
   will be used for both base and peak runs, and the median of the base run will be reported for both.</td>
</tr>
    
<tr>
   <td id="bind" > <tt>bind</tt> </td>
   <td><tt>H</tt></td>
   <td><tt>''</tt></td>
   <td>List of values with which $BIND should be replaced in a <a href="#submit">submit</a> command.  If set, should either
   be set to a list of comma- or whitespace-separated values or, if more complex settings are desired, multiple settings can
   be used.  For example, both
<pre>
bind = 0, 4, 8, 16
</pre>
                                    and
<pre>
bind0 = 0
bind1 = 4
bind2 = 8
bind3 = 16
</pre>
<p>are equivalent.  Like <a href="#sectionV.C">notes</a>, the indices are not important and are used for ordering only.  The
latter form is required when substituting values that must contain whitespace or commas:</p>
<pre>
bind0 = procbind -p 0
bind1 = procbind -p 1
bind2 = procbind -p 2
</pre>
<p class="snugbot">If there are more copies than bind values, they will be re-used in a circular fashion.  If there are more
bind values specified than copies, then only as many as needed will be used.  <span class="new">The bind feature is
new with CPU2006.</span></p></td>
</tr>
    
<tr>
   <td id="check_md5" > <tt>check_md5</tt> </td>
   <td><tt>H</tt></td>
   <td><tt>1</tt></td>
   <td><tt>Runspec</tt> uses MD5 hashes to verify that executables match the config file that invokes them, and if they do
   not, <tt>runspec</tt> forces a recompile.  You can turn that feature off by setting check_md5=0.<br /> <b>WARNING</b>: If
   you turn this feature off, you effectively say that you are willing to run a benchmark even if you don't know what you did
   or how you did it -- that is, you lack information as to how it was built!  Since SPEC requires that you disclose how you
   built it, such a run could not be published.  Therefore, asking for a reportable run via the command-line switch <span
   class="ttnobr">--reportable</span> or setting <span class="ttnobr">reportable=1</span> in your config file will cause this
   option to be automatically enabled.</td> </tr>


<tr>
   <td id="command_add_redirect" > <tt>command_add_redirect</tt> </td>
   <td><tt>H</tt></td>
   <td><tt>0</tt></td>
   <td>If set, let the shell do I/O redirection.  Otherwise, specinvoke will do it itself.  This option is commonly used when
   using the <a href="#submit">submit</a> command; please see the example in <a href="#sectionI.D.1.d">section
   I.D.1.d</a>.</td>
</tr>
  
<tr>
   <td id="difflines" > <tt>difflines</tt> </td>
   <td><tt>H,N</tt></td>
   <td><tt>10</tt></td>
   <td>Number of lines of differences to print when comparing results.</td>
</tr>

<tr>
   <td id="env_vars" > <tt>env_vars</tt> </td>
   <td><tt>H,N</tt></td>
   <td><tt>0</tt></td>
   <td><p class="snugtop">If this variable is set to 1, then environment settings can be changed for benchmarks using <span
   class="ttnobr">ENV_*</span> options in the config file.  For example, consider the following executable, which fails
   because the library directory has been removed:</p>

<pre>   $ ls -l bwaves_base.tmp3
   -rwxrwxr-x   1 david ptg       304964 May 16 10:16 bwaves_base.tmp3
   $ ldd bwaves_base.tmp3 | head -3
           libmvec.so.1 =&gt;  /lib/libmvec.so.1
           libfui.so.2 =&gt;   (file not found)
           libfai.so.3 =&gt;   (file not found)
   $ 
</pre>

    <p class="snugbot">But if we add the following to the config file:</p>

<pre>   &gt;check_md5=0
   &gt;env_vars=1
   &gt;410.bwaves:
   &gt;ENV_LD_LIBRARY_PATH=/spec/david/lovecraft/lib
</pre>

    <p class="snugtop">then bwaves gets an LD_LIBRARY_PATH which points to the new library directory, and the benchmark runs
    successfully.</p>
 
   <p><span class="alarm">Note that <tt>env_vars</tt> is not legal for a reportable run.</span>
   The <a href="runrules.html#rule_3.4">run rules</a> require that the environment be set prior to the start of
   <tt>runspec</tt>.  Nevertheless, the feature is available, since it might be useful during debugging, or for
   instrumentation purposes when doing performance analysis.</p>

   <p><b>Which environment?</b>  If you are attempting to communicate settings from your shell environment into
   <tt>runspec</tt>, this is not the feature that you are looking for.  Try the <a href="#sectionVII">config file
   preprocessor</a> instead.  The <tt>env_vars</tt> option and <tt>ENV*</tt> are about communication from config file to
   environment of the invoked benchmark.</p>
   
   <p class="snugbot">When developing a config file that uses <tt>env_vars</tt>, you may find it useful to set the <a
   href="#verbose">verbosity level</a> to 35 (or higher), which will cause the tools to log environment settings.  <span
   class="new">CPU2006 newly provides logging of env_vars settings.</span></p></td>
</tr>

    
<tr>
   <td id="expand_notes" > <tt>expand_notes</tt> </td>
   <td><tt>H</tt></td>
   <td><tt>0</tt></td>
   <td>If set, will expand variables in notes.  This capability is limited because notes are NOT processed by
   <tt>specmake</tt>, so you cannot do repeated substitutions.  You'll find some suggestions <a
   href="#sectionI.D.4">above</a>.</td>
</tr>

<tr>
   <td id="expid" > <tt>expid</tt> </td>
   <td><tt>H</tt></td>
   <td></td>
   <td>If set to a non-empty value, will cause executables, run directories, results, and log files to be put in a
   subdirectory (with the same name as the value set) in their normal directories.  For example, setting <tt>expid = CDS</tt>
   will cause benchmark binaries to end up in <tt>exe/CDS</tt>, run directories to end up in <tt>run/CDS</tt>, and results
   and logs in <tt>$SPEC/result/CDS</tt>.  <span class="new">The expid feature is new with CPU2006.</span></td>
</tr>

<tr>
   <td id="fail" > <tt>fail</tt> </td>
   <td><tt>H,N</tt></td>
   <td><tt>0</tt></td>
   <td>If set, will cause a build or run to fail. <span class="new">The ability to force a run to fail is new with CPU2006</span> </td>
</tr>

<tr>
   <td id="fail_build" > <tt>fail_build</tt></td>
   <td><tt>H,N</tt></td>
   <td><tt>0</tt></td>
   <td><p class="snugtop">If set, will cause a build to fail.  For example, you could say something like this:</p>
<pre>
400.perlbench=default:
#&gt; I am posting this config file for use by others in the
#&gt; company, but am forcing it to fail here because
#&gt; I want to force users to review this section.
#&gt;
#&gt; Once you find your way here, you should test whether
#&gt; bug report 234567 has been fixed, by using the first
#&gt; line below.  If it has not been fixed, then use the
#&gt; second.  In either case, you'll need to remove the
#&gt; fail_build.
#&gt;
#&gt;   - Pney Guvaxre
#&gt;     Boomtime, the 66th day of Confusion in the YOLD 3172

# OPTIMIZE = -Osuperduper
# OPTIMIZE = -Omiddling
fail_build = 1
</pre>

<p>In the example above, the build is forced to fail until the user examines and modifies that section of the config file.
Notice that Pney has used <a href="#sectionI.C.1">protected comments</a> to cause the comments about the internal bug
report to disappear if the config file were to be published as part of a reportable run.</p>
 
   
   <span class="new">The ability to force a build to fail is new with CPU2006</span> </td>
</tr>

<tr>
   <td id="fail_run" > <tt>fail_run</tt> </td>
   <td><tt>H,N</tt></td>
   <td><tt>0</tt></td>
   <td>If set, will cause a run to fail.  <span class="new">The ability to force a run to fail is new with CPU2006</span> </td>
</tr>

<tr>
   <td id="ignore_sigint" > <tt>ignore_sigint</tt> </td>
   <td><tt>H</tt></td>
   <td><tt>0</tt></td>
   <td>Ignore SIGINT.  If this is set, <tt>runspec</tt> will attempt to continue running when you interrupt one of its child
   processes by pressing ^C (assuming that you have ^C mapped in the common way). Note that this does NOT cause runspec
   itself to ignore SIGINT.</td>
</tr>

<tr>
   <td id="inherit_from" > <tt>inherit_from</tt> </td>
   <td><tt>N</tt></td>
   <td><tt>''</tt></td>

   <td><p class="snugtop">If set within a benchmark section, allows explicit inheritance of settings from another benchmark's
   section.  The section to be inherited from is referenced using colons between the four <a href="#sectionI.C.3">section
   specifiers</a>.  Other inheritance mechanisms continue to work.  Effectively, the referenced benchmark is the second
   highest priority -- second only to items specifically mentioned in the referring section.  An example may help to clarify
   these points:</p>

<pre style="margin-bottom:.2em">   $ <b>cat -n tmp8.cfg</b>
        1  iterations = 1
        2  size       = test
        3  teeout     = yes
        4
        5  default=default:
        6  OPTIMIZE = -xO1 
        7
        8  int=default:
        9  OPTIMIZE = -xO2
       10  LIBS     = -lbsdmalloc
       11
       12  401.bzip2=default:
       13  OPTIMIZE = -xO3 
       14  CC = /update1/bin/cc
       15
       16  458.sjeng=peak:
       17  inherit_from = 401.bzip2:default:default:default
       18  CC = /update2/bin/cc
   $ <b>runspec --config tmp8 --tune base sjeng | grep sjeng.o</b>
   cc -c -o sjeng.o -DSPEC_CPU -DNDEBUG   -xO2               sjeng.c
   cc  -xO2           attacks.o book.o ...  -lbsdmalloc     -o sjeng
   $ <b>runspec --config tmp8 --tune peak sjeng | grep sjeng.o</b>
   /update2/bin/cc -c -o sjeng.o -DSPEC_CPU -DNDEBUG   -xO3  sjeng.c
   /update2/bin/cc  -xO3  attacks.o book.o ...  -lbsdmalloc  -o sjeng
   </pre>

   <p>In the above example,</p>
   <ul>

     <li>The first <tt>runspec</tt> command uses the tuning for integer benchmarks, from the config file lines 8-10. </li>

     <li>The second <tt>runspec</tt> command:
        <ul>
        <li>Still applies the integer tuning at line 10 (<tt>-lbsdmalloc</tt>).</li>
        <li>Does not apply the optimization level on line 9, because it is overridden by other options.  Line 17 says that we
        are to inherit from the bzip2 section, so the optimization level at line 13 (<tt>-xO3</tt>) is used instead.</li>
        <li>But the compiler path at line 14 (<tt>/update1</tt>) is not used: line 18 (<tt>/update2</tt>) is highest
        priority.</li>
        </ul></li>

   </ul>

  <p class="snugbot">Line 17 above could have been simplified.  Just as trailing <tt>default</tt> section specifiers can be
  omitted at the original definition points, as explained <a href="#omitspecs">above</a>, they can also be omitted on an
  <tt>inherit_from</tt> option.  <span class="new">The inherit_from feature is new with SPEC
  CPU2006.</span></p></td>

</tr>

<tr>
   <td id="line_width" > <tt>line_width</tt> </td>
   <td><tt>H</tt></td>
   <td><tt>0</tt></td>
   <td>Line wrap width for screen.  If left at the default, 0, then lines will not be wrapped and may be arbitrarily
   long.</td>
</tr>

<tr>
   <td id="locking" > <tt>locking</tt> </td>
   <td><tt>H</tt></td>
   <td><tt>1</tt></td>
   <td>Try to lock files.</td>
</tr>

<tr>
   <td id="log_line_width" > <tt>log_line_width</tt> </td>
   <td><tt>H</tt></td>
   <td><tt>0</tt></td>
   <td>Line wrap width for logfiles.  If your editor complains about lines being too long when you look at logfiles, try
   setting this to some reasonable value, such as 80 or 132.  If left at the default, 0, then lines will not be wrapped and
   may be arbitrarily long.</td>
</tr>

<tr>
   <td id="mailcompress" > <tt>mailcompress</tt> </td>
   <td><tt>H</tt></td>
   <td><tt>0</tt></td>
   <td>When using the 'mail' output format, turning this on will cause the various report attachments to be compressed with
   gzip.  <span class="new">Report mailing is a new feature of CPU2006.</span></td>
</tr>

<tr>
   <td id="mailmethod" > <tt>mailmethod</tt> </td>
   <td><tt>H</tt></td>
   <td><tt>smtp</tt></td>
   <td>When using the 'mail' output format, this specifies the method that should be used to send the mail.  On UNIX and
   UNIX-like systems, there are three choices: 'smtp' (communicate directly with an SMTP server over the network), 'mail'
   (try using mail(1) if available), and 'sendmail' (try invoking sendmail directly).  On Windows systems, only 'smtp' is
   available.  SMTP is the recommended setting.  <span class="new">Report mailing is a new feature of CPU2006.</span></td>
</tr>

<tr>
   <td id="mailport" > <tt>mailport</tt> </td>
   <td><tt>H</tt></td>
   <td><tt>25</tt></td>
   <td>When using the 'mail' output format, and when the mailmethod is 'smtp', this specifies the port to use on the mail
   server.  The default is the standard SMTP port and should not be changed.  <span class="new">Report mailing is a new
   feature of CPU2006.</span></td>
</tr>

<tr>
   <td id="mailserver" > <tt>mailserver</tt> </td>
   <td><tt>H</tt></td>
   <td><tt>127.0.0.1</tt></td>
   <td>When using the 'mail' output format, and when the mailmethod is 'smtp', this specifies the IP address or hostname of
   the mailserver through which to send the results.  <span class="new">Report mailing is a new feature of CPU2006.</span></td>
</tr>

<tr>
   <td id="mailto" > <tt>mailto</tt> </td>
   <td><tt>H</tt></td>
   <td><tt>''</tt></td>
   <td><p class="snugtop">The address or addresses to which results should be sent when using the 'mail' output format.  If
   multiple addresses are specified, they should be separated by commas or whitespace.  Each address should consist
   <b>only</b> of the name@domain part (i.e. no "full name" type info).  The addresses are not checked for correct
   formatting; if a mistake is made, the results may be sent to an unknown location.  Think: comp.arch.  OK, probably not
   there, but seriously be careful about security on this one.</p>

   <p>Config files as posted at <a href="http://www.spec.org/cpu2006">www.spec.org/cpu2006</a> will not include whatever you
   put on this line (thus, spambots will not see the contents of this field).</p>
   
   <p><b>Note</b> that to get your reports mailed to you,
   you need to specify both <tt>mail</tt> as an <tt>output_format</tt> and an address to which they should be mailed.  For
   example:</p>

<pre>   mailto=fast.guy@welovebenchmarks.org
   output_format=text,mail
</pre>
   <p class="snugbot">If no addresses are specified, no mail will be sent. 
   <span class="new">Report mailing is a new feature of CPU2006.</span></p> </td>
</tr>

<tr>
   <td id="mail_reports" > <tt>mail_reports</tt> </td>
   <td><tt>H</tt></td>
   <td><tt>all</tt></td>
   <td>The list of report types to mail.  The format and possible values are the same as for <a
   href="#output_format">output_format</a>, with the addition of <tt>log</tt>, which will cause the current log file to be sent.
   The default is for all files associated with the run to be mailed (so, this will include what you listed as your desired
   <tt>output_format</tt> plus <tt>log</tt> (the log file) and <tt>rsf</tt> (the rawfile).  You can cut your email down to
   the bare essentials with something like this:
<pre>   mailto=fast.guy@welovebenchmarks.org
   output_format=text,mail
   mail_reports=text
</pre>
   If none of the requested report types were generated, no mail will be sent.     <span class="new">Report mailing is a new
   feature of CPU2006.</span></td>
</tr>

<tr>
   <td id="make" > <tt>make</tt> </td>
   <td><tt>H,N</tt></td>
   <td><tt>specmake</tt></td>
   <td>Name of make executable.  Note that  the tools will enforce use of <tt>specmake</tt> for reportable results.  </td>
</tr>

<tr>
   <td id="makeflags" > <tt>makeflags</tt> </td>
   <td><tt>H,N</tt></td>
   <td><tt>''</tt></td>
   <td>Extra flags for make (such as <tt>-j</tt>).  Set this to <tt>-j <i>n</i></tt> where <i>n</i> is the number of
   concurrent processes to run during a build.  Omitting <i>n</i> or setting it to zero unlimits the number of jobs that will
   be run in parallel.  (Use of -j in conjunction with ONESTEP will still result in successful builds, but they will be
   necessarily serialized unless your compiler implements the parallelism itself.)  <b>Use with care!</b> Other flags should
   be used here only if you are familiar with GNU make.</td>
</tr>

<tr>
   <td id="mean_anyway" > <tt>mean_anyway</tt> </td>
   <td><tt>H</tt></td>
   <td><tt>0</tt></td>
   <td>Calculate mean even if invalid.  <span class="alarm">DANGER:</span> this will write a mean to all reports even if no
   valid mean can be computed (e.g. half the benchmarks failed).  A mean from an invalid run is not "reportable" (that is, it
   cannot be represented in public as the SPEC metric).</td>
</tr>

<tr>
   <td id="minimize_rundirs" > <tt>minimize_rundirs</tt> </td>
   <td><tt>H</tt></td>
   <td><tt>0</tt></td>
   <td>Try to keep working disk size down.  Cannot be used in a reportable run.</td>
</tr>
    
<tr>
   <td id="minimize_builddirs" > <tt>minimize_builddirs</tt> </td>
   <td><tt>H</tt></td>
   <td><tt>0</tt></td>
   <td>Try to keep working disk size down during builds.</td>
</tr>

<tr>
   <td id="no_monitor" > <tt>no_monitor</tt> </td>
   <td><tt>H,N</tt></td>
   <td><tt>''</tt></td>
   <td>Exclude the listed workloads from monitoring via the various <tt>monitor_*</tt> hooks.  <span class="new">The
   no_monitor feature is new with CPU2006.</span></td>
</tr>

<tr>
   <td id="no_input_handler" > <tt>no_input_handler</tt> </td>
   <td><tt>H,N</tt></td>
   <td><tt>close</tt></td>
   <td><p class="snugtop">Method to use to simulate an empty input.  Choices are:</p>
    <ul><li><tt>close</tt> - Just close stdin before executing the benchmark (this is the default). </li> 
        <li><tt>zero</tt>  - Create a zero-length file and attach it to stdin.</li>
        <li><tt>file</tt>  - Synonym for <tt>zero</tt>.</li>
        <li><tt>null</tt>  - Open the null device (<tt>/dev/null</tt> or <tt>NUL:</tt>) and attach it to stdin.</li>
    </ul>
    <p class="snugbot">Normally, this option should be left at the default; it was actually added to the tools for the
    benefit of a different SPEC suite that needed the feature.  If a reportable run for CPU2006 uses this feature, an
    explanation should be provided as to why it was used.  <span class="new">The no_input_handler feature is new in
    CPU2006.</span></p>
    </td>
</tr>

<tr>
   <td id="notes_wrap_indent" > <tt>notes_wrap_indent</tt> </td>
   <td><tt>H</tt></td>
   <td><tt>'    '</tt></td>
   <td>When line wrapping is enabled (see <a href="#notes_wrap_columns">notes_wrap_columns</a>), this is the string that will
   be prepended to newly created lines <b>after</b> the indentation from the original line is applied.  The default is four
   spaces, but it can be set to any arbitrary string.  <span class="new">Automatic wrapping is a new feature of
   CPU2006.</span></td>
</tr>

<tr>
   <td id="output_root" > <tt>output_root</tt> </td>
   <td><tt>H</tt></td>
   <td></td>
   <td><p class="snugtop">When set to a non-empty value, causes all files written (other than config files) to be rooted in
   the directory named by the value, instead of being rooted in <tt>$SPEC</tt>.  For example, setting <tt>output_root =
   /tmp/foo</tt> will cause results and logs to be deposited in <tt>/tmp/foo/result</tt>.  This also applies to benchmark
   binaries and run directories.</p>

   <p>This feature can be used to easily allow multiple people to access a single benchmark installation to which (with one
   exception) they do not need write access.  The exception is <tt>$SPEC/config</tt>.  Because the setting for the location
   comes from the config file, the config files still live under <tt>$SPEC</tt>.  On Unix systems, you might choose to set
   the permissions on the <tt>config</tt> subdirectory to 1777 (which is the same as <tt>/tmp</tt> on many systems).</p>
   
   <p class="snugbot">For an example of the use of <tt>output_root</tt>, see the section on it in <a
   href="runspec.html#output_root">runspec.html</a>.  <span class="new">The output_root feature is new in
   CPU2006.</span></p></td>
</tr>

<tr>
   <td id="plain_train" > <tt>plain_train</tt> </td>
   <td><tt>H,N</tt></td>
   <td><tt>1</tt></td>
   <td>When true (set to 1, 'yes', or 'true'), does not apply any submit commands to the feedback training run.  It also
   causes the monitor_* hooks to be ignored for the feedback training run.  <span class="new">The plain_train
   feature is new with CPU2006.</span></td>
</tr>

<tr>
   <td id="section_specifier_fatal" > <tt>section_specifier_fatal</tt> </td>
   <td><tt>H</tt></td>
   <td><tt>1</tt></td>

   <td>While parsing the config file, if a section specifier is found that refers to an unknown benchmark or benchset, an
   error is output and the run stops.  Set <tt>section_specifier_fatal=0</tt> in the header section of your config file to
   convert this error into a warning and allow the run to continue.  <span class="new">Prior to CPU2006, section specifier
   errors were always fatal.</span>
   </td>
</tr>

<tr>
   <td id="sendmail" > <tt>sendmail</tt> </td>
   <td><tt>H</tt></td>
   <td><tt>/usr/sbin/<br />sendmail</tt></td>
   <td>When using the <tt>mail</tt> output format, and when the mailmethod is <tt>sendmail</tt>, this specifies the location of the
   sendmail binary.  <span class="new">The ability to mail reports is new with CPU2006.</span></td>
</tr>

<tr>
   <td id="srcalt" > <tt>srcalt</tt> </td>
   <td><tt>N</tt></td>
   <td><tt>''</tt></td>

   <td>Name of subdirectory under <span class="ttnobr">&lt;benchmark&gt;/src/src.alt/</span> from which to draw approved
   source code modifications. This should be set only where required, on a per-benchmark basis.  Multiple src.alts may be
   specified; the names should be separated by commas.  If the specified alternate sources are not for the version of the
   suite in use, or if they are corrupt, the build will fail.  Any use of this feature is automatically noted in reports.
   <span class="new">Automatic reporting of src.alts is new with CPU2006.</span></td>

</tr>

<tr>
   <td id="strict_rundir_verify" > <tt>strict_rundir_verify</tt> </td>
   <td><tt>H</tt></td>
   <td><tt>1</tt></td>
   <td>When set, run directory setup will verify that the file contents in existing run directories match both the cached MD5
   (from the MANIFEST or one of the SUMS files) as well as the MD5 of the source file in the benchmark data directory.
   Normally, this should always be on, and reportable runs will force it to be on.  A benchmark developer could turn it off,
   for example, while developing change proposals for the benchmarks or workloads.  But in that case, a different,
   unmodified, copy of the installation tree should be used for any reportable runs.  <span class="new">CPU2000 provided fewer
   controls over the degree of verification.</span></td>
</tr>

<tr>
   <td id="sysinfo_program" > <tt>sysinfo_program</tt> </td>
   <td><tt>H</tt></td>
   <td><tt>''</tt></td>

   <td>Specifies the name of an executable program or script that delivers system configuration information about the system
   under test for use in the reports.  Please see the comments in <a
   href="sample-sysinfo-program.pl">sample-sysinfo-program.pl</a> for complete details.  (Note: some combinations of
   servers/browsers will refuse to open files of type <tt>.pl</tt>; if the link does not work for you, try looking on your
   SPEC distribution media, or you might be able to right-click and save the copy posted at <a
   href="http://www.spec.org/cpu2006/Docs/">www.spec.org/cpu2006/Docs</a>.) <span class="new">The sysinfo_program
   feature is new with CPU2006.</span></td>

</tr>

<tr>
   <td id="teeout" > <tt>teeout</tt> </td>
   <td><tt>H</tt></td>
   <td><tt>0</tt></td>
   <td>Run output through tee so you can see it on the screen.  Primarily affects builds, but also provides some
   information about progress of runtime, by showing you the <tt>specinvoke</tt> commands.</td>
</tr>
    
<tr>
   <td id="use_submit_for_speed" > <tt>use_submit_for_speed</tt> </td>
   <td><tt>H,N</tt></td>
   <td><tt>0</tt></td>
   <td>If set, use submit commands for speed runs as well as rate runs. </td> 
</tr>

<tr>
   <td id="version_url" > <tt>use_version_url</tt> </td>
   <td><tt>H</tt></td>
   <td><tt>http://<br />www.<br />spec.org/<br />cpu2006/<br />current_<br />version</tt></td>
   <td>If <a href="#check_version">version checking</a> is enabled, this specifies the location from which the version
   information should be fetched.</td>
</tr>

</table>


<h2 id="sectionIII">III. Config file options for specmake</h2>

<p>For a complete list of options that are used by <tt>specmake</tt>, please see <a href="makevars.html">makevars.html</a>
and notice which variables are documented as OK to mention in a config file.</p>

<p>Here are the commonly used variables:</p>


<table> 

<tr>
   <td id="compiler" > <tt>CC</tt> </td>
   <td>How to invoke your C compiler.</td>
</tr>
<tr>
   <td><tt>CXX</tt></td>
   <td>How to invoke your C++ compiler.</td>
</tr>
<tr>
   <td><tt>FC</tt></td>
   <td>How to invoke your Fortran compiler. <br /> <span class="new">Note that for CPU2006, there are no longer separate
   options for Fortran 77.  If you wish to use a Fortran 77 compiler for a benchmark in peak, set FC for that benchmark, not
   F77.</span></td>
</tr>

<tr>
   <td>&nbsp;</td>
   <td>&nbsp;</td>
</tr>

<tr>
   <td id="ld" > <tt>CLD</tt> </td>
   <td>How to invoke the linker when compiling C programs.</td>
</tr>
<tr>
   <td><tt>CXXLD</tt></td>
   <td>How to invoke the linker when compiling C++ programs.</td>
</tr>
<tr>
   <td><tt>FLD</tt></td>
   <td>How to invoke the linker when compiling Fortran programs.</td>
</tr>

<tr>
   <td>&nbsp;</td>
   <td>&nbsp;</td>
</tr>

<tr>
   <td id="onestep" > <tt>ONESTEP</tt> </td>
   <td>If set, build from sources directly to final binary.  See the discussion in rule 2.2.10 of <a
   href="runrules.html#rule_2.2.10">runrules.html</a>. </td>
</tr>

<tr>
   <td>&nbsp;</td>
   <td>&nbsp;</td>
</tr>

<tr>
   <td id="optimize" > <tt>OPTIMIZE</tt> </td>
   <td>Optimization flags to be applied for all compilers.</td>
</tr>
<tr>
<td><tt>COPTIMIZE</tt></td>
<td>Optimization flags to be applied when using your C compiler.</td>
</tr>

<tr>
<td><tt>CXXOPTIMIZE</tt></td>
<td>Optimization flags to be applied when using your C++ compiler.</td>
</tr>

<tr>
<td><tt>FOPTIMIZE</tt></td>
<td>Optimization flags to be applied when using your Fortran compiler.</td>
</tr>

<tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
</tr>

<tr>
   <td id="portability" > <tt>PORTABILITY</tt> </td>
   <td>Portability flags to be applied no matter what the compiler.</td>
</tr>
<tr>
   <td><tt>CPORTABILITY</tt></td>
   <td>Portability flags to be applied when using your C compiler.</td>
</tr>
<tr>
   <td><tt>CXXPORTABILITY</tt></td>
   <td>Portability flags to be applied when using your C++ compiler.</td>
</tr>
<tr>
   <td><tt>FPORTABILITY</tt></td>
   <td>Portability flags to be applied when using your Fortran compiler.</td>
</tr>
<tr>
   <td><tt>FPPPORTABILITY</tt></td>
   <td>Portability flags to be applied when pre-processing Fortran sources.  Note that since preprocessing is not a part of
   standard Fortran, SPEC supplies a copy of the freely available <tt>filepp</tt>, with minor modifications, as
   <tt>specpp</tt>.  Using <tt>specpp</tt> ensures that the preprocessing is done consistently across platforms.  If you need
   to define Fortran preprocessor variables, do not put them in <tt>FPORTABILITY</tt>. Instead, put them in
   <tt>FPPPORTABILITY</tt> or <tt>PORTABILITY</tt>.</td>
</tr>

<tr>
   <td>&nbsp;</td>
   <td>&nbsp;</td>
</tr>

<tr>
   <td id="rm_sources" > <tt>RM_SOURCES</tt> </td>
   <td>Remove a source file.  Should only be used for library substitutions that comply with <a
   href="runrules.html#rule_2.1.2">run rule 2.1.2</a>.</td>
</tr>

<tr>
   <td>&nbsp;</td>
   <td>&nbsp;</td>
</tr>

<tr>
   <td id="pass" > <tt>PASSn_CFLAGS</tt> </td>
   <td>Flags for pass "n" C compilation when using feedback-directed optimization (FDO).  Typically n is either 1 or 2, for
   the compile done before the training run and the compile done after the training run.  See the chapter on <a
   href="#sectionVI">Using Feedback Directed Optimization</a> for more information.</td>
</tr>
<tr>
   <td><tt>PASSn_CXXFLAGS</tt></td>
   <td>Flags for pass "n" C++ compilation when using FDO.</td>
</tr>
<tr>
   <td><tt>PASSn_FFLAGS</tt></td>
   <td>Flags for pass "n" Fortran compilation when using FDO.</td>
</tr>
<tr>
   <td><tt>PASSn_LDFLAGS</tt></td>
   <td>Flags to use with the linker in pass "n" when using FDO.</td>
</tr>
</table>

<p>Note that you can also make up your own variable names, which <tt>specmake</tt> will use (and perform substitution on).
For an example of this feature, see the SPEC CPU2000 example at <a
href="http://www.spec.org/cpu2000/docs/example-advanced.cfg">www.spec.org/cpu2000/docs/example-advanced.cfg</a>.  Search that
file for LIBS, and note the long comment which provides a walk-through of a complex substitution handled by
<tt>specmake</tt>.  <b>Note:</b> a CPU2006 version of that example will be provided at a later date; but the concepts, from
the CPU2000 example, are expected to work in a similar fashion for CPU2006.</p>
   

<h2 id="sectionIV">IV. Config file options for the shell</h2>

<p>Some options in your config file cause commands to be executed by your shell (<tt>/bin/sh</tt>) or by the Windows command
interpreter (<tt>cmd.exe</tt>).</p>

<p class="l2"><span style="background:#fff28a; font-size:115%"> Because <tt>runspec</tt> can cause arbitrary commands to be executed,
<span class="alarm"> it is therefore important to read a config file you are given before using it.</span></span></p>

<p>These are the options that cause commands to be executed:</p>

<table> 
<tr>
   <td id="fdo_pre0" > <tt>fdo_pre0</tt> </td>
   <td>Commands to be executed before starting a feedback directed compilation series. </td>
</tr>

<tr>
   <td id="fdo_preN" > <tt>fdo_preN</tt> </td>
   <td>Commands to be executed before pass N.</td>
</tr>

<tr>
   <td id="fdo_make_cleanN" > <tt>fdo_make_cleanN</tt> </td>
   <td>Commands to be executed for cleanup at pass N.</td>
</tr>

<tr>
   <td id="fdo_pre_makeN" > <tt>fdo_pre_makeN</tt> </td>
   <td>Commands to be done prior to Nth compile.</td>
</tr>

<tr>
   <td id="fdo_make_passN" > <tt>fdo_make_passN</tt> </td>
   <td>Commands to actually do the Nth compile.</td>
</tr>

<tr>
   <td id="fdo_post_makeN" > <tt>fdo_post_makeN</tt> </td>
   <td>Commands to be done after the Nth compile.</td>
</tr>

<tr>
   <td id="fdo_runN" > <tt>fdo_runN</tt> </td>
   <td>Commands to be used for Nth training run.</td>
</tr>

<tr>
   <td id="fdo_postN" > <tt>fdo_postN</tt> </td>
   <td>Commands to be done at the end of pass N.</td>
</tr>

<tr>
   <td id="submit" > <tt>submit</tt> </td>
   <td>Commands to be used for distributing jobs across a multiprocessor system.  See the <a
   href="#sectionI.D.1.d">several</a> &nbsp; <a href="#sectionI.D.1.e">detailed</a> &nbsp; <a
   href="#sectionI.D.2.b">examples</a> in the section on <a href="#sectionI.D" >Variable Substitution</a>, above.</td>
</tr>
</table>

<p>For examples of the <tt>fdo_</tt> options, see the chapter on <a href="#sectionVI">Using Feedback Directed
Optimization</a>.</p>

<h2 id="sectionV">V. Config file options for readers</h2>

<p>Whether or not you submit your result to SPEC, you should fully disclose how you achieved the result.  If it requires the
installation of the GoFastLinker, you should say so.  By setting the appropriate fields in the config file, you can cause
information about the GoFastLinker to appear in the reports that are intended for humans.</p>

<h3 id="sectionV.A">V.A. Descriptive fields</h3>

<p>Here are the fields that you can set to describe your testbed to readers:</p>

<table> 

<tr>
   <th id="company_name">company_name</th>
   <td><span class="alarm">Do not use.  This field is obsolete</span>.  You are probably looking for <a
   href="#hw_vendor">hw_vendor</a>, <a href="#tester">tester</a>, or <a href="#test_sponsor">test_sponsor</a>.  See the
   example under <a href="#test_sponsor">test_sponsor</a>.  If you do use <tt>company_name</tt>, the effect will be mostly
   harmless, except when it surprises you or your users by causing <a href="#unexpected_rebuilds">unexpected
   rebuilds</a>.</td>
</tr>

<tr>
   <td id="hw_avail" > <tt>hw_avail</tt> </td>
   <td>Date hardware first shipped.  If more than one date applies, use the LATEST one.</td>
</tr>

<tr>
   <td id="hw_cpu_name" > <tt>hw_cpu_name</tt> </td>
   <td>Manufacturer-determined formal processor name.</td>
</tr>

<tr>
   <td id="hw_cpu_char" > <tt>hw_cpu_char</tt> </td>
   <td>Technical characteristics to help identify the processor.  (You'll find more information about the intended use of
   <tt>hw_cpu_name</tt> vs. <tt>hw_cpu_char</tt> in the <a href="runrules.html#rule_4.2.2">run rules</a>.)</td>
</tr>

<tr>
   <td id="hw_cpu_mhz" > <tt>hw_cpu_mhz</tt> </td>
   <td>Speed of the CPUs, in MHz.</td>
</tr>

<tr>
   <td id="hw_disk" > <tt>hw_disk</tt> </td>
   <td><p class="snug">Disk subsystem for the SPEC run directories.  Three important <b>Notes</b>:</p>
   <ol class="snugbot">
   <li>Only a single file system may be used for the run directories, as described in the run rules at 
       <a href="runrules.html#rule3.1.1">Rule 3.1.1</a>.</li>
   <li>If the <a href="#output_root">output_root</a> feature is used, its disk subsystem should be the one described
   here.</li>
   <li>Disks used for other purposes - such as the system disk - are usually not a performance-relevant variable, so need not
   be described.  But if you wish to do so, you can extend this field using the same <a href="#sectionV.B">continuation
   rules</a> as other fields (so, you could use <tt>hw_disk01</tt>, <tt>hw_disk02</tt>, etc).</li>
   </ol>
   </td>
</tr>

<tr>
   <td id="hw_fpu" > <tt>hw_fpu</tt> </td>
   <td>Floating point unit.</td>
</tr>

<tr>
   <td id="hw_memory" > <tt>hw_memory</tt> </td>
   <td>Size of main memory (and other performance-relevant information about memory, as discussed 
   in the <a href="runrules.html#memoryconfig">run rules</a>.)</td>
</tr>

<tr>
   <td id="hw_model" > <tt>hw_model</tt> </td>
   <td>Model name.</td>
</tr>

<tr>
   <td id="hw_nchips" > <tt>hw_nchips</tt> </td>
   <td>Number of CPU chips configured.  See the discussion of CPU counting in the <a href="runrules.html#cpucount">run
   rules</a>.</td>
</tr>

<tr>
   <td id="hw_ncores" > <tt>hw_ncores</tt> </td>
   <td>Number of CPU cores configured.  See the discussion of CPU counting in the <a href="runrules.html#cpucount">run
   rules</a>.</td>
</tr>

<tr>
   <td id="hw_ncoresperchip" > <tt>hw_ncoresperchip</tt> </td>
   <td>Number of CPU cores per chip.  See the discussion of CPU counting in the <a href="runrules.html#cpucount">run
   rules</a>.</td>
</tr>

<tr>
   <td id="hw_ncpuorder" > <tt>hw_ncpuorder</tt> </td>
   <td>Valid number of processors orderable for this model, including a unit.  For example, "2, 4, 6, or 8 chips".</td>
</tr>

<tr>
   <td id="hw_nthreadspercore" > <tt>hw_nthreadspercore</tt> </td>
   <td>Number of hardware threads per core.  See the discussion of CPU counting in the <a href="runrules.html#cpucount">run
   rules</a>.</td>
</tr>

<tr>
   <td id="hw_other" > <tt>hw_other</tt> </td>
   <td>Any other performance-relevant hardware.</td>
</tr>

<tr>
   <td id="hw_pcache" > <tt>hw_pcache</tt> </td>
   <td>1st level (primary) cache.</td>
</tr>

<tr>
   <td id="hw_scache" > <tt>hw_scache</tt> </td>
   <td>2nd level cache.</td>
</tr>

<tr>
   <td id="hw_tcache" > <tt>hw_tcache</tt> </td>
   <td>3rd level cache.</td>
</tr>

<tr>
   <td id="hw_ocache" > <tt>hw_ocache</tt> </td>
   <td>4th level or other form of cache.</td>
</tr>

<tr>
   <td id="hw_vendor" > <tt>hw_vendor</tt> </td>
   <td>The hardware vendor.  An example of usage of this and related fields is given in the <a
   href="#test_sponsor">test_sponsor</a> section.  </td>
</tr>

<tr>
   <td id="license_num" > <tt>license_num</tt> </td>
   <td>The SPEC license number for either the <a href="#tester">tester</a> or the <a
   href="#test_sponsor">test_sponsor</a>.</td>
</tr>

<tr>
   <th id="machine_name">machine_name</th>
   <td><span class="alarm">Do not use.  This field is obsolete</span> (and has been since SPEC CPU95 was retired).  If you do
   use it, the effect will be mostly harmless, except when it surprises you or your users by causing <a
   href="#unexpected_rebuilds">unexpected rebuilds</a>.</td>
</tr>

<tr>
   <td id="prepared_by" > <tt>prepared_by</tt> </td>
   <td>Is never output.  If you wish, you could set this to your own name, so that the rawfile will be tagged with your name
   but not the formal reports. </td>
</tr>

<tr>
   <td id="sw_auto_parallel" > <tt>sw_auto_parallel</tt> </td>
   <td>Were multiple cores employed by a parallelizing compiler?  Note that a speed run that uses a parallelizing compiler
   causes a single instance of a benchmark to run using multiple CPUs; this is different from a rate run, which typically
   distributes N instances over N CPUs.</td>
</tr>

<tr>
   <td id="sw_avail" > <tt>sw_avail</tt> </td>
   <td>Availability date for the software used.  If more than one date, use the LATEST one.</td>
</tr>

<tr>
   <td id="sw_base_ptrsize" > <tt>sw_base_ptrsize</tt> </td>
   <td>
   Size of pointers in base.  Report:
       <ul class="snug">
       <li>"<tt>32-bit</tt>" if all benchmarks in base are compiled with switches that request only 32-bit pointers.</li>
       <li>"<tt>64-bit</tt>" if all benchmarks in base are compiled with switches that request only 64-bit pointers.</li>
       <li>"<tt>32/64-bit</tt>" if there is a mix of 32-bit and 64-bit.  For example, if the C++ benchmarks use 32-bit
       pointers, while the Fortran and C benchmarks use 64-bit, then you would report "32/64-bit" here.</li>
       </ul></td>
</tr>


<tr>
   <td id="sw_compiler" > <tt>sw_compiler</tt> </td>
   <td>Name and version of compiler.  Note that if more than one compiler is used, you can employ <a
   href="#sectionV.B">continuation lines</a>.  (This applies to most of the fields discussed here, but is emphasized for
   <tt>sw_compiler</tt> because it is common that testers first find themselves wanting to use continuation lines when
   documenting their compiler set.)  </td>
</tr>

<tr>
   <td id="sw_file" > <tt>sw_file</tt> </td>
   <td><p class="snugtop">File system (ntfs, ufs, nfs, etc) for the SPEC run directories.  Three important <b>Notes</b>:</p>
   <ol class="snugbot">
   <li>Only a single file system may be used for the run directories, as described in the run rules at 
       <a href="runrules.html#rule3.1.1">Rule 3.1.1</a>.</li>
   <li>If the <a href="#output_root">output_root</a> feature is used, its file system should be the one described
   here.</li>
   <li>File systems used for other purposes - such as for the operating system - are usually not a performance-relevant
   variable, so need not be described.  But if you wish to do so, you can extend this field using the same <a
   href="#sectionV.B">continuation rules</a> as other fields (so, you could use <tt>sw_file01</tt>, <tt>sw_file02</tt>,
   etc).</li>
   </ol>
   </td>
</tr>
   

<tr>
   <td id="sw_os" > <tt>sw_os</tt> </td>
   <td>Operating system name and version.</td>
</tr>

<tr>
   <td id="sw_state" > <tt>sw_state</tt> </td>
   <td>Multi-user, single-user, default, etc.</td>
</tr>

<tr>
   <td id="sw_other" > <tt>sw_other</tt> </td>
   <td>Any other performance-relevant non-compiler software used, including third-party libraries, accelerators, etc.</td>
</tr>

<tr>
   <td id="sw_peak_ptrsize" > <tt>sw_peak_ptrsize</tt> </td>
   <td> Size of pointers in peak.  Report:
       <ul class="snug">
       <li>"<tt>32-bit</tt>" if all benchmarks in peak are compiled with switches that request only 32-bit pointers.</li>
       <li>"<tt>64-bit</tt>" if all benchmarks in peak are compiled with switches that request only 64-bit pointers.</li>
       <li>"<tt>32/64-bit</tt>" if there is a mix of 32-bit and 64-bit.  </li>
       </ul></td>
</tr>

<tr>
   <td id="tester" > <tt>tester</tt> </td>
   <td>The entity actually carrying out the tests.  An optional field; if not specified, defaults to <tt>test_sponsor</tt>.
   An example is given in the <a href="#test_sponsor">test_sponsor</a> section.  </td>
</tr>

<tr>
   <th id="tester_name">tester_name</th>
   <td><span class="alarm">Do not use.  This field is obsolete</span>.  You are probably looking for <a
   href="#hw_vendor">hw_vendor</a>, <a href="#tester">tester</a>, or <a href="#test_sponsor">test_sponsor</a>.  See the
   example under <a href="#test_sponsor">test_sponsor</a>.  If you do use <tt>tester_name</tt>, the effect will be mostly
   harmless, except when it surprises you or your users by causing <a href="#unexpected_rebuilds">unexpected
   rebuilds</a>.</td>
</tr>

<tr>
   <td id="test_date" > <tt>test_date</tt> </td>
   <td>When the tests were run.</td>
</tr>

<tr>
   <td id="test_sponsor" > <tt>test_sponsor</tt> </td>
   <td><p class="snugtop">The entity sponsoring this test.  An optional field; if not specified, defaults to
   <a href="#hw_vendor">hw_vendor</a>.</p>
   <p style="margin:0em 4em; text-align:justify;">For example, suppose that the Genius Compiler Company wants to show off
   their new compiler on the TurboBlaster 9000 computer, but does not happen to own a maxed-out system with eight thousand
   processors.  Meanwhile, the Pawtuckaway State College Engineering department has just taken delivery of such a system.  In
   this case, the compiler company could contract with the college to test their compiler on the big machine.  The fields
   could be set as:</p>
<pre>
      test_sponsor = Genius Compilers
      tester       = Pawtuckaway State College
      hw_vendor    = TurboBlaster
</pre>

   </td>
</tr>

<tr>
   <th id="VENDOR">VENDOR</th>
   <td><span class="alarm">Do not use.  This field is obsolete</span>, and has been since SPEC CPU92 was retired.  It
   is ancient, useless, vestigial, degenerate, deprecated, and leftover.  Repetition is a form of emphasis.  If you do use
   it, the effect will be mostly harmless, except when it surprises you or your users by causing <a
   href="#unexpected_rebuilds">unexpected rebuilds</a>.</td>
</tr>

</table>


<h3 id="sectionV.B">V.B. Field scoping and continuation
</h3>
   <p id="continue"> Note that these fields are scoped by section markers - that is, you can vary them according to the type
   of run that you are doing.  You can also continue most <a href="#nocontinue">(*)</a> of the above fields to another line
   by appending a numeral to it.  Here is an example of both these features:</p>

<pre>   default=default=default=default:
   sw_compiler  = Compaq C X6.2-259-449AT 
   CC           = cc -v      

   int=default=default=default:  
   sw_compiler2 = DIGITAL C++ V6.1-029-408B6
   CXX          = cxx -v

   fp=default=default=default:
   sw_compiler2 = Compaq Fortran V5.3
   sw_compiler3 = KAP Fortran V4.2
   FC           = kf90 -v
</pre>

<p>In the above example, the information about the C compiler will be printed for both integer and floating point
runs.  The information about the C++ compiler will be printed only for integer runs; the information about Fortran compilers
will be printed only for floating point runs.</p>

<p>Note that the numerals above will be converted to a more formal style of three-digit numbers with leading zeros in the raw
file; as discussed in <a href="utility.html#cont">utility.html</a>, if you edit a rawfile you must use the more formal style
of <tt>000</tt>, <tt>001</tt>, etc.</p>

   <p id="nocontinue" style="margin-left:3.5em; text-indent:-1.5em">(*) The fields which cannot be continued are the ones
   that are expecting a simple integer: <span class="ttnobr">hw_nchip</span>, <span class="ttnobr">hw_ncores</span>, <span
   class="ttnobr">hw_ncoresperchip</span>, <span class="ttnobr">hw_nthreadspercore</span>, <span
   class="ttnobr">license_num</span>; and the ones that are expecting a date: <span class="ttnobr">hw_avail</span>, <span
   class="ttnobr">sw_avail</span>, and <span class="ttnobr">test_date</span>.</p>

<h3 id="sectionV.C">V.C. Additional notes for the reader</h3>

<p>In addition to the pre-defined fields, you can write as many notes as you wish.  These notes are printed in the report,
using a fixed-width font.</p>

<p><span class="new">New with CPU2006</span>, there are 8 different notes sections.  If there are no notes in a particular
section, it is not output, so you don't need to worry about making sure you have something in each section.</p>

   <p>The sections, in order of appearance, are as follows:</p>
   <ol>
     <li id="notes_comp"><span class="ttnobr">notes_comp_NNN</span> -- Notes about compiler invocation.</li>
     <li id="notes_port"><span class="ttnobr">notes_port_NNN</span> -- Notes about portability options.</li>
     <li id="notes_base"><span class="ttnobr">notes_base_NNN</span> -- Notes about base optimization options.</li>
     <li id="notes_peak"><span class="ttnobr">notes_peak_NNN</span> -- Notes about peak optimziation options.</li>
     <li id="notes_os"  ><span class="ttnobr">notes_os_NNN</span>   -- Notes about operating system tuning and changes.</li>
     <li id="notes_plat"><span class="ttnobr">notes_plat_NNN</span> -- Notes about platform tuning and changes.</li>
     <li id="notes_part"><span class="ttnobr">notes_part_NNN</span> -- Notes about component parts (for kit-built systems).</li>
     <li id="notes"     ><span class="ttnobr">notes_NNN</span> -- General notes.</li>
   </ol>

<p>Start your notes with the name of the notes section where you want the note to appear, and then add numbers to define the
order of the lines.  Within a section, notes are sorted by line number.  The <tt>NNN</tt> above is not intended to indicate
that you are restricted to 3 digits; you can use a smaller or larger number of digits as you wish, and you can skip around as
you like: for example, ex-BASIC programmers might naturally use line numbers 100, 110, 120...  But note that if you say <span
class="ttnobr">notes_plat782348320742972403</span> you just might encounter the dreaded (and highly unusual) "out of memory"
error, so don't do that. </p>

<p>You can optionally include an underscore just before the number, but beware: if you say both <span
class="ttnobr">notes_plat_105</span> and <span class="ttnobr">notes_plat105</span>, both are considered to be the same line.
The last one mentioned will replace the first, and it will be the only one output. </p>

<p>For all sections EXCEPT the general notes, you can add an optional additional tag of your choosing before the numbers.
For example:</p>

<pre>   $ <b>cat tmp.cfg</b>
   size                 = test
   iterations           = 1
   output_format        = text
   teeout               = 1
   runlist              = sjeng
   tune                 = base

   notes_part_greeting_011  = ++ how
   notes_part_greeting_20   = ++ you?
   notes_part_greeting_012  = ++ are
   notes_part_aname_1       = ++ Alex,
   notes_part080            = ++ hi

   $ <b>runspec --config tmp > /nev/dull</b>
   $ <b>cd ../result</b>
   $ <b>ls -t *test.txt | head -1</b>
   CINT2006.101.test.txt
   $ <b>grep ++ *101*txt</b>
        ++ hi
        ++ Alex,
        ++ how
        ++ are
        ++ you?
   $ 
</pre>

<p>You can also use notes to describe software or hardware information with more detail beyond the predefined fields.  For an
example of where this might be useful, see <a href="../config/example-medium.cfg">example-medium.cfg</a> and search for
"patch".  Note: some combinations of servers/browsers will refuse to open files of type <tt>.cfg</tt>; if the link does not
work for you, you might be able to right-click and save the file.  If the file is not found, you might try using a terminal
window (aka command window, terminal emulator) to look in your installed SPEC tree, or on your SPEC distribution media in the
config directory.</p>



<h2 id="sectionVI">VI. Using Feedback Directed Optimization (FDO)</h2>

<p>Feedback Directed Optimization (FDO) is an application build method that involves:</p>
<ul>
<li>Building the program,</li>
<li>Running a sample "training" workload,</li>
<li>Collecting a profile during the training run, and</li>
<li>Applying the profile to produce a modified program.</li>
</ul>
<p> The modified program is expected to run faster than if FDO had not been used.  FDO is also sometimes
known as PBO, for Profile-Based Optimization.</p>

<p>This section explains how various controls interact when using feedback.  Those controls are:</p>

<ol>
<li>The <a href="#sectionIII">specmake</a> options <b>PASS*n</b>.</li>
<li>The <a href="#sectionIV">shell</a> options <b>fdo*n</b>.</li>
<li>The config file <a href="#feedback">feedback</a> option.</li>
<li>The runspec switch <a href="runspec.html#feedback">--feedback</a>.</li>
</ol>

<h3 id="sectionVI.A">VI.A. The minimum requirement: <tt>PASSn*</tt> or <tt>fdo*n</tt></h3>

<p>The default is to build without feedback.  To use FDO, you must add either the <tt>PASSn*</tt> or <tt>fdo*n</tt> options.
The <tt>PASSn</tt> options let you specify additional flags for the pre-defined sequence of steps within each build
pass, where "<tt>n</tt>" indicates the build pass number.  The <tt>fdo*n</tt> options let you add entire commands to build
passes, including setup and cleanup commands.</p>

<ul>

    <li><p><b>PASSn*:</b> The most common way of using FDO is to add <span
    class="ttnobr">PASS1_&lt;<i>language</i>&gt;FLAGS</span> and <span
    class="ttnobr">PASS2_&lt;<i>language</i>&gt;FLAGS</span> options, which specify flags to be added to each of multiple
    compiler and/or link steps.  These options, which are summarized in the section on <a href="#sectionIII">specmake</a>,
    cause multiple compiles.  The first compile creates an executable image with instrumentation.  That image is run with the
    SPEC-provided training workload, and the instrumentation collects data about the run (a profile).  Finally, the program
    is recompiled, and the compiler uses the profile to improve its optimizations.</p>

    <p>Use this method if your desired build sequence is <span style="white-space:nowrap"><i>compile - train -
    recompile</i></span>.  </p>

    <p class="snugbot">For example, if you set </p>
    <pre>    FC           = tbf90
    OPTIMIZE     = --fast
    PASS1_FFLAGS = --CollectFeedback 
    PASS2_FFLAGS = --ApplyFeedback</pre> 
    <p class="snugtop">then the tools will use <span class="ttnobr">tb90 --fast --CollectFeedback</span> to create an
    instrumented binary; will run it with the SPEC-provided training workload; and then will recompile with <span
    class="ttnobr">tbf90 --fast --ApplyFeedback </span> to create a new binary.</p></li>

    <li><p><b>fdo*n:</b> Although the <span style="white-space:nowrap"><i>compile - train - recompile</i></span> method is
    common, many other FDO models are also possible, such as <span style="white-space:nowrap"><i>compile - train -
    othertool</i></span>, where <i>othertool</i> uses the profile to improve the executable image without requiring a
    recompile.  The <a href="#sectionIV">shell options <tt>fdo*n</tt></a> can be used to construct more flexible FDO methods.
    Unlike <tt>PASSn*</tt>, which is limited to just adding flags to the commands issued by <tt>specmake</tt>, the
    <tt>fdo*n</tt> options let you add entirely different commands.  </p>
    
    <p class="snugbot">For example, if you set </p>
    <pre>    FC        = tbf90
    OPTIMIZE  = -fast -profile:fbdir
    fdo_post1 = /usr/bin/postoptimizer --profile:fbdir</pre>
    <p class="snugtop">then the SPEC tools will use <span class="ttnobr">tbf90 -fast -profile:fbdir</span> to create a
    binary; will run the binary with the SPEC-provided training workload; and then will run the <tt>postoptimizer</tt>.  The
    compiler is not re-run after the training run.  Instead, the <tt>postoptimizer</tt> consumes a profile from the
    feedback directory <tt>fbdir</tt>, and uses this profile to modify the binary.</p></li>
</ul>

<h3 id="sectionVI.B">VI.B. Combining <tt>PASS*n</tt> and <tt>fdo*n</tt>; fake is your friend</h3>

<p>The <tt>PASSn*</tt> and <tt>fdo*n</tt> options can be freely used together.  For example, here's a config file that
builds 459.GemsFDTD peak (as specified on the first three lines), with both <tt>PASSn</tt> and <tt>fdo</tt> options:</p>

<pre>
$ <b>cat tmp.cfg</b>
action       = build
runlist      = GemsFDTD
tune         = peak

PASS1_FFLAGS = --CollectFeedback
PASS2_FFLAGS = --ApplyFeedback
fdo_run2     = $command
fdo_post2    = /usr/bin/postoptimizer

$ <b>runspec --config tmp --fake | \
   grep -e excite.f90 -e train.err -e postopt | grep -v %%</b>
f90 -c -o excite.o    --CollectFeedback                     excite.f90
../build_peak_none.0000/GemsFDTD &gt; train.log 2&gt;&gt; train.err
f90 -c -o excite.o    --ApplyFeedback                     excite.f90
../build_peak_none.0000/GemsFDTD &gt; train.log 2&gt;&gt; train.err
/usr/bin/postoptimizer
$ 
</pre>

<p class="snugtop">In the <tt>runspec</tt> command, we use the <a href="runspec.html#fake">--fake</a> option to quickly
examine how the build will work.  Using <span class="ttnobr">--fake</span> is highly recommended when you are trying
to debug your feedback commands, because it is much quicker than actually doing the builds.  The fake output is searched
with the Unix <tt>grep</tt> command; on Windows you would construct a <tt>findstr</tt> command.  The example picks out lines
of interest: </p>
<ul style="list-style-type:none">
  <li>"<tt>-e excite.f90</tt>" matches a sample line from the compile commands, </li>
  <li>"<tt>-e train.err</tt>" matches the line that runs the benchmark with the training workload, </li>
  <li>"<tt>-e postopt</tt>" matches the postoptimizer line, and  </li>
  <li>"<tt>-v %%</tt>" excludes some commentary lines that aren't needed for this example.</li>
</ul>

<p>Having done all this, we can confirm that the above config file causes the build sequence to be
<span style="white-space:nowrap"><i>compile - train - compile - train - othertool</i></span>.</p>
  
<p>The sharp-eyed reader may wonder "What is this '<span class="ttnobr">fdo_run2 = $command</span>' line in the config file?"
In the second pass, actually running the benchmark is optional, because it is possible that your pass 2 tools might not need
another run of the benchmark.  One could imagine a build system that notices everything interesting during the pass 1 run,
and which causes that interesting information to be carried around by the binary itself, so that it never needs to be
regenerated.  To say "Yes, please do run it again", you add the above <tt>fdo_run2</tt> line.</p>

<p>More complex examples can be constructed.  If you mention <tt>PASS1</tt>, <tt>fdo_pre2</tt>, <tt>fdo_post2</tt>,
<tt>PASS3</tt>, and <tt>fdo_post4</tt>, then you will end up with four passes.  The numbers serve to order the passes, but if
you skip numbers then the tools will not attempt to invent things to do in the "missing" passes. </p> 


<h3 id="sectionVI.C">VI.C. Interaction with the config file <tt>feedback</tt> option</h3>

<p>If you use either <tt>PASSn*</tt> or <tt>fdo*n</tt> (or both), then, by default, feedback will happen.  The config file
option <a href="#feedback">feedback</a> provides an additional control, an "on/off" switch which allows, or disallows, the
options selected with <tt>PASSn*</tt> and <tt>fdo*n</tt>.</p>  

<p>A common usage model is to use <tt>PASSn*</tt> or <tt>fdo*n</tt> to turn on feedback for a whole set of benchmarks, and
then use the option <tt>feedback=0</tt> to turn it off for individual benchmarks.  For example:</p>

<pre>
$ <b>cat miriam1.cfg</b>
action    = build
tune      = peak
runlist   = bzip2,mcf,libquantum

fdo_post1 = /usr/bin/merge_feedback fbdir

401.bzip2:
feedback=0

462.libquantum:
feedback=1

$ <b>runspec --fake --config miriam1 | grep -e Building -e merge_feedback \
  | grep -v %%</b>
  Building 401.bzip2 ref peak none default: (build_peak_none.0003)
  Building 429.mcf ref peak none default: (build_peak_none.0001)
/usr/bin/merge_feedback fbdir
  Building 462.libquantum ref peak none default: (build_peak_none.0000)
/usr/bin/merge_feedback fbdir
$ 
</pre>

<p class="snugtop">In this example, we build peak bzip2, mcf, and libquantum (notice the first three lines of the config
file) and once again use <a class="nobr" href="runspec.html#fake">--fake</a> and <tt>grep</tt> in a fashion similar to the
previous example.  In this case, we can see that the <tt>fdo_post1</tt> command was used for two of the three benchmarks from
the runlist, since  by default <tt>feedback=1</tt>.</p>


<h3 id="sectionVI.D">VI.D. If the config file <tt>feedback</tt> option is used at multiple levels</h3>

<p>If the <tt>feedback</tt> option is used at more than one level within a config file, the usual <a
href="#sectionI.C.3.a">precedence rules</a> apply.  For example, the next config file specifies the <tt>feedback</tt> option
both for a set of benchmarks and for some individual benchmarks:</p>

<pre>
$ <b>cat miriam2.cfg</b>
action    = build
tune      = peak
runlist   = bzip2,mcf,libquantum

fdo_post1 = /usr/bin/merge_feedback fbdir

default=peak:
feedback=0

401.bzip2:
feedback=0

462.libquantum:
feedback=1

$ <b>runspec --fake --config miriam2 | grep -e Building -e merge_feedback \
   | grep -v %%</b>
  Building 401.bzip2 ref peak none default: (build_peak_none.0003)
  Building 429.mcf ref peak none default: (build_peak_none.0001)
  Building 462.libquantum ref peak none default: (build_peak_none.0000)
/usr/bin/merge_feedback fbdir
$ 
</pre>

<p class="snugtop">In the above example, 429.mcf was built without feedback because of the <span
class="ttnobr">feedback=0</span> line in the section named "<span class="ttnobr">default=peak:</span>".  But 462.libquantum
was built with feedback (from <span class="ttnobr">fdo_post1</span>) because it had a higher priority setting of <span
class="ttnobr">feedback=1</span> in the section named "<span class="ttnobr">462.libquantum:</span>".</p>


<h3 id="sectionVI.E">VI.E. Interaction with <tt>runspec --feedback</tt></h3>

<p>As explained in <a href="#sectionII.A">section II.A</a>, if an option is mentioned on both the command line and in a
config file, the command line does not win over named sections, but it does win over the <a href="#header">header
section</a>.  Examples of both follow.</p> 

<ul>
   <li><p>Here, the config file <a href="#feedback">feedback</a> option is used in a named section, and the <tt>runspec</tt>
   option <a href="runspec.html#feedback">--feedback</a> is also used.  This is the same config file as in the
   previous example, with the added switch on <tt>runspec</tt>.</p>
<pre>
$ <b>cat miriam2.cfg</b>
action    = build
tune      = peak
runlist   = bzip2,mcf,libquantum

fdo_post1 = /usr/bin/merge_feedback fbdir

default=peak:
feedback=0

401.bzip2:
feedback=0

462.libquantum:
feedback=1

$ <b>runspec --fake --config miriam2 --feedback | \
  grep -e Building -e merge_feedback | grep -v %%</b>
  Building 401.bzip2 ref peak none default: (build_peak_none.0003)
  Building 429.mcf ref peak none default: (build_peak_none.0001)
  Building 462.libquantum ref peak none default: (build_peak_none.0000)
/usr/bin/merge_feedback fbdir
</pre>
   <p class="snugtop">You can see above that the command line option had no effect: it cannot win over an option set in a named
   section (<span class="ttnobr">default=peak:</span>).</p></li>

   <li><p>But if the <tt>runspec</tt> option is used with a config file that adjusts feedback in the <a href="#header">header
   section</a>, then the <span class="ttnobr">--feedback</span> switch <b>does</b> have an effect:</p>
<pre>
$ <b>cat miriam3.cfg</b>
action    = build
tune      = peak
runlist   = bzip2,mcf,libquantum

fdo_post1 = /usr/bin/merge_feedback fbdir

feedback=0

401.bzip2:
feedback=0

462.libquantum:
feedback=1

$ <b>runspec --fake --config miriam3 --feedback | \
  grep -e Building -e merge_feedback | grep -v %%</b>
  Building 401.bzip2 ref peak none default: (build_peak_none.0003)
  Building 429.mcf ref peak none default: (build_peak_none.0001)
/usr/bin/merge_feedback fbdir
  Building 462.libquantum ref peak none default: (build_peak_none.0000)
/usr/bin/merge_feedback fbdir
$ 
</pre>

<p>In the above example, 429.mcf does get the <tt>fdo_post1</tt> command.</p>

</li>

</ul>

<h3 id="sectionVI.F">VI.F. More examples </h3>

<p>For more examples of feedback, see the annotated example of a log file that uses FDO in <a href="#sectionVIII.C">section
VIII.C.</a> and the <tt>example-medium.cfg</tt> config file in your <tt>config</tt> directory.</p>

<h2 id="sectionVII">VII.  The config file preprocessor</h2>

<p><span class="new">New with CPU2006</span>, the tools implement a configuration file macro preprocessor.  The preprocessor
can be used in a variety of ways; for example to communicate settings from your shell environment into runspec:</p>

<pre>
$ <b>cat &gt; jan.cfg</b>
notes01 = Today, I am happily running in directory %{MYDIR} on system %{HOST}
$ <b>runspec --config jan --define MYDIR=$PWD --define HOST=`hostname` \
  --fakereportable fp --output_format text | grep txt</b>
        format: ASCII -&gt; /jan/cpu2006/result/CFP2006.090.txt
$ <b>grep Today /jan/cpu2006/result/CFP2006.090.txt</b>
     Today, I am happily running in directory /jan/cpu2006/config on system civilized-03
$ 
</pre>


<p>The config file preprocessor is called a
macro processor because it allows you to define <i>macros</i>, which are brief abbreviations for longer constructs.  If
you've ever used the C preprocessor, the concepts will be familiar, though the syntax is slightly different.</p>

<p>The preprocessor is automatically run whenever you use <span class="ttnobr">runspec</span>.  Or, you can run it
separately, as <span class="ttnobr">configpp</span>, which is documented in <a
href="utility.html#configpp">utility.html</a>.</p>

<p>Preprocessor directives begin with the percent (%) character.  This character <b>must</b> be the first character on the
line.  Any amount of spaces or tabs may separate the percent from the directive.</p>

<p id="percentspace">The following are okay:</p>
<pre>
%define foo
%    define bar
%		undef hello!
</pre>

<p>The following are <b>not</b> okay:</p>
<pre>
# Space in the first column
 %define foo

# Tab in the first column
	%define foo

# This isn't CPP!
#define foo
</pre>

<h3 id="sectionVII.A">VII.A  Defining macros</h3>

<p>The preprocessor is all about macros.  There are no macros defined by default, so unless you define some macros, the
preprocessor can't do much for you.</p>

<p>Macros can be defined in two ways:</p>
<ol>
 <li>On the command line, using the <a href="runspec.html#define">--define</a>
     switch, or</li>
 <li>In the configuration file, using the '%define' preprocessor directive:
<pre>
# Define a simple macro
%define foo bar
# Now the macro called 'foo' has the value 'bar'

# It's not necessary for a macro to have a value to be useful
%define baz
# Now the macro called 'baz' is defined, but it has no value.
</pre>
    <p>Note that no quoting is necessary when specifying the names of macros or
    their values.</p></li>
</ol>

<p>Macros defined in both ways are entirely equivalent.  Because ones set on the command-line are defined first, it's not
possible to use the command line to override a macro definition that occurs in the config file itself.  It may help to think
of a series of '%define' directives, one per --define, as being prepended to the config file.</p>

<p>The values assigned to macros do <b>NOT</b> follow the same quoting rules as variables in the config file.  In particular,
you may <b>NOT</b> use line continuation, line appending, or block quotes.  You may have a value of arbitrary length, but in
the interests of config file readability and maintainability, please keep them relatively short.</p>

<p>You will receive a warning if a previously defined macro is re-defined.</p>

<p>Macro names <b>ARE</b> case-sensitive.</p>

<h3 id="sectionVII.B">VII.B  Un-doing macro definition</h3>

<p>Sometimes you want to make the preprocessor forget about a macro that you taught it.  This is easily accomplished.</p>

<p>Macros can be undefined in two ways:</p>
<ol>
 <li>On the command line, using the <a href="runspec.html#undef">--undef</a>
     switch, or</li>
 <li>In the configuration file, using the '%undef' preprocessor directive.
<pre>
%define foo bar
# Now the macro called 'foo' has the value 'bar'

%undef foo
# Now it doesn't
</pre>
<p>Note that no quoting is necessary when specifying the names of macros.</p></li>
</ol>

<p>Like <a href="#sectionVII.A">macro definition</a>, the undefinition requests can't affect macros set in the config file because
those definitions effectively happen after the un-definition.  For this reason, command-line undefinition is basically
useless; it can only undo macros also set on the command line.<br /> So why was such a useless ability added to the tools?
The writer likes orthogonality.</p>

<h3 id="sectionVII.C">VII.C  Using macros</h3>

<p>By now you're probably over that initial euphoric rush that comes from wantonly defining and undefining macros, and you're
looking for something more.  This is it!</p>

<p>When you want to <b>use</b> the value of a macro, you refer to it by name.  Unfortunately, the syntax for this is not as
simple as you might hope.  It's not too complicated, though; to have the preprocessor expand the macro 'foo', just write</p>
<pre>
  %{foo}
</pre>
<p>in the place where you'd like it to appear.  Given the following config file snippet:</p>
<pre>
%define foo Hello!
%define bar baz
%define foobar Huh?
%define foobaz What?
%define Hello!baz Please don't do this
</pre>

<p>Here's a handy table to see the various ways you can reference these values:</p>

<table>
<tr>
   <th>Macro reference</th>
   <th>Value</th>
</tr>
<tr>
   <td>%{foo}</td>
   <td>Hello!</td>
</tr>
<tr>
   <td>%{bar}</td>
   <td>baz</td>
</tr>
<tr>
   <td>%{foobar}</td>
   <td>Huh?</td>
</tr>
<tr>
   <td>%{foobaz}</td>
   <td>What?</td>
</tr>
<tr>
   <td>%{Hello!baz}</td>
   <td>Please don't do this</td>
</tr>
</table>

<p>Easy, right?  The following is also possible:</p>

<table>
<tr>
   <td>%{foo%{bar}}</td>
   <td>What?</td>
</tr>
<tr>
   <td>%{%{foo}%{bar}}</td>
   <td>Please don't do this</td>
</tr>
</table>


<p>Because macro values can only be one line long, it's not possible to use the preprocessor to macro-ize large chunks of
your config file at once, as may be common practice for advanced users of CPP.</p>

<h3 id="sectionVII.D">VII.D  Conditionals</h3>

<p>Defining, undefining, and expanding macros is quite an enjoyable activity in and of itself, and can even be useful on
occasion.  However, conditionals add an entirely new dimension to config file processing: the ability to include and exclude
entire sections of text based on macros and their values.</p>

<h4 id="sectionVII.D.1">   VII.D.1. %ifdef .. %endif </h4>

<p>The %ifdef conditional provides a way to determine whether or not a particular macro has been defined.  If the named macro
has been defined, the conditional is true, and the text to the matching %endif is included in the text of the config file as
evaluated by runspec.  Note that the matching %endif may not necessarily be the <i>next</i> %endif; conditionals may be
nested.</p>

<p>For example, given the following section of a config file:</p>

<pre>
%define foo
%ifdef %{foo}
This text will be included
%endif

%ifdef %{bar}
This text will not be included
%endif
</pre>

<p>The preprocessor would produce the following output:</p>

<pre>
This text will be included
</pre>

<p>Note especially the quoting used for the macro names in the conditional; the only time macro name quoting may be omitted
is when defining or undefining it.</p>

<h4 id="sectionVII.D.2">   VII.D.2. %ifndef .. %endif </h4>

<p>The %ifndef conditional is the converse of <a href="#sectionVII.D.1">%ifdef</a>; If the named macro has <b>not</b> been defined,
the conditional is true, and the text to the matching %endif is included in the text of the config file as evaluated by
runspec.  Note that the matching %endif may not necessarily be the <i>next</i> %endif; conditionals may be nested.</p>

<p>Given a slightly modified version of the example from earlier:</p>

<pre>
%define foo
%ifndef %{foo}
Now THIS text will not be included
%endif

%ifndef %{bar}
This text WILL be included
%endif
</pre>

<p>The preprocessor would produce the following output:</p>

<pre>
This text WILL be included
</pre>

<h4 id="sectionVII.D.3">   VII.D.3. %if .. %endif </h4>

<p>Checking whether or not a macro is defined is quite useful, but it's just a subset of the more general conditional
facility available.  This general form is</p>

<pre>%if <b>expression</b>
...
%endif
</pre>

<p>The expression is evaluated using a subset of the Perl interpreter, so the possibilities for testing values are fairly
broad.  For example,</p>

<pre>
%ifdef %{foo}
...
%endif
</pre>

<p>is exactly equivalent to</p>

<pre>
%if defined(%{foo})
...
%endif
</pre>

<p>Likewise,</p>

<pre>
%ifndef %{foo}
...
%endif
</pre>

<p>is exactly equivalent to</p>

<pre>
%if !defined(%{foo})
...
%endif
</pre>

<p>Using the general form, it's possible to string conditionals together:</p>

<pre>
%if defined(%{foo}) &amp;&amp; !defined(%{bar}) || %{baz} == 0
...
%endif
</pre>

<p>If a macro contains a string value, you must supply quotes:</p>

<pre>
%if '%{foo}' eq 'Hello, Dave.'
...
%endif
</pre>

<p>You may also perform basic math on macro values:</p>

<pre>
%if %{foo} * 2004 > 3737
...
%endif
</pre>

<p>More precisely, the Perl operations allowed are the <span class="ttnobr">:base_core</span> and <span
class="ttnobr">:base_math</span> bundles, with the ability to dereference and modify variables disallowed.  For more details,
see the source code for <span class="ttnobr">config.pl</span> (the <span class="ttnobr">eval_pp_conditional</span>
subroutine) and Perl's own Opcode documentation.</p> 

<h4 id="sectionVII.D.4">   VII.D.4. %else </h4>

<p>It's possible to get by without the "else" part of the classic "if .. then ..  else" trio, but it's not any fun.  It works
as you'd expect:</p>

<pre>
%define foo
%ifndef %{foo}
This text will not be included
%else
This text WILL be included (from the else clause)
%endif
</pre>

<p>The preprocessor would produce the following output:</p>

<pre>
This text WILL be included (from the else clause)
</pre>

<p>Only one %else per conditional is allowed.</p>

<h4 id="sectionVII.D.5">   VII.D.5. %elif </h4>

<p>%elif is another convenience that's been added.  For those not familiar with CPP, it's an "else if" construct.  You may
have as many of these as you'd like.  Given:</p>

<pre>
%define foo Hello!

%if !defined(%{foo})
This text will not be included
%elif defined(%{bar})
This text won't be included either
%elif '%{foo}' eq 'Hello!'
This text WILL be included (from the second elif clause)
%else
Alas, the else here is left out as well.
%endif
</pre>

<p>The preprocessor would produce the following output:</p>

<pre>
This text WILL be included (from the second elif clause)
</pre>

<h3 id="sectionVII.E">VII.E  Informational Directives</h3>

<p>It's often helpful to be able to warn or abort on certain conditions.  Perhaps there's a macro that <i>must</i> be set to
a particular value, or maybe it's just very highly recommended.</p>

<h4 id="sectionVII.E.1">   VII.E.1. %warning</h4>

<p>%warning does just what you'd expect; when the preprocessor encounters this directive, it prints the text following to
stderr, along with its location within the file being read, and continues on.</p>

<p>Consider:</p>
<pre>
%if !defined(%{somewhat_important_macro})
% warning
% warning You have not defined somewhat_important_macro!
% warning
%endif
</pre>

<p>When run through the preprocessor, this yields the following output:</p>

<pre>
  $ <b>configpp -c warning.cfg</b>
  runspec v2.20 - Copyright 1999-2003 Standard Performance Evaluation Corporation
  Loading standard modules.................
  Loading runspec modules..............
  Locating benchmarks...found 32 benchmarks in 1 benchset.
  Locating output formats: asc...config...html...mail...pdf...ps...raw...screen...
  WARNING: 
  WARNING: You have not defined somewhat_important_macro!
  WARNING: 
  Pre-processed configuration file dump follows:
  --------------------------------------------------------------------
  # Invocation command line:
  # /Users/cloyce/SPEC/cpu2006/bin/configpp --configpp -c warning.cfg
  ############################################################################

  --------------------------------------------------------------------

  The log for this run is in result/CPU2006.013.log

  runspec finished at Tue Apr  1 08:55:36 2003; 5 total seconds elapsed
</pre>

<p>The blank warning lines were added to make the warning stand out a little; as you can see, it's easy for it to be lost in
the rest of the output.</p>

<h4 id="sectionVII.E.2">   VII.E.2. %error</h4>

<p>Like <a href="#sectionVII.E.1">%warning</a>, %error logs an error to stderr and the log file.  <b>Un</b>like <a
href="#sectionVII.E.1">%warning</a>, though, it then aborts the run.</p>

<p>Consider a slightly modified version of the previous example:</p>
<pre>
%if !defined(%{REALLY_important_macro})
% error You have not defined REALLY_important_macro!
%endif
</pre>

<p>When run through the preprocessor, this yields the following output:</p>

<pre>
  $ configpp -c error.cfg
  runspec v2.20 - Copyright 1999-2003 Standard Performance Evaluation Corporation
  Loading standard modules.................
  Loading runspec modules..............
  Locating benchmarks...found 32 benchmarks in 1 benchset.
  Locating output formats: asc...config...html...mail...pdf...ps...raw...screen...
  ERROR: You have not defined somewhat_important_macro!

  The log for this run is in result/CPU2006.014.log

  runspec finished at Tue Apr  1 09:00:06 2003; 4 total seconds elapsed

  $ echo $?
  1
</pre>

<p>The ERROR line also tends to get a little lost in the visual clutter, but unlike a warning, it will be close to the last
thing output.  As you can see from the output of 'echo $?', runspec has exited with an error code 1.</p>



<h2 id="sectionVIII">VIII.  Output files - and how they relate to your config file</h2>

<p>This section describes how the location and contents of several kinds of output files are influenced by your config
file.</p>

<h3 id="sectionVIII.A">VIII.A. Automatic backup of config files</h3>

<p>It was mentioned above that the <a href="#sectionI.C.4">MD5 section</a> of the config file is written automatically by the
tools.  Each time your config file is updated, a backup copy is made.  Thus your config directory may soon come to look like
this:</p>

<pre>   $ <b>cd $SPEC/config</b>
   $ <b>ls tmp.cfg*</b>
   tmp.cfg                   tmp.cfg.2006-05-11_0842   tmp.cfg.2006-05-11_1631
   tmp.cfg.2006-05-10_2007   tmp.cfg.2006-05-11_0847   tmp.cfg.2006-05-11_1632
   tmp.cfg.2006-05-10_2010   tmp.cfg.2006-05-11_0853   tmp.cfg.2006-05-11_1731
   tmp.cfg.2006-05-10_2048   tmp.cfg.2006-05-11_0854   tmp.cfg.2006-05-11_1731a
   tmp.cfg.2006-05-10_2051   tmp.cfg.2006-05-11_0855   tmp.cfg.2006-05-12_0921
   tmp.cfg.2006-05-10_2054   tmp.cfg.2006-05-11_0856   tmp.cfg.2006-05-13_0846
   tmp.cfg.2006-05-10_2058   tmp.cfg.2006-05-11_0857   tmp.cfg.2006-05-13_0846a
   tmp.cfg.2006-05-10_2105   tmp.cfg.2006-05-11_0858   tmp.cfg.2006-05-13_0849
   tmp.cfg.2006-05-10_2105a  tmp.cfg.2006-05-11_0903   tmp.cfg.2006-05-13_0850
   tmp.cfg.2006-05-10_2106   tmp.cfg.2006-05-11_0904   tmp.cfg.2006-05-16_0957
   tmp.cfg.2006-05-10_2125   tmp.cfg.2006-05-11_0905   tmp.cfg.2006-05-18_1133
   tmp.cfg.2006-05-10_2125a  tmp.cfg.2006-05-11_0906   tmp.cfg.2006-05-19_1626
   tmp.cfg.2006-05-10_2126   tmp.cfg.2006-05-11_1348   tmp.cfg.2006-05-19_1627
   tmp.cfg.2006-05-10_2127   tmp.cfg.2006-05-11_1349   tmp.cfg.2006-05-19_1634
   tmp.cfg.2006-05-11_0811   tmp.cfg.2006-05-11_1349a  tmp.cfg.2006-05-19_1638
   tmp.cfg.2006-05-11_0823   tmp.cfg.2006-05-11_1349b  tmp.cfg.2006-05-19_1718
   tmp.cfg.2006-05-11_0835   tmp.cfg.2006-05-11_1553   tmp.cfg.2006-05-19_1720
   tmp.cfg.2006-05-11_0836   tmp.cfg.2006-05-11_1556   tmp.cfg.2006-05-19_1731
   tmp.cfg.2006-05-11_0838   tmp.cfg.2006-05-11_1557   tmp.cfg.2006-05-21_0611
   tmp.cfg.2006-05-11_0839   tmp.cfg.2006-05-11_1627   tmp.cfg.2006-05-21_0622
   tmp.cfg.2006-05-11_0840   tmp.cfg.2006-05-11_1629   tmp.cfg.2006-05-21_0652
   $
</pre>

<p>If this feels like too much clutter, you can disable the backup mechanism, as described under <a
href="#backup_config">backup_config</a>.  Note that doing so may leave you with a risk of losing the config file in case of a
filesystem overflow or system crash.  A better idea may be to periodically remove just portions of the clutter, for example
by typing:</p>

<pre>   $ <b>rm tmp.cfg.2006-05-1*</b>
   $ <b>ls tmp.cfg*</b>
   tmp.cfg                  tmp.cfg.2006-05-21_0622
   tmp.cfg.2006-05-21_0611  tmp.cfg.2006-05-21_0652
   $ 
</pre>


<h3 id="sectionVIII.B">VIII.B. The log file and verbosity levels</h3>

<p><tt>$SPEC/result</tt> (Unix) or <tt>%SPEC%\result</tt> (Windows) contains reports and log files.  When you are doing a build,
you will probably find that you want to pay close attention to the log file.  Depending on the verbosity level that you have
selected, it will contain enormous amounts of information about how your build went.</p>

<p>The CPU2006 tool suite provides for varying amounts of output about its actions during a run.  These levels range from the
bare minimum of output (level 0) to copious streams of information almost certainly worthless to anyone not developing the
tools themselves (level 99).  Note: selecting one output level gives you the output from all lower levels, which may cause
you to wade through more output than you might like.</p>

<p>The 'level' referred to in the table below is selected either in the config file <a href="#verbose">verbose</a> option or
in the runspec command as in '<tt>runspec --verbose <b>n</b></tt>'.</p>
   
<p>Levels higher than 99 are special; they are always output to your log file.  You can also see them on the screen if you
set verbosity to the specified level minus 100.  For example, the default log level is 5.  This means that on your screen you
will get messages at levels 0 through 3, and 100 through 105.  In your log file, you'll find find the same messages, plus the
messages at levels 106 through 199.</p>

<table>
<tr>
   <td><b>Level</b></td>  
   <td><b>What you get</b></td>
</tr>

<tr>
   <td><tt>0</tt></td>
   <td>Basic status information, and most errors.  These messages can not be turned off.</td>
</tr>

<tr>
   <td><tt>1</tt></td>
   <td>List of the benchmarks which will be acted upon.</td>
</tr>

<tr>
   <td><tt>2</tt></td>
   <td>A list of possible output formats, as well as notification when beginning and ending each phase of operation (build,
   setup, run, reporting).</td>
</tr>

<tr>
   <td><tt>3</tt></td>
   <td>A list of each action performed during each phase of operation (e.g. "Building 176.gcc", "Setting up
   253.perlbmk")</td>
</tr>

<tr>
   <td><tt>4</tt></td>
   <td>Notification of benchmarks excluded</td>
</tr>

<tr>
   <td><tt>5 (default)</tt></td>
   <td>Notification if a benchmark somehow was built but nevertheless is not executable.</td>
</tr>

<tr>
   <td><tt>6</tt></td>
   <td>Time spent doing automatic flag reporting.</td>
</tr>

<tr>
   <td><tt>7</tt></td>
   <td>Actions to update SPEC-supplied flags files.</td>
</tr>

<tr>
   <td><tt>10</tt></td>
   <td>Information on basepeak operation.</td>
</tr>

<tr>
   <td><tt>12</tt></td>
   <td>Errors during discovery of benchmarks and output formats.</td>
</tr>

<tr>
   <td><tt>15</tt></td>
   <td>Information about certain updates to stored config files</td>
</tr>

<tr>
   <td><tt>24</tt></td>
   <td>Notification of additions to and replacements in the list of benchmarks.</td>
</tr>

<tr>
   <td><tt>30</tt></td>
   <td>A list of options which are included in the MD5 hash of options used to determine whether or not a given binary needs
   to be recompiled.</td>
</tr>

<tr>
   <td><tt>35</tt></td>
   <td>A list of key=value pairs that can be used in command and notes substitutions, and results of env_var settings.</td>
</tr>

<tr>
   <td><tt>40</tt></td>
   <td>A list of 'submit' commands for each benchmark.</td>
</tr>

<tr>
   <td><tt>70</tt></td>
   <td>Information on selection of median results.</td>
</tr>

<tr>
   <td><tt>89</tt></td>
   <td>Progress comparing run directory MD5s for executables.</td> 
</tr>

<tr>
   <td><tt>90</tt></td>
   <td>Time required for various internal functions in the tools.</td>
</tr>

<tr>
   <td><tt>95, 96, 97, 98</tt></td>
   <td>Flag parsing progress during flag reporting (progressively more detail)</td>
</tr>


<tr>
   <td><tt>99</tt></td>
   <td>Gruesome detail of comparing MD5 hashes of files being copied during run directory setup.</td>
</tr>

<tr>
   <td colspan="2">
   --- Messages at the following levels will always appear in your log files  --- </td>
</tr>

<tr>
   <td><tt>100</tt></td>
   <td>Various config file errors, such as bad preprocessor directives, bad placement of certain options, illegal
   characters...</td>
</tr>

<tr>
   <td><tt>102</tt></td>
   <td>Information about output formats that could not be loaded.</td>
</tr>

<tr>
   <td><tt>103</tt></td>
   <td>A tally of successes and failures during the run broken down by benchmark.</td>
</tr>

<tr>
   <td><tt>106</tt></td>
   <td>A list of runtime and calculated ratio for each benchmark run.</td>
</tr>

<tr>
   <td><tt>107</tt></td>
   <td>Dividers to visually block each phase of the run.</td>
</tr>

<tr>
   <td><tt>110</tt></td>
   <td>Elapsed time for each portion of a workload (if an executable is invoked more than once).</td>
</tr>

<tr>
   <td><tt>120</tt></td>
   <td>Messages about which commands are being issued for which benchmarks.</td>
</tr>

<tr>
   <td><tt>125</tt></td>
   <td>A listing of each individual child processes' start, end, and elapsed times.</td>
</tr>

<tr>
   <td><tt>130</tt></td>
   <td>A nice header with the time of the runspec invocation and the command line used.  Information about what happened with
   your <a href="#sysinfo_program">sysinfo program</a></td>
</tr>

<tr>
   <td><tt>140</tt></td>
   <td>General information about the settings for the current run.</td>
</tr>

<tr>
   <td><tt>145</tt></td>
   <td>Messages about file comparisons.</td>
</tr>

<tr>
   <td><tt>150</tt></td>
   <td>List of commands that will be run, and details about the settings used for comparing output files.  Also the contents
   of the makefile written.</td>
</tr>

<tr>
   <td><tt>155</tt></td>
   <td>Start, end, and elapsed times for benchmark run.</td>
</tr>

<tr>
   <td><tt>160</tt></td>
   <td>Start, end, and elapsed times for benchmark compilation.</td>
</tr>

<tr>
   <td><tt>180</tt></td>
   <td>stdout and stderr from commands run</td>
</tr>

<tr>
   <td><tt>190</tt></td>
   <td>Start and stop of <a href="#delay">delay</a>s</td>
</tr>

<tr>
   <td><tt>191</tt></td>
   <td>Notification of command line used to run specinvoke.</td>
</tr>
</table>


<h3 id="sectionVIII.C">VIII.C. Log file example: Feedback-directed optimization.</h3>

<p>In this section, two things are attempted: a guided tour of how to find some of the interesting parts in a log file, and
an explanation of how the SPEC toolset implements feedback-directed optimization, which is commonly abbreviated FDO.  The
technique is also known as Profile-Based Optimization, or PBO.</p>

<p>To use FDO, you typically compile a program twice.  The first compile creates an image with instrumentation.  Then, you
run the program, with a "training" workload, and the instrumentation collects data about the run: a profile.  Finally, you
re-compile the program, and the compiler uses the profile to improve its optimizations.</p>

<p>SPEC CPU2006 makes all of this relatively easy.  Here's a config file that builds 401.bzip2 with FDO:</p>

<pre>   $ <b>cat mat.cfg</b>
   ext                  = blue271
   iterations           = 1
   output_format        = text
   teeout               = 1
   runlist              = bzip2
   tune                 = peak

   int=peak:
   OPTIMIZE       = -O
   PASS1_CFLAGS   = -xprofile=collect:./fb
   PASS1_LDFLAGS  = -xprofile=collect:./fb
   PASS2_CFLAGS   = -xprofile=use:./fb
   PASS2_LDFLAGS  = -xprofile=use:./fb
   $ 
</pre>

<p>The <tt>PASSxx</tt> lines above cause FDO to happen.  Each of the profiling switches is specified twice because we need
them to be applied both for compiles and for the link.  Let's invoke <tt>runspec</tt> with the above config file, searching
the output for lines that contain either "<tt>Training</tt>" or "<tt>bzip2.o</tt>", which is a handy string to pick out both
a sample compile line and the link line:</p> 

<pre>   $ <b>runspec --config mat --size test | grep -e Training -e bzip2.o</b>
   cc -c -o bzip2.o -DSPEC_CPU -DNDEBUG    -xprofile=collect:./fb 
      -O bzip2.c
   cc -O -xprofile=collect:./fb  spec.o blocksort.o bzip2.o bzlib.o 
      compress.o crctable.o decompress.o huffman.o randtable.o 
      -o bzip2
   Training 401.bzip2
   cc -c -o bzip2.o -DSPEC_CPU -DNDEBUG    -xprofile=use:./fb    
      -O bzip2.c
   cc -O -xprofile=use:./fb  spec.o blocksort.o bzip2.o bzlib.o 
      compress.o crctable.o decompress.o huffman.o randtable.o 
      -o bzip2
   $ 
</pre>

<p>Above, you can see the basic flow: compile using the switch <span class="ttnobr">-xprofile=collect</span> for both
the compile and link lines; run the training workload; then recompile with <span class="ttnobr">-xprofile=use</span>. </p>

<p>Let's go a little deeper by taking apart the log file.  This section uses the actual log file from the above
<tt>runspec</tt> command, but white space has been adjusted.</p>

<p>The first thing to look for when you're trying to make sure you've found the right log file is the line that contains the
string <span class="ttnobr">runspec:</span></p>

<pre>   $ <b>grep runspec: *079.log</b>
   runspec: runspec --config mat --size test
   $ 
</pre>
<p>Yes, this looks like the right log.  To find the section where the benchmark is built, search for "<tt>Building</tt>",
which is soon followed by information about what was written to the makefile:</p>

<pre>
------------------------------------------------------------------------
When checking options for /vampir/benchspec/CPU2006/401.bzip2/exe/bzip2_peak.blue271, 
  no MD5 sums were
  found in the config file.  They will be installed after build.
  <b>Building</b> 401.bzip2 test peak blue271 default: (build_peak_blue271.0000)
Wrote to makefile 
'/vampir/benchspec/CPU2006/401.bzip2/run/build_peak_blue271.0000/Makefile.deps':

# These are the build dependencies

# End dependencies
Wrote to makefile 
'/vampir/benchspec/CPU2006/401.bzip2/run/build_peak_blue271.0000/Makefile.spec':
TUNE=peak
EXT=blue271
NUMBER=401
NAME=bzip2
SOURCES= spec.c blocksort.c bzip2.c bzlib.c compress.c crctable.c \
	 decompress.c huffman.c randtable.c
EXEBASE=bzip2
NEED_MATH=
BENCHLANG=C
ONESTEP=
CONESTEP=

OPTIMIZE         = -O
OS               = unix
PASS1_CFLAGS     = -xprofile=collect:./fb
PASS1_LDFLAGS    = -xprofile=collect:./fb
PASS2_CFLAGS     = -xprofile=use:./fb
PASS2_LDFLAGS    = -xprofile=use:./fb
abstol           = 
</pre>

<p>To tell the tools that we want to use FDO, we set <tt>PASS1_&lt;language&gt;FLAGS</tt> and
<tt>PASS2_&lt;language&gt;FLAGS</tt>.   If the tools see any use of these flags, they will perform two compiles.  The
particular compiler used in this example expects to be invoked twice: once with <tt>-xprofile=collect:./fb</tt> and then
again with <tt>-xprofile=use:./fb</tt>.</p>

<p>A useful search string to find the first build in the log is "<span class="ttnobr">specmake build</span>":</p>

<pre>
worklist         = list
  Compile for '401.bzip2' started at: Mon May 22 21:31:38 2006 (1148347898)
Issuing make.clean command 'specmake clean'
Start make.clean command: Mon May 22 21:31:38 2006 (1148347898)
rm -rf bzip2 bzip2.exe *.o  *.fppized.f*
find . \( -name \*.o -o -name '*.fppized.f*' \) -print | xargs rm -rf
rm -rf core 
Stop make.clean command: Mon May 22 21:31:41 2006 (1148347901)
Elapsed time for make.clean command: 00:00:03 (3)
Issuing fdo_make_pass1 command '<b>specmake build</b> FDO=PASS1'
Start fdo_make_pass1 command: Mon May 22 21:31:45 2006 (1148347905)
cc -c -o spec.o -DSPEC_CPU -DNDEBUG  -xprofile=collect:./fb    -O  spec.c
cc -c -o blocksort.o -DSPEC_CPU -DNDEBUG  -xprofile=collect:./fb    -O  blocksort.c
cc -c -o bzip2.o -DSPEC_CPU -DNDEBUG  -xprofile=collect:./fb    -O  bzip2.c
cc -c -o bzlib.o -DSPEC_CPU -DNDEBUG  -xprofile=collect:./fb    -O  bzlib.c
"bzlib.c", line 911: warning: statement not reached
"bzlib.c", line 1288: warning: statement not reached
cc -c -o compress.o -DSPEC_CPU -DNDEBUG  -xprofile=collect:./fb    -O  compress.c
cc -c -o crctable.o -DSPEC_CPU -DNDEBUG  -xprofile=collect:./fb    -O  crctable.c
cc -c -o decompress.o -DSPEC_CPU -DNDEBUG  -xprofile=collect:./fb    -O  decompress.c
cc -c -o huffman.o -DSPEC_CPU -DNDEBUG  -xprofile=collect:./fb    -O  huffman.c
cc -c -o randtable.o -DSPEC_CPU -DNDEBUG  -xprofile=collect:./fb    -O  randtable.c
cc  -O         -xprofile=collect:./fb  spec.o blocksort.o bzip2.o bzlib.o compress.o 
   crctable.o decompress.o huffman.o randtable.o                     -o bzip2
</pre>

<p>You can see above that <tt>specmake</tt> is invoked with <tt>FDO=PASS1</tt>, which causes the
switches from <tt>PASS1_CFLAGS</tt> to be used.  If you want to understand exactly how this affects the build, read
<tt>$SPEC/benchspec/Makefile.defaults</tt>, along with the document <tt>$SPEC/Docs/makevars</tt>.</p>

<p>To find the training run, search forward for <tt>Training</tt></p>

<pre>
O: OPTIMIZE="-O"
O: PASS1_LDFLAGS="-xprofile=collect:./fb"
C: LDOUT="-o options"
Stop options1 command: Mon May 22 21:31:57 2006 (1148347917)
Elapsed time for options1 command: 00:00:02 (2)
<b>Training</b> 401.bzip2
Commands to run: 
  -C /vampir/benchspec/CPU2006/401.bzip2/run/build_peak_blue271.0000
  -o input.program.out -e input.program.err ../build_peak_blue271.0000/bzip2 input.program 10
  -o byoudoin.jpg.out -e byoudoin.jpg.err ../build_peak_blue271.0000/bzip2 byoudoin.jpg 5
  -o input.combined.out -e input.combined.err ../build_peak_blue271.0000/bzip2 input.combined 80
Specinvoke: /vampir/kit91/bin/specinvoke 
    -d /vampir/benchspec/CPU2006/401.bzip2/run/build_peak_blue271.0000 
    -e speccmds.err -o speccmds.stdout -f speccmds.cmd -C
Issuing command '/spec/jhenning/kit91/bin/specinvoke 
    -d /vampir/benchspec/CPU2006/401.bzip2/run/build_peak_blue271.0000 
    -e speccmds.err -o speccmds.stdout -f speccmds.cmd -C'
Start command: Mon May 22 21:31:58 2006 (1148347918)
Stop command: Mon May 22 21:39:57 2006 (1148348397)
Elapsed time for command: 00:07:59 (479)
Workload elapsed time (0:1) = 52.091489 seconds
Workload elapsed time (0:2) = 73.627057 seconds
Workload elapsed time (0:3) = 345.535733 seconds
copy 0 finished @ Mon May 22 21:39:49 2006.  Total elapsed time: 471.254279
comparing files in '/vampir/benchspec/CPU2006/401.bzip2/run/build_peak_blue271.0000'
comparing 'byoudoin.jpg.out' with abstol=, binary=, calctol=0, cw=, floatcompare=, 
   ignorecase=, obiwan=, reltol=, skipabstol=, skipobiwan=, skipreltol=, skiptol=
</pre>

<p class="snugbot">The key lines to notice above are the ones just after "<span class="ttnobr">Commands to run:</span>",
which begin with <tt>-o</tt>.  These lines cause <tt>specinvoke</tt> to run the freshly-built <tt>bzip2</tt> three times.
The <tt>-o</tt> and <tt>-e</tt> parameters to <tt>specinvoke</tt> indicate where it is to send standard output and standard
error.  Thus, for example</p>
<p class="exsnug">-o byoudoin.jpg.out -e byoudoin.jpg.err ../build_peak_blue271.0000/bzip2 byoudoin.jpg 5</p>
<p class="snug">will cause this command to actually be run: </p>
<p class="exsnug">../build_peak_blue271.0000/bzip2 byoudoin.jpg 5 &gt; byoudoin.jpg.out 2&gt; byoudoin.jpg.err</p> 
<p class="snugtop">For more information on specinvoke, see <a href="utility.html#specinvoke">utility.html</a>.</p>

<p>For this particular benchmark, SPEC has supplied three workloads that are used to train <tt>bzip2</tt>.  Why three
workloads?  Because a training set should provide the compiler with information about usage of the program which is, in the
opinion of the developer, representative of real-world use.  Of course, if the developer has actual evidence, instead of
merely an opinion, so much the better!  In this instance, the developer of the training workload has chosen to train bzip
with:</p>
<ol>
<li>The file <tt>input.program</tt>, which is a program binary;</li>
<li>An input in <tt>.jpg</tt> format, which is inherently already compressed and therefore not a particularly useful
application of bzip2 -- but real users do this; and </li>
<li>An input that contains a mixture of highly compressible and not-very-compressible data: <tt>input.combined</tt>.</li>
</ol>


<p>You can see the inputs that SPEC has provided for training purposes in the directories <span
class="ttnobr">nnn.benchmark/data/train/input</span> and <span class="ttnobr">nnn.benchmark/data/all/input</span>.  In some
cases, the training workloads required significant development effort, but as a user of the suite you don't have to worry
about that; you can simply apply them.  SPEC is aware that there is some variation in the fidelity between the training
workloads vs. the timed "ref" workloads.  In the real world, also, training workloads used by program developers do not
correspond perfectly to how end users apply the programs.</p>

<p>In any case, the tester who employs the SPEC CPU2006 suite does not have to come up with his or her own training
workloads, and, indeed, is not allowed to do so under the run rules.</p>

<p>Notice that the log file tells us both the time for the individual invocations of <tt>bzip2</tt>:
52.09, 73.63, and 345.54 seconds; and the total time: 471.25 seconds.</p>

<p>Finally, the compiler is run a second time, to use the profile feedback and build a new executable, at the 
second <tt>specmake build</tt>:</p>
<pre>
Start fdo_make_clean_pass2 command: Mon May 22 21:40:02 2006 (1148348402)
rm -rf bzip2 bzip2.exe *.o  *.fppized.f*
find . \( -name \*.o -o -name '*.fppized.f*' \) -print | xargs rm -rf
Stop fdo_make_clean_pass2 command: Mon May 22 21:40:05 2006 (1148348405)
Elapsed time for fdo_make_clean_pass2 command: 00:00:03 (3)
Issuing fdo_make_pass2 command '<b>specmake build</b> FDO=PASS2'
Start fdo_make_pass2 command: Mon May 22 21:40:05 2006 (1148348405)
cc -c -o spec.o -DSPEC_CPU -DNDEBUG    -xprofile=use:./fb    -O   spec.c
cc -c -o blocksort.o -DSPEC_CPU -DNDEBUG    -xprofile=use:./fb    -O   blocksort.c
cc -c -o bzip2.o -DSPEC_CPU -DNDEBUG    -xprofile=use:./fb    -O   bzip2.c
cc -c -o bzlib.o -DSPEC_CPU -DNDEBUG    -xprofile=use:./fb    -O   bzlib.c
"bzlib.c", line 911: warning: statement not reached
"bzlib.c", line 1288: warning: statement not reached
cc -c -o compress.o -DSPEC_CPU -DNDEBUG    -xprofile=use:./fb    -O   compress.c
cc -c -o crctable.o -DSPEC_CPU -DNDEBUG    -xprofile=use:./fb    -O   crctable.c
cc -c -o decompress.o -DSPEC_CPU -DNDEBUG    -xprofile=use:./fb    -O   decompress.c
cc -c -o huffman.o -DSPEC_CPU -DNDEBUG    -xprofile=use:./fb    -O   huffman.c
cc -c -o randtable.o -DSPEC_CPU -DNDEBUG    -xprofile=use:./fb    -O   randtable.c
cc  -O         -xprofile=use:./fb  spec.o blocksort.o bzip2.o bzlib.o compress.o 
   crctable.o decompress.o huffman.o randtable.o                     -o bzip2
Stop fdo_make_pass2 command: Mon May 22 21:40:15 2006 (1148348415)
Elapsed time for fdo_make_pass2 command: 00:00:10 (10)
Issuing options2 command 'specmake options FDO=PASS2'
Start options2 command: Mon May 22 21:40:15 2006 (1148348415)
</pre>

<p>This time, <tt>specmake</tt> is invoked with <tt>FDO=PASS2</tt>, which is why the compile picks up the
<tt>PASS2_CFLAGS</tt>.</p>

<p>And that's it.  The tools did most of the work; the user simply set the PASSn flags in the config file.</p>

<h3 id="sectionVIII.D">VIII.D. Help, I've got too many logs!</h3>

<p>If you do a very large number of builds and runs, you may find that your result directory gets far too cluttered.  If it
does, you should feel free to issue commands such as these on Unix systems:</p>

<pre>   cd $SPEC
   mv result result_old
   mkdir result
</pre>

<p>On Windows, you could say:</p>

<pre>   cd %SPEC%
   rename result result_old
   mkdir result
</pre>

<h3 id="sectionVIII.E">VIII.E. Finding the build directory</h3>

<p>As described under <a href="runspec.html#disk_usage">"About Disk Usage" in runspec.html</a>, the CPU2006 tools do the
actual builds and runs in the <tt>run</tt> directories.  The benchmark sources are never modified in the <tt>src</tt>
directory.</p>

<p><span class="new">New with CPU2006, </span> the build directories have logical names, typically of the form
<tt>build_&lt;tune&gt;_&lt;extension&gt;.0000</tt>.   For example, after the command <span class="ttnobr">runspec
--config jun09a --action build --tune base libquantum</span>, the following directory was created:</p>

<pre>
$ <b>cd $SPEC/benchspec/CPU2006/462.libquantum/run</b>
$ <b>pwd</b>
/spec/joelw/benchspec/CPU2006/462.libquantum/run
$ <b>ls -ld build*jun*</b>
drwxrwxr-x   2 joelw ptg    1536 Jun 10 14:49 build_base_jun09a.0000
$ 
</pre>

<p>On Windows, you would say <tt>cd %SPEC%\benchspec\CPU2006\462.libquantum\run</tt> followed by <tt>dir build*</tt>.</p>

<p>If the directory <tt>build_&lt;tune&gt;_&lt;extension&gt;.0000</tt> already exists when a new build is
attempted for the same tuning and extension, the directory will be re-used, unless:</p>
<ul>
<li>You have set the environment variable <tt>SPEC_CPU2006_NO_RUNDIR_DEL</tt>, or </li>
<li>The directory has been left in a "locked" state by an aborted previous build. </li>
</ul>
<p>In such cases, the <tt>0000</tt> will be incremented until a name is generated that is available.  You can
find locked directories by searching for <tt>lock=1</tt> in the file
<tt>$SPEC/benchspec/CPU2006/&lt;nnn.benchmark&gt;/run/list</tt> (Unix) or
<tt>%SPEC%\benchspec\CPU2006\&lt;nnn.benchmark&gt;\run\list</tt> (Windows).
</p>

<p>When more than one build directory has been created for a given tuning and extension, you may need to trace the directory
back to the specific build attempt that created it.  You can do so by searching for the directory name in the log files:</p>

<pre>
$ <b>grep Building *log | grep build_base_jun09a.0001</b>
CPU2006.380.log:  Building 462.libquantum ref base jun09a default: (build_base_jun09a.0001)
$ 
</pre>

<p>In the above example, the <tt>grep</tt> command locates log #380 as the log that corresponds to this run directory.  On
Windows, of course, you would use <tt>findstr</tt> instead of <tt>grep</tt>.</p>



<h3 id="sectionVIII.F">VIII.F. Files in the build directory</h3>

<p>A variety of files are output to the build directory.  Here are some of the key files which can usefully be examined:</p>


<table> 
<tr>
   <td><tt>Makefile.spec</tt></td>
   <td>The components for make that were generated for the current config file with the current set of runspec options. </td>
</tr>

<tr>
   <td><tt>options.out</tt></td>
   <td>For 1 pass compile: build options summary.</td>
</tr>

<tr>
   <td><tt>options1.out</tt></td>
   <td>For N pass compile: summary of first pass.</td>
</tr>

<tr>
   <td><tt>options2.out</tt></td>
   <td>For N pass compile: summary of second pass.</td>
</tr>

<tr>
   <td><tt>make.out</tt></td>
   <td>For 1 pass compile: detailed commands generated. </td>
</tr>

<tr>
   <td><tt>fdo_make_pass1.out</tt></td>
   <td> For N pass compile: detailed commands generated for 1st pass.</td>
</tr>

<tr>
   <td><tt>fdo_make_pass2.out</tt></td>
   <td> For N pass compile: detailed commands generated for 2nd pass.</td>
</tr>

<tr>
   <td><tt>*.err</tt></td>
   <td> The output from standard error corresponding to the above files.</td>
</tr>
</table>

<h3 id="sectionVIII.G">VIII.G. For more information</h3>

<p>For more information about how the run directories work, see the descriptions of <tt>specinvoke</tt>, <tt>specmake</tt>,
and <tt>specdiff</tt> in <a href="utility.html">utility.html</a>.</p>


<h2 id="sectionIX">IX.  Troubleshooting</h2>

<p>When something goes wrong with a build, here are some things to check:</p>

<ol>
<li><p> Are there any obvious clues in the log file?  Search for the word "<tt>Building</tt>".  Keep searching until you hit
the next benchmark AFTER the one that you are interested in.  Now scroll backward one screen's worth of text.</p></li>

<li><p>Did your desired switches get applied?  Go to the build directory, and look at <tt>options*out</tt>.</p></li>

<li><p>Did the tools or your compilers report any errors?  Look in the build directory at <tt>*err</tt>.</p></li>

<li><p>What happens if you try the build by hand?  See the section on <tt>specmake</tt> in <a
href="utility.html#specmake">utility.html</a>.</p></li>

<li><p>If an actual run fails, what happens if you invoke the run by hand?  See the information about "<span
class="ttnobr">specinvoke -n</span>" in <a href="utility.html#specinvoke">utility.html</a></p></li>
</ol>

<hr />
<p>Copyright (C) 1999-2006 Standard Performance Evaluation Corporation
<br />All Rights Reserved</p>
</body>
</html>

